# Template file for 'ffmpeg'
pkgname=ffmpeg
version=0.10.3
homepage="http://www.ffmpeg.org"
distfiles="${homepage}/releases/ffmpeg-${version}.tar.bz2"
short_desc="Decoding, encoding and streaming software"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-3"
checksum=7d1ca0abc80e2f6161e2a48878b62a2e6d0301c231f91e7677b889ef048b931f
long_desc="
 FFmpeg is the first complete and free Internet Live Audio and Video
 Broadcasting solution. FFMpeg aims at being the command line tool to
 handle audio and video. It is a three-in-one solution.

 FFmpeg includes a soft VCR capable of encoding in many different
 formats simultaneously, a streaming server for Netcasting multimedia
 and is available under the GNU General Public License.

 FFmpeg generates streaming files, in many popular formats
 simultaneously, faster than any other solution."

subpackages="libavcodec libavdevice libavformat libavutil libavfilter"
subpackages="${subpackages} libpostproc libswscale libswresample $pkgname-devel"

Add_dependency build pkg-config
Add_dependency build perl	">=0"
Add_dependency build yasm
Add_dependency build zlib-devel
Add_dependency build alsa-lib-devel
Add_dependency build libXfixes-devel
Add_dependency build libXext-devel
Add_dependency build libXvMC-devel
Add_dependency build faad2-devel
Add_dependency build lame-devel
Add_dependency build libtheora-devel
Add_dependency build libvorbis-devel
Add_dependency build x264-devel
Add_dependency build xvidcore-devel
Add_dependency build jack-devel
Add_dependency build SDL-devel
Add_dependency build libvpx-devel
Add_dependency build libva-devel
Add_dependency build libvdpau-devel

Add_dependency run faad2
Add_dependency run x264
Add_dependency run xvidcore
Add_dependency run libvdpau

do_configure() {
	./configure --prefix=/usr --disable-debug --enable-gpl \
		--enable-version3 --enable-runtime-cpudetect \
		--enable-libmp3lame --enable-libvorbis --enable-libxvid \
		--enable-libx264 --enable-libvpx --enable-libtheora \
		--enable-vdpau --enable-vaapi --enable-postproc \
		--enable-shared --enable-x11grab \
		--disable-libopencore_amrnb --disable-libopencore_amrwb \
		--disable-libschroedinger --disable-libopenjpeg
}

do_build() {
	make ${makejobs}
	make doc/ff{mpeg,play,server}.1
}

do_install() {
	make DESTDIR=${DESTDIR} install install-man
}
