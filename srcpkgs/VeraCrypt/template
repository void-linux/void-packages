# Template file for 'VeraCrypt'
pkgname=VeraCrypt
version=1.24.Update7
revision=1
_realversion=${version/.Update/-Update}
wrksrc="${pkgname}-${pkgname}_${_realversion}"
build_wrksrc=src
build_style=gnu-makefile
make_build_args="WX_CONFIG=wx-config-gtk3"
make_use_env=1
hostmakedepends="pkg-config yasm unzip"
makedepends="fuse-devel wxWidgets-gtk3-devel"
short_desc="Disk encryption with strong security based on TrueCrypt"
maintainer="Gustavo Heinz <gustavoheinz95@gmail.com>"
# Modified by Monkey-7-12 <monkeyseven@fblog.ch>
license="Apache-2.0, custom:TrueCrypt-3.0"
homepage="https://www.veracrypt.fr"
distfiles="https://www.veracrypt.fr/code/VeraCrypt/snapshot/VeraCrypt-VeraCrypt_${_realversion}.tar.gz"
checksum=a7bd793468a80266f92c208198e263fa396eeccc9cdaa9e46321f913dcbe262c
repository=fblog

case "$XBPS_TARGET_MACHINE" in
	i686*|x86_64*) ;;
	*) make_build_args+=' NOASM=1' ;;
esac

if [ "$CROSS_BUILD" ]; then
	make_build_args+=' NOTEST=1'
fi

if [ "$XBPS_TARGET_ENDIAN" = "be" ]; then
	broken="Error: TestFailed at VeraCrypt::TestCipher:181"
fi

do_install() {
	vbin Main/veracrypt
	vlicense License.txt
	vinstall Setup/Linux/veracrypt.desktop 644 usr/share/applications/
	vinstall Resources/Icons/VeraCrypt-256x256.xpm 644 usr/share/pixmaps/ veracrypt.xpm
}
