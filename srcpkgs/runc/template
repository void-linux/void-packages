# Template file for 'runc'
pkgname=runc
version=1.3.2
revision=1
build_style=go
go_import_path=github.com/opencontainers/runc
go_build_tags="seccomp apparmor"
go_ldflags="-X main.version=${version}"
make_check_args="-skip=(^TestValidateSysctlWithBindHostNetNS$|^TestNsenterValidPaths$|^TestNsenterChildLogging$|^TestFactoryLoadContainer$)"
hostmakedepends="pkg-config go-md2man"
makedepends="libseccomp-devel"
checkdepends="curl tar xz"
short_desc="CLI tool for spawning and running OCI containers"
maintainer="Gabriel M. Dutra <hi@nulldutra.me>"
license="Apache-2.0"
homepage="https://github.com/opencontainers/runc"
changelog="https://github.com/opencontainers/runc/raw/main/CHANGELOG.md"
distfiles="https://github.com/opencontainers/runc/releases/download/v${version}/runc.tar.xz"
checksum=7e44ad8c82e96a934eb2d280465f25fc6613922fb8d81d01dfe2c4ebe9423d85

post_build() {
	make man
}

post_install() {
	make install-man PREFIX="${DESTDIR}/usr"
}

pre_check() {
	# Skip integration tests
	make_check_target=$(go list ./... | grep -v /integration)
}
