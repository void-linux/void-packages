# Template file for 'xpar'
pkgname=xpar
version=0.7
revision=1
build_style=gnu-configure
configure_args="--enable-lto"
hostmakedepends="nasm"
makedepends="libgomp-devel"
short_desc="Error/erasure code system guarding data integrity"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="GPL-3.0-or-later"
homepage="https://github.com/iczelia/xpar"
changelog="https://github.com/iczelia/xpar/blob/main/NEWS"
distfiles="https://github.com/iczelia/xpar/releases/download/${version}/xpar-${version}.tar.gz"
checksum=d3f651c149d1946a2981c36badab763429126c702b290e90d77c436671edbdd5

case "$XBPS_TARGET_MACHINE" in
	x86_64*) configure_args+=" --enable-x86_64";;
	aarch64*) configure_args+=" --enable-aarch64";;
esac

pre_configure() {
	# ARM uses CPUID then enables -march=armv8-a+crypto+crc
	export CFLAGS=${CFLAGS//-march=armv8-a/}
}
