# Template file for 'ksh'
pkgname=ksh
version=1.0.0a
revision=2
_commit="37a18bab7173427ce045c9a67772cb98eb678cb7"
wrksrc="${pkgname}-${_commit}"
short_desc="AT&T's Korn shell (ksh93)"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="EPL-1.0"
homepage="http://www.kornshell.com/"
distfiles="https://github.com/ksh93/ksh/archive/${_commit}.tar.gz"
checksum=2ec6700a3c1ef688409a9339acb745e72902717b9e719e7937cdcccaa140e16d
nocross=yes

register_shell="/bin/ksh"
alternatives="
 ksh:ksh:/usr/bin/ksh93
 ksh:ksh.1:/usr/share/man/man1/ksh93.1
"

do_build() {
	./bin/package make
}

do_check() {
	script -e -c ./bin/shtests /dev/null
}

do_install() {
	ARCH=$(./bin/package)
	vmkdir usr/bin
	mv arch/${ARCH}/bin/ksh ${DESTDIR}/usr/bin/ksh93
	vmkdir usr/share/man/man1
	mv arch/${ARCH}/man/man1/sh.1 ${DESTDIR}/usr/share/man/man1/ksh93.1
	vmkdir usr/share/ksh
	vcopy arch/${ARCH}/fun usr/share/ksh/functions
	rmdir ${DESTDIR}/usr/lib
	vlicense LICENSE.md
}
