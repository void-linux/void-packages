# Template file for 'haredoc'
pkgname=haredoc
version=0.24.0
revision=1
archs="x86_64 x86_64-musl aarch64 aarch64-musl riscv64 riscv64-musl"
build_style=gnu-makefile
make_use_env=yes
make_build_target=".bin/haredoc docs"
make_install_target="install-haredoc"
hostmakedepends="hare-driver scdoc"
short_desc="Hare documentation reader and formatter"
maintainer="Jonas Fentker <jonas@fentker.eu>"
license="MPL-2.0, GPL-3.0-only"
homepage="https://harelang.org/"
distfiles="https://git.sr.ht/~sircmpwn/hare/archive/${version}.tar.gz"
checksum="7061dad3c79cca51a1662a71b1c6f8ec001f52ef3053dd3c2dbb95ae9beff7bc"
# disable check of seperately packaged build driver
make_check=no

do_configure() {
	cp configs/linux.mk config.mk
	vsed -e "s/^HAREFLAGS =$/HAREFLAGS = -a${XBPS_TARGET_MACHINE%-musl} -R/" \
	     -e '/^PREFIX/d' \
	     -e '/^AS/d' \
	     -e '/^LD/d' \
	     -i config.mk
}
