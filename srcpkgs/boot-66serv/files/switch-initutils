# This service automatically moves 
# /usr/bin/{reboot,poweroff,halt,shutdown}
# so that if started with 66, users can shutdown etc. with it.
# It automatically moves everything back if started with
# runit again.
# This is run by runit and 66

if grep -q "init=/usr/bin/66" /proc/cmdline; then
	for i in reboot poweroff halt shutdown; do
		if ! test -e /usr/bin/${i}.runit; then
			mv /usr/bin/${i} /usr/bin/${i}.runit
			ln -s /etc/66/${i} /usr/bin/${i}
		fi
	done
else
	for i in reboot poweroff halt shutdown; do
		if test -e /usr/bin/${i}.runit; then
			rm /usr/bin/${i}
			mv /usr/bin/${i}.runit /usr/bin/${i} 
		fi
	done
fi
