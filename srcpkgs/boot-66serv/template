# Template file for 'boot-66serv'
pkgname=boot-66serv
version=2.2.0
revision=1
wrksrc=${pkgname}-v${version}
build_style=gnu-configure
configure_args="--HOSTNAME=voidlinux --TTY=!4
	--KEYMAP=!us --TZ=Europe/Madrid"
make_install_target="install install-man install-html"
hostmakedepends="lowdown"
makedepends="file"
depends="s6 s6-rc s6-linux-utils s6-portable-utils 66 66-tools"
short_desc="Stage 1 boot for 66"
maintainer="teldra <teldra@rotce.de>"
license="ISC"
homepage="https://framagit.org/Obarun/boot-66serv"
conf_files="/etc/66/rc.local"
distfiles="https://framagit.org/Obarun/${pkgname}/-/archive/v${version}/${pkgname}-v${version}.tar.gz"
checksum=69924a3c7f830a3a2b77506ec9264652eaa6ea4cdebb137547f7fb71444e3852

post_install() {
	vinstall ${FILESDIR}/switch-initutils 644 etc/runit/core-services 99-switch-initutils.sh
	vbin ${FILESDIR}/66
	vlicense LICENSE
	vinstall ${FILESDIR}/tty@ 644 usr/share/66/service/
	vsed -i "s/@VERSION@/${version}/" "${DESTDIR}/usr/share/66/service/tty@"
	vinstall ${FILESDIR}/runit 644 usr/share/66/service/
	vsed -i "s/@VERSION@/${version}/" "${DESTDIR}/usr/share/66/service/runit"
}
