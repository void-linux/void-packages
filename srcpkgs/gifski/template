# Template file for 'gifski'
pkgname=gifski
version=1.3.3
revision=1
build_style=cargo
configure_args="--features=video,openmp"
hostmakedepends="pkg-config clang llvm ffmpeg-devel"
makedepends="libgomp-devel libomp-devel ffmpeg-devel"
short_desc="Highest-quality GIF encoder based on pngquant"
maintainer="Benjamín Albiñana <benalb@gmail.com>"
license="AGPL-3.0-only"
homepage="https://gif.ski"
distfiles="https://github.com/ImageOptim/gifski/archive/${version}.tar.gz"
checksum=ef8df6c5224c29eed8c011c464826137717fac22b3b1eb123829e7aa93defa11

if [ "$CROSS_BUILD" ]; then
	export HOST_CC="$BUILD_CC"
	case "$XBPS_TARGET_MACHINE" in
	armv7l)
		export HOST_CCFLAGS="$BUILD_CFLAGS -mfloat-abi=hard"
		;;
	*)
		export HOST_CFLAGS="$BUILD_CFLAGS"
		;;
	esac
	export BINDGEN_EXTRA_CLANG_ARGS="--target=${XBPS_CROSS_TRIPLET} --sysroot=/usr/${XBPS_CROSS_TRIPLET}"
fi

post_install() {
	vlicense LICENSE
}
