# Template file for 'etlegacy'
pkgname=etlegacy
version=2.81.1
revision=1
build_style=cmake
configure_args="-DCMAKE_BUILD_TYPE=Release -DCMAKE_LIBRARY_PATH=/usr \
 -DCMAKE_INSTALL_PREFIX=/usr -DINSTALL_DEFAULT_BASEDIR=/usr/lib/etlegacy \
 -DCLIENT_GLVND=1 -DBUNDLED_LIBS=0 -DFEATURE_AUTOUPDATE=0 \
 -DINSTALL_OMNIBOT=0 -DCROSS_COMPILE32=0 -DSDL_RENDER=OFF -Wno-dev"
hostmakedepends="libtool pkg-config"
makedepends="libglvnd-devel glew-devel SDL2-devel zlib-devel minizip-devel
 libjpeg-turbo-devel libcurl-devel lua54-devel libvorbis-devel libtheora-devel
 freetype-devel libpng-devel sqlite-devel libopenal-devel cJSON-devel"
short_desc="Project based on Wolfenstein: Enemy Territory"
maintainer="biopsin <biopsin@teknik.io>"
license="GPL-3.0-or-later"
homepage="https://www.etlegacy.com"
changelog="https://github.com/etlegacy/etlegacy/wiki/Changelog.md"
distfiles="https://github.com/etlegacy/etlegacy/archive/refs/tags/v${version}.tar.gz
 https://mirror.etlegacy.com/etmain/pak0.pk3
 https://mirror.etlegacy.com/etmain/pak1.pk3
 https://mirror.etlegacy.com/etmain/pak2.pk3"
checksum="687dfea58fe385deaa91f7a9ee7c232e2a79bc059a531934051e569aca6f7fb3
 712966b20e06523fe81419516500e499c86b2b4fec823856ddbd333fcb3d26e5
 5610fd749024405b4425a7ce6397e58187b941d22092ef11d4844b427df53e5d
 a48ab749a1a12ab4d9137286b1f23d642c29da59845b2bafc8f64e052cf06f3e"
skip_extraction="pak0.pk3 pak1.pk3 pak2.pk3"
lib32disabled=yes
restricted=yes

post_install() {
	for i in 0 1 2; do
		vinstall ${XBPS_SRCDISTDIR}/${sourcepkg}-${version}/pak$i.pk3 644 \
			usr/lib/etlegacy/etmain
	done
}
