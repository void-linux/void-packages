# Template file for 'yacy'
pkgname=yacy
version=1.922
revision=1
hostmakedepends="openjdk apache-ant"
depends="openjdk-jre"
short_desc="YaCy p2p decentralized search engine"
maintainer="Jason Manley <jason@jasondavid.tv>"
license="GPL-3.0-or-later"
homepage="https://yacy.net"
distfiles="http://latest.yacy.net/yacy_v${version}_20191013_9964.tar.gz"
checksum=@99af963642dafaeab2657ad59315e7b7896bf4c1e7091f8f67e95e71802d44df

system_accounts="yacy"
yacy_homedir="/var/lib/yacy"
yacy_shell="/bin/bash"
make_dirs="/var/lib/yacy 0755 yacy yacy"

post_extract() {
	mv ${XBPS_BUILDDIR}/{yacy,yacy-1.922}
}

do_build() {
	export JAVA_HOME=/usr/lib/jvm/java-1.8-openjdk
	ant clean all
}

do_install() {
	vmkdir var/lib/yacy
	vcopy $XBPS_BUILDDIR/yacy-1.922/* var/lib/yacy
}

post_install() {
	vsv yacy
}
