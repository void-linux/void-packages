# Template file for 'FreeFileSync'
pkgname=FreeFileSync
version=11.8
revision=1
archs="i686 x86_64"
create_wrksrc=yes
build_style=gnu-makefile
make_cmd="make -C ${pkgname}/Source exeName=FreeFileSync"
hostmakedepends="unzip"
makedepends="pkg-config libglib-devel wxWidgets-devel libcurl-devel gtk+-devel openssl-devel"
depends="wxWidgets libcurl"
short_desc="Backup software to synchronize files and folders"
maintainer="Nicolas Porcel <nicolasporcel06@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://freefilesync.org"
distfiles="${homepage}/download/FreeFileSync_${version}_Source.zip"
checksum=bf892a6eb9159fb746021d898c4a6b979b80cd12de90a95e75baec4124d83041

nopie_files="/opt/${pkgname}/Bin/FreeFileSync /opt/${pkgname}/Bin/RealTimeSync"

do_build() {
	make ${makejobs} exeName=FreeFileSync -C FreeFileSync/Source
	make ${makejobs} exeName=RealTimeSync -C FreeFileSync/Source/RealTimeSync
	unzip FreeFileSync/Build/Resources/Icons.zip FreeFileSync.png RealTimeSync.png -d FreeFileSync/Build
}

do_install() {
	vmkdir opt/${pkgname}
	vcopy FreeFileSync/Build/Bin opt/${pkgname}
	vcopy FreeFileSync/Build/Resources opt/${pkgname}

	vmkdir usr/share/pixmaps
	vinstall FreeFileSync/Build/FreeFileSync.png 0644 usr/share/pixmaps
	vinstall FreeFileSync/Build/RealTimeSync.png 0644 usr/share/pixmaps

	vmkdir usr/share/applications
	vinstall ${FILESDIR}/FreeFileSync.desktop 0644 usr/share/applications
	vinstall ${FILESDIR}/RealTimeSync.desktop 0644 usr/share/applications

	vmkdir usr/bin
	ln -s /opt/FreeFileSync/Bin/{FreeFileSync,RealTimeSync} ${DESTDIR}/usr/bin
}
