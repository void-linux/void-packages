# Template file for 'groestlcoin'
pkgname=groestlcoin
version=22.0
revision=1
build_style=gnu-configure
configure_args="--disable-ccache --disable-static
 --enable-hardening --with-boost=${XBPS_CROSS_BASE}/usr --with-gui"
hostmakedepends="automake libtool pkg-config yasm"
makedepends="db-devel boost-devel miniupnpc-devel qt5-tools-devel
 libevent-devel qrencode-devel libatomic-devel sqlite-devel"
short_desc="Groestlcoin is a peer-to-peer network based digital currency"
maintainer="Groestlcoin developers <groestlcoin@gmail.com>"
license="MIT"
homepage="https://www.groestlcoin.org/groestlcoin-core-wallet/"
distfiles="https://github.com/Groestlcoin/groestlcoin/releases/download/v${version}/groestlcoin-${version}.tar.gz
 https://raw.githubusercontent.com/Groestlcoin/packaging/${version}/debian/groestlcoin-qt.desktop
 https://raw.githubusercontent.com/Groestlcoin/groestlcoin/v${version}/share/pixmaps/groestlcoin128.png"
checksum="6c412361e7ff84e9f7cf6a25be0d18742098ddc0f91688b368b0be3e6daa46f1
 134c50eb1fbc3bd635c5e71f72891a144e49833d9f47938e22e446b625c1bc57
 ceaf8defe048b9eb47d7427c6a20587b6c0d5caabd97387982cf5c30ad59718b"
skip_extraction="groestlcoin-qt.desktop groestlcoin128.png"

if [ "$CROSS_BUILD" ]; then
	hostmakedepends+=" qt5-host-tools"
fi

pre_configure() {
	autoreconf -fi
	case "$XBPS_TARGET_MACHINE" in
	aarch64*)
		CFLAGS=${CFLAGS/armv8-a/armv8-a+crc+crypto}
		CXXFLAGS=${CXXFLAGS/armv8-a/armv8-a+crc+crypto}
		;;
	esac
}

pre_build() {
	export GROESTLCOIN_GENBUILD_NO_GIT=1
}

post_install() {
	for b in groestlcoind groestlcoin-cli groestlcoin-tx; do
		vcompletion contrib/${b}.bash-completion bash $b
	done
	vlicense COPYING
}
