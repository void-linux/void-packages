# Template file for 'libdecsync'
pkgname=libdecsync
version=2.2.1
revision=1
archs="x86_64"
build_style=gnu-makefile
hostmakedepends="gradle openjdk8 patchelf pkg-config tar"
makedepends="ncurses-devel"
short_desc="Multiplatform library for synchronizing using DecSync"
maintainer="08a <dev@08a.re>"
license="LGPL-2.0-only"
homepage="https://github.com/39aldo39/libdecsync"
distfiles="${homepage}/archive/refs/tags/v${version}.tar.gz"
checksum=3e08b35efed3bafb079aa52a8dcd51217f6602cde64accba1a10cf5c25029d45
subpackages="libdecsync-devel"
disable_parallel_build=yes

export JAVA_HOME=/usr/lib/jvm/java-1.8-openjdk

pre_install() {
	patchelf --set-soname libdecsync.so.0 build/bin/linuxX64/releaseShared/libdecsync.so
}

post_install() {
	ln -rsf "${DESTDIR}/usr/lib/libdecsync.so" "${DESTDIR}/usr/lib/libdecsync.so.0"
}

libdecsync-devel_package() {
	depends="${sourcepkg}-${version}_${revision}"
	short_desc+=" - development files"
		pkg_install() {
			vmove usr/include
			vmove usr/share/pkgconfig
		}
}
