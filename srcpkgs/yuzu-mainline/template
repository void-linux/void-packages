# Template file for 'yuzu-mainline'
pkgname=yuzu-mainline
version=1332
revision=1
_cubeb_version=75d9d125ee655ef80f3bfcd97ae5a805931042b8
_sanitizers_cmake_version=aab6948fa863bc1cbe5d0850bc46b9ef02ed4c1a
_dynarmic_version=165621a872ffb802c7a26ef5900e1e62681f1a88
_sirit_version=ab75463999f4f3291976b079d42d52ee91eebf3f
_SPIRV_Headers_version=c214f6f2d1a7253bb0e9f195c2dc5b0659dc99ef
_mbedtls_version=8c88150ca139e06aa2aae8349df8292a88148ea1
_xbyak_version=a1ac3750f9a639b5a6c6d6c7da4259b8d6790989
_SDL_version=f17058b562c8a1090c0c996b42982721ace90903
_cpp_jwt_version=e12ef06218596b52d9b5d6e1639484866a8e7067
_cpp_httplib_version=305a7abcb9b4e9e349843c6d563212e6c1bbbf21
_Vulkan_Headers_version=00671c64ba5c488ade22ad572a0ef81d5e64c803
archs="x86_64 x86_64-musl aarch64 aarch64-musl"
create_wrksrc=yes
build_wrksrc=${pkgname}-mainline-0-${version}
build_style=cmake
configure_args="-DYUZU_CHECK_SUBMODULES=OFF -DYUZU_TESTS=OFF -DTITLE_BAR_FORMAT_IDLE=yuzu-mainline-${version} -DTITLE_BAR_FORMAT_RUNNING=yuzu-mainline-${version}"
hostmakedepends="pkg-config qt5-host-tools qt5-qmake clang glslang"
makedepends="fmt-devel libenet-devel inih-devel libusb-devel liblz4-devel opus-devel zlib-devel libzstd-devel
 boost-devel qt5-devel qt5-multimedia-devel libva-devel ffmpeg-devel
 catch2 json-c++ speexdsp-devel mbedtls-devel"
short_desc="Nintendo Switch Emulator"
maintainer="Owen Law <owenlaw222@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://github.com/yuzu-emu/yuzu-mainline"
changelog="${homepage}/releases/tag/mainline-0-${version}"
distfiles="${homepage}/archive/refs/tags/mainline-0-${version}.tar.gz
 https://github.com/herumi/xbyak/archive/${_xbyak_version}.tar.gz
 https://github.com/MerryMage/dynarmic/archive/${_dynarmic_version}.tar.gz
 https://github.com/mozilla/cubeb/archive/${_cubeb_version}.tar.gz
 https://github.com/arsenm/sanitizers-cmake/archive/${_sanitizers_cmake_version}.tar.gz
 https://github.com/yuzu-emu/sirit/archive/${_sirit_version}.tar.gz
 https://github.com/KhronosGroup/SPIRV-Headers/archive/${_SPIRV_Headers_version}.tar.gz
 https://github.com/yuzu-emu/mbedtls/archive/${_mbedtls_version}.tar.gz
 https://github.com/libsdl-org/SDL/archive/${_SDL_version}.tar.gz
 https://github.com/arun11299/cpp-jwt/archive/${_cpp_jwt_version}.tar.gz
 https://github.com/yhirose/cpp-httplib/archive/${_cpp_httplib_version}.tar.gz
 https://github.com/KhronosGroup/Vulkan-Headers/archive/${_Vulkan_Headers_version}.tar.gz"
checksum="2bbb1dd3a5247912c398030867c9b360e5892e264f783f09d0f3dbe85249c458
 e6a4b7327dfa751f683abd21802539bc2e1918f750344d0274229fee798b68c4
 4261178b4e6da1d6f45b92fe7fa7c0421ec69ae845008ed3654880428a890f81
 8c5b7ca55ee586a3e5e63de2d31c319045f92e949140a734846a0d69ad342e2e
 9f5b073625375322236a94ce8d2d803cdedad321c91e63845f487b9ebfb2c433
 a2da1f9f09fc52a5d4aea905c97fae3970fe877a8727bb83e7ccda615ccd4146
 92ac55f8ded96237219d74b356eb0d8025d279f1811ecf41ef1b5299482bcc5d
 8d3553ea5c3b47789c5a1a6437f948525d0a8ce2a0897000a36b511000c6bad4
 2a149e79712027d2d8141e3233df2f6679825b6f78237db3db72bc6cfc08b845
 b4cc0e1f89d3c60a4dde74baa730a90de13c5dd5155b09d8dd34cd3205a6e758
 61a97686b03edffa737c396f54e48da2ff0a04c3f6859ec9e80853aea6508030
 99443e30caee5d2c0019de6549cc0c7c0432214494617da445753fc46374a7c3"

post_extract() {
	mv "xbyak-${_xbyak_version}" xbyak
	cp -r xbyak "${build_wrksrc}/externals"

	mv "dynarmic-${_dynarmic_version}" dynarmic
	cp -r dynarmic "${build_wrksrc}/externals"

	mv "mbedtls-${_mbedtls_version}" mbedtls
	cp -r mbedtls "${build_wrksrc}/externals"

	mv "SDL-${_SDL_version}" SDL
	cp -r SDL "${build_wrksrc}/externals"

	mv "cubeb-${_cubeb_version}" cubeb
	mv "sanitizers-cmake-${_sanitizers_cmake_version}" sanitizers-cmake
	cp -r sanitizers-cmake cubeb/cmake
	cp -r cubeb "${build_wrksrc}/externals"

	mv "sirit-${_sirit_version}" sirit
	mv "SPIRV-Headers-${_SPIRV_Headers_version}" SPIRV-Headers
	cp -r sirit "${build_wrksrc}/externals"
	cp -r SPIRV-Headers "${build_wrksrc}/externals/sirit/externals"


	mv cpp-jwt-${_cpp_jwt_version} cpp-jwt
	cp -r cpp-jwt ${build_wrksrc}/externals

	mv cpp-httplib-${_cpp_httplib_version} cpp-httplib
	cp -r cpp-httplib ${build_wrksrc}/externals

	mv Vulkan-Headers-${_Vulkan_Headers_version} Vulkan-Headers
	cp -r Vulkan-Headers ${build_wrksrc}/externals
}
