# Template file for 'Dwarf-Therapist'
pkgname=Dwarf-Therapist
version=42.1.20
revision=1
build_style=cmake
makedepends="qt5-declarative-devel libcap-devel hicolor-icon-theme"
depends="dwarffortress"
short_desc="Management tool designed to run side-by-side with Dwarf Fortress"
maintainer="Rutpiv <roger_freitas@live.com>"
license="GPL-3.0-or-later"
homepage="https://github.com/Dwarf-Therapist/Dwarf-Therapist/"
distfiles="https://github.com/Dwarf-Therapist/Dwarf-Therapist/archive/v${version}.tar.gz"
checksum=34c82433142d610a3c0aa07ca8a19f2e1e4f6c5b604e067c3cb73aeb2ceefbd0
make_check=no # No tests available.

post_build() {
	vsed -i dist/xdg/applications/dwarftherapist.desktop \
			 -e 's|^Exec=dwarftherapist$|Exec=ptrace_cap_wrapper dwarftherapist|'
}

post_install() {
	vbin dist/ptrace_scope/patch_df_ptracer
	vbin dist/ptrace_scope/ptrace_cap_wrapper
}
