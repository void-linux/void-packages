From e068785581d8b775e018ecbb000646c8cdeb6063 Mon Sep 17 00:00:00 2001
From: Nathan Owens <ndowens@artixlinux.org>
Date: Fri, 1 Jan 2021 19:34:45 -0600
Subject: [PATCH] fix cross

---
 configure.ac | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git configure.ac configure.ac
index 5b8bac3..5d2ce28 100644
--- configure.ac
+++ configure.ac
@@ -58,7 +58,12 @@ case "$host_os" in
     ;;
 esac
 
+AC_ARG_ENABLE([procmem], [AS_HELP_STRING([--disable-procmem],
+	[forcefully disable proc/pid/mem support])])
+
 AS_IF([test "x$android" = "xno"], [
+  AS_IF([test "x$enable_procmem" != "xno"],
+	[
   # also need to check if the file is zero'ed (some hardened systems)
   AC_CHECK_FILE([/proc/self/maps], [], [
     echo "This system does not seem to have /proc/pid/maps files."
@@ -75,7 +80,9 @@ AS_IF([test "x$android" = "xno"], [
     echo "This system does not seem to have /proc/pid/mem files."
     echo "Falling back to ptrace() only support."
     AC_DEFINE(HAVE_PROCMEM, [0], [Enable /proc/pid/mem support])
-  ])
+  ])],
+	[AC_DEFINE(HAVE_PROCMEM, [0], [Disable /proc/pid/mem support])]
+	)
   # malloc optimizations without Android
   AC_FUNC_MALLOC
   AC_FUNC_REALLOC
-- 
2.30.0

