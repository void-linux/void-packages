# Template file for 'ncbi-blast+'
pkgname=ncbi-blast+
version=2.17.0
revision=1
archs="x86_64"
build_wrksrc=c++
build_style=configure
configure_args="--prefix=/usr"
hostmakedepends="procps-ng cpio"
makedepends="sqlite-devel lmdb-devel libzstd-devel bzip2-devel zlib-devel libgomp-devel"
short_desc="Basic Local Alignment Search Tool by the NCBI"
maintainer="Lars van Maanen <lars@vanmaanen.de>"
license="Public Domain"
homepage="https://blast.ncbi.nlm.nih.gov/Blast.cgi"
changelog="https://www.ncbi.nlm.nih.gov/books/NBK131777/"
distfiles="https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/ncbi-blast-${version}+-src.tar.gz"
checksum=502057a88e9990e34e62758be21ea474cc0ad68d6a63a2e37b2372af1e5ea147
python_version=2

pre_configure() {
	export AR="ar cr"
}

do_install() {
	cp -r ReleaseMT/bin $DESTDIR/usr/
	cp -r ReleaseMT/lib $DESTDIR/usr/
	mkdir -p $DESTDIR/usr/include/ncbi-tools++
	cp -r include/* $DESTDIR/usr/include/ncbi-tools++/
	cp -r ReleaseMT/inc/* $DESTDIR/usr/include/ncbi-tools++/
}

post_install() {
	# This file leads to a file conflict with the package cddlib-devel,
	# so let's remove it for now...
	rm $DESTDIR/usr/lib/libcdd.a
}

ncbi-blast+-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove "usr/lib/*.a"
	}
}
