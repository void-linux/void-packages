# Template file for 'tinyramfs'
pkgname=tinyramfs
version=0.1.0
revision=1
build_style=gnu-makefile
depends="util-linux cpio binutils eudev kmod"
short_desc="Tiny initramfs written in POSIX shell"
maintainer="wael <40663@proton.me>"
license="GPL-3.0-only"
homepage="https://github.com/illiliti/tinyramfs"
distfiles="https://github.com/illiliti/tinyramfs/archive/refs/tags/${version}.tar.gz"
checksum=a78ecd56a52a02bc1f4b86ba829a957ad1f83c252bfde66562d5c3ef40be7c51
# checking requires qemu, locally this still fails
make_check=no

post_install() {
	vinstall ${FILESDIR}/kernel-hook-postinst 755 etc/kernel.d/post-install 20-tinyramfs
	vinstall ${FILESDIR}/kernel-hook-postrm 755 etc/kernel.d/post-remove 20-tinyramfs
	rm -rf ${DESTDIR}/usr/lib/dracut/hook.d/systemd-udev
}
