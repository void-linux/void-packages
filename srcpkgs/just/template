# Template file for 'just'
pkgname=just
version=1.43.0
revision=1
build_style=cargo
build_helper=qemu
make_check_args="-- --skip completions::bash" # requires git repo
checkdepends="python3"
short_desc="Just a command runner"
maintainer="cinerea0 <cinerea0@protonmail.com>"
license="CC0-1.0"
homepage="https://github.com/casey/just"
changelog="https://raw.githubusercontent.com/casey/just/master/CHANGELOG.md"
distfiles="https://github.com/casey/just/archive/refs/tags/${version}.tar.gz"
checksum=03904d6380344dbe10e25f04cd1677b441b439940257d3cc9d8c5f09d91e3065

# Fix failing test
pre_check() {
	export USER=void
}

post_install() {
	vlicense LICENSE
	_just="${DESTDIR}/usr/bin/just"
	vtargetrun "${_just}" --man > just.1
	vman just.1
	for shell in bash fish zsh; do
		vcompletion "completions/just.${shell}" "${shell}"
	done
}
