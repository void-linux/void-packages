# Template file for 'FastTree'
pkgname=FastTree
version=2.2.0
revision=1
makedepends="libgomp-devel"
short_desc="Small program for generating a gene tree from an MSA"
maintainer="Lars van Maanen <lars@vanmaanen.de>"
license="GPL-3.0-or-later"
homepage="https://github.com/morgannprice/fasttree"
changelog="https://morgannprice.github.io/fasttree/ChangeLog.txt"
distfiles="https://github.com/morgannprice/fasttree/archive/refs/tags/v${version}.tar.gz"
checksum=db5f0d2d1e2b9099193a3a68a5c44f71166a870a7a4269398b9258b1e3478e12

nocross="Cannot find omp.h (from libgomp-devel) when cross-compiling"

# Builds both the regular version and a version that supports multiple CPU threads
do_build() {
	if [ ! -d build ]; then mkdir build; fi
	cd build
	gcc -O3 -fopenmp-simd -funsafe-math-optimizations -o FastTree ../FastTree.c -lm
	gcc -DOPENMP -O3 -fopenmp -fopenmp-simd -funsafe-math-optimizations -o FastTreeMP ../FastTree.c -lm
}

do_install() {
	if [ ! -d ${DESTDIR}/usr/bin ]; then mkdir -p ${DESTDIR}/usr/bin; fi
	cp build/FastTree build/FastTreeMP ${DESTDIR}/usr/bin/
}
