# Template file for 'ydotool'
pkgname=ydotool
version=1.0.1
revision=1
build_style=cmake
hostmakedepends="pkg-config scdoc"
short_desc="Generic command-line automation tool, works on Wayland and X11"
maintainer="John Gebbie <me@johngebbie.com>"
license="AGPL-3.0-only"
homepage="https://github.com/ReimuNotMoe/ydotool"
distfiles="https://github.com/ReimuNotMoe/ydotool/archive/v${version}.tar.gz"
checksum=02311cdc608f205711b06a95e5fd71093b2294f4920efc526f5e98a2ddab42b8

system_accounts="_ydotoold"
_ydotoold_groups="input"

# Used instead of /tmp so any group input user can replace the socket.
make_dirs='/var/lib/ydotoold 0775 _ydotoold input'

post_install() {
	vinstall "${DESTDIR}/usr/bin/ydotool" 755 /usr/libexec
	vbin "${FILESDIR}/ydotool-workaround" ydotool
	vinstall "${DESTDIR}/usr/bin/ydotoold" 755 /usr/libexec
	vbin "${FILESDIR}/ydotoold-workaround" ydotoold
	vsv ydotoold
	vinstall "${FILESDIR}/80-uinput.rules" 644 usr/lib/udev/rules.d
	vinstall "${FILESDIR}/50-ydotool.conf" 644 usr/share/X11/xorg.conf.d
	vlicense LICENSE
	# https://github.com/ReimuNotMoe/ydotool/pull/168
	vman "${FILESDIR}/ydotool.1"
	vman "${FILESDIR}/ydotoold.8"
}
