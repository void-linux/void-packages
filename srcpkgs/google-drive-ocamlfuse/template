# Template file for 'google-drive-ocamlfuse'
pkgname=google-drive-ocamlfuse
version=0.7.27
revision=1
hostmakedepends="ocaml dune opam tar git rsync mercurial darcs pkg-config sqlite-devel libcurl-devel fuse-devel gmp-devel"
short_desc="FUSE Filesystem for Google Drive"
maintainer="Kyle Nusbaum <knusbaum+void@sdf.org>"
license="MIT"
homepage="https://astrada.github.io/google-drive-ocamlfuse"
distfiles="https://github.com/astrada/google-drive-ocamlfuse/archive/refs/tags/v${version}.tar.gz"
checksum=15880680ec49e83252b6b1cdc128a8f58b157a62272a64f9d03acd03154e8efd
nocross="ocaml and dune do not support cross-compilation out-of-the-box"

do_build() {
	set -x
	opam init -y
	opam install -y camlidl cryptokit extlib gapi-ocaml ocamlfuse sqlite3
	eval $(opam env)
	dune build @install
}

do_install() {
	dune install --prefix=/usr --destdir="$DESTDIR" \
	--mandir=/usr/share/man --docdir=/usr/share/doc
	vlicense LICENSE
}
