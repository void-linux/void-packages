# Template file for 'caddy2'
pkgname=caddy2
version=2.1.1
revision=1
build_style=go
go_import_path=github.com/caddyserver/caddy/v2
go_package="${go_import_path}/modules/standard"
hostmakedepends="git"
short_desc="Fast, cross-platform HTTP/2 web server with automatic HTTPS"
maintainer="Dominic Monroe <monroef4@googlemail.com>"
license="Apache-2.0"
homepage="https://caddyserver.com"
distfiles="https://github.com/caddyserver/caddy/archive/v${version}.tar.gz"
checksum=77beb13b39b670bfe9e0cc1c71b720d5b037cca60e1426a9a485bbfae34ba8d2
conflicts="caddy"

system_accounts="caddy"
make_dirs="
	/etc/caddy 0700 caddy caddy
	/var/lib/caddy 0700 caddy caddy"

post_extract() {
	mv $XBPS_BUILDDIR/caddy-${version} ${wrksrc}
	vsed -e 's,github.com/lucas-clemente/quic-go v0.17.1,github.com/lucas-clemente/quic-go v0.18.0,g' -i ${wrksrc}/go.mod
}

post_install() {
	vsv caddy
}
