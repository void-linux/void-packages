# Template file for 'coin3'
pkgname=coin3
version=4.0.0
revision=1
wrksrc=coin
build_style=cmake
build_helper=qemu
configure_args="-DCMAKE_BUILD_TYPE=None -DCOIN_BUILD_DOCUMENTATION=ON
 -DCOIN_THREADSAFE=ON -DUSE_EXTERNAL_EXPAT=ON
 -DFONTCONFIG_RUNTIME_LINKING=OFF -DFREETYPE_RUNTIME_LINKING=OFF
 -DLIBBZIP2_RUNTIME_LINKING=OFF -DOPENAL_RUNTIME_LINKING=OFF
 -DSIMAGE_RUNTIME_LINKING=OFF -DZLIB_RUNTIME_LINKING=OFF
 -DGLU_RUNTIME_LINKING=OFF"
hostmakedepends="pkg-config doxygen perl graphviz"
makedepends="freetype-devel glu-devel zlib-devel bzip2-devel
 fontconfig-devel boost-devel simage-devel"
short_desc="High-level 3D graphics toolkit"
maintainer="yopito <pierre.bourgin@free.fr>"
license="BSD-3-Clause"
homepage="https://coin3d.github.io/"
distfiles="https://github.com/coin3d/coin/releases/download/Coin-$version/coin-$version-src.tar.gz"
checksum=e4f4bd57804b8ed0e017424ad2e45c112912a928b83f86c89963df9015251476
patch_args="-Np1"

CFLAGS=-D_POSIX_SOURCE=200809L
CXXFLAGS=-D_POSIX_SOURCE=200809L

post_extract() {
	# remove bundled boost headers
	rm -rf ${wrksrc}/include/boost
}

post_install() {
	vlicense COPYING
}

coin3-devel_package() {
	short_desc+=" - development files"
	depends="${makedepends} ${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/include
		vmove usr/bin/coin-config
		vmove "usr/lib/*.so"
		vmove usr/lib/cmake
		vmove usr/lib/pkgconfig
	}
}

coin3-doc_package() {
	short_desc+=" - documentation"
	pkg_install() {
		vmove usr/share/doc
	}
}
