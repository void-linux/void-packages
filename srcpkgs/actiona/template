# Template file for 'actiona'
pkgname=actiona
version=3.11.1
revision=1
build_style=cmake
configure_args="-DACT_UPDATER=OFF -DNinja_EXECUTABLE=$XBPS_WRAPPERDIR/ninja"
hostmakedepends="pkg-config qt6-base qt6-tools"
makedepends="boost-headers libnotify-devel libopencv-devel pulseaudio-devel
 libbluetooth-devel
 qt6-declarative-private-devel qt6-multimedia-devel qt6-speech-devel qt6-tools-devel
 qt6-qt5compat-devel qt6-plugin-mysql qt6-speech-plugin-flite
 qt6-speech-plugin-speechd qt6-speech-plugin-mock"
depends="qt6-plugin-mysql"
short_desc="Cross platform automation tool"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-3.0-or-later"
homepage="https://actiona.tools/"
distfiles="https://github.com/Jmgr/actiona/archive/v${version}.tar.gz"
distfiles="https://github.com/Jmgr/actiona/releases/download/v${version}/actiona-${version}-source-linux.tar.gz"
checksum=a643ccae90f353b6558e9f61c00a8aedb5ca73c52f08bb0ccca69fc5e2a8444d

# Provide a wrapper to run ./xbps-src -j 1 build later
_wrap_ninja() {
	cat <<-'_EOF' >"$XBPS_WRAPPERDIR"/ninja
	#!/bin/sh

	exec /usr/bin/ninja $NINJAFLAGS "$@"
	_EOF
	chmod +x "$XBPS_WRAPPERDIR"/ninja
}

pre_configure() {
	_wrap_ninja
}

pre_build() {
	if [ "$XBPS_WORDSIZE" = 32 ]; then
		export NINJAFLAGS=-j2
	else
		export NINJAFLAGS="$makejobs"
	fi
}
