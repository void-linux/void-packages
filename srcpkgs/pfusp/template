# Template file for 'pfusp'
pkgname=pfusp
version=2.2.0
revision=1
archs="x86_64"
hostmakedepends="binutils tar xz"
depends="sane"
short_desc="SANE backend for Fujitsu SP series scanners"
maintainer="Joshua Kr√§mer <joshua@kraemer.link>"
license="custom:EULA"
homepage="https://imagescanner.fujitsu.com/global/dl/index-sps.html"
distfiles="https://origin.pfultd.com/downloads/IMAGE/driver/ubuntu/220/pfusp-ubuntu_${version}_amd64.deb
 https://origin.pfultd.com/downloads/IMAGE/driver/ubuntu/220/P2U3-0210-03ENZ0.pdf"
checksum="6bd1289b52a2d2574f5260dd29ea9e1a9a75bd6f02ccc904c9fc3d6f2d8642dc
 cbf3cbb95d7266a53b8203c590af8256787b588b5ba12cfb30c645edf8d2fd85"
skip_extraction="P2U3-0210-03ENZ0.pdf"
repository=nonfree
restricted=yes

do_install() {
	vcopy "*" /
	vdoc opt/pfusp/readme.txt
	vdoc opt/pfusp/readmeJPN.txt
	vdoc ${XBPS_SRCDISTDIR}/${pkgname}-${version}/P2U3-0210-03ENZ0.pdf
	vlicense opt/pfusp/LicenseENU.txt
	vlicense opt/pfusp/LicenseJPN.txt
	rm ${DESTDIR}/opt/pfusp/*.txt

	cd ${DESTDIR}/opt/pfusp
	chmod 755 bin/* consumables/* etc/pfuspsysinfo.sh lib/* pfuspgetinfo/*

	vmkdir usr/bin
	vmkdir etc
	ln -s -t ${DESTDIR}/usr/bin /opt/pfusp/consumables/pfuspconsumables
	ln -s -t ${DESTDIR}/usr/bin /opt/pfusp/bin/pfuspscanmanager
	ln -s /opt/pfusp/etc ${DESTDIR}/etc/pfusp

	cd ${FILESDIR}
	vinstall 60-pfusp.rules 644 usr/lib/udev/rules.d
	vinstall pfusp 644 etc/sane.d/dll.d
	vcopy "pfusp.conf simple-scan.conf consumablessettings.xml" opt/pfusp/etc
}
