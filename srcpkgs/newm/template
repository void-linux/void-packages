# Template file for 'newm'
pkgname=newm
version=0.3alpha
revision=1
create_wrksrc=yes
hostmakedepends="python3-devel wayland-protocols  pkg-config meson ninja git"
makedepends="pango-devel cairo-devel pixman-devel wayland-devel libevdev-devel libinput-devel glslang-devel wlroots-devel Vulkan-Headers vulkan-loader libseat-devel libxkbcommon-devel libxcb-devel xorg-server-xwayland"
depends="xorg-server-xwayland python3-evdev  python3-imageio python3-cairo python3-psutil python3-pam python3-pyfiglet python3-thefuzz python3-cairo"
short_desc="Wayland compositor written with laptops and touchpads in mind"
maintainer=" Zoh-j02r <saulobruno@usp.br>"
license="MIT"
homepage="https://github.com/jbuchermn/newm"

_wlroots_commit=e279266f714c7122e9ad97d56d047313f78cfdbe

distfiles=" ${homepage}/archive/refs/tags/v${version}.tar.gz
 https://github.com/jbuchermn/pywm/archive/refs/tags/v${version}.zip
 https://gitlab.freedesktop.org/wlroots/wlroots/-/archive/${_wlroots_commit}.tar.gz"

checksum=" 989f7c02cc4ecc3f9f390caef97a2d2713af3b6a391a895ca7e1253076102645
 2297c3bb32f716a95f0846d0fd351a3e39a00a0fa0f078d48427605a484e28e1
 e09dd1bcd08bed22b1bc61b6992511be0dc1d31f019b93e118a97882c30d65cd"

post_extract() {
	cd $wrksrc/pywm-${version}
	rmdir subprojects/wlroots
	mv -v $wrksrc/wlroots-${_wlroots_commit} subprojects/wlroots
}

do_build() {
	cd $wrksrc/pywm-${version}
	python3 setup.py build
	cd $wrksrc/newm-${version}
	python3 setup.py build
}

do_install() {
	cd $wrksrc/pywm-${version}
	python3 setup.py install --root="${DESTDIR}"
	cd $wrksrc/newm-${version}
	python3 setup.py install --root="${DESTDIR}"
}

post_install() {
	vlicense $wrksrc/newm-${version}/LICENSE
}
