# Template file for 'newm'
pkgname=newm
version=0.2
revision=1
create_wrksrc=yes
hostmakedepends="python3-devel wayland-protocols  pkg-config meson ninja git"
makedepends="pango-devel cairo-devel pixman-devel wayland-devel libevdev-devel libinput-devel glslang-devel wlroots-devel Vulkan-Headers vulkan-loader libseat-devel libxkbcommon-devel libxcb-devel xorg-server-xwayland"
depends="xorg-server-xwayland python3-evdev  python3-imageio python3-cairo python3-psutil python3-pam python3-pyfiglet python3-thefuzz python3-cairo"
short_desc="Wayland compositor written with laptops and touchpads in mind"
maintainer=" Zoh-j02r <saulobruno@usp.br>"
license="MIT"
homepage="https://github.com/jbuchermn/newm"

_wlroots_commit=0855cdacb2eeeff35849e2e9c4db0aa996d78d10

distfiles=" ${homepage}/archive/refs/tags/v${version}.tar.gz
 https://github.com/jbuchermn/pywm/archive/refs/tags/v${version}.zip
 https://github.com/swaywm/wlroots/archive/${_wlroots_commit}.tar.gz"
checksum=" a03e9a4dd51b767059f9c53049597ac6e754cee11029f66b00d32031128310b4
 4df9bcb4c98aea1f4c452a29805d96a3066109a1424612298cc7e83f4d0ae771
 c012482fafdad9bd4d9d75dcb5b61e28e5d60eb9f77ba0bec7c15ac2870fb70a"


post_extract() {
	cd $wrksrc/pywm-${version}
	rmdir subprojects/wlroots
	mv -v $wrksrc/wlroots-${_wlroots_commit} subprojects/wlroots
}

do_build() {
	cd $wrksrc/pywm-${version}
	python3 setup.py build
	cd $wrksrc/newm-${version}
	python3 setup.py build
}

do_install() {
	cd $wrksrc/pywm-${version}
	python3 setup.py install --root="${DESTDIR}"
	cd $wrksrc/newm-${version}
	python3 setup.py install --root="${DESTDIR}"
}

post_install() {
	vlicense $wrksrc/newm-${version}/LICENSE
}
