# Template file for 'fteqw'
pkgname=fteqw
version=5808
revision=1
build_wrksrc=engine
build_style=gnu-makefile
make_build_target="qcc-rel sv-rel gl-rel"
make_build_args="PKGCONFIG=pkgconf"
hostmakedepends="subversion pkgconf"
makedepends="zlib-devel gnutls-devel libpng-devel libglvnd-devel libXrandr-devel libXcursor-devel alsa-lib-devel libjpeg-turbo-devel opus-devel speex-devel libvorbis-devel freetype-devel"
short_desc="FTE Quake engine"
maintainer="Gibson <ypsvlq@gmail.com>"
license="GPL-2.0-only"
homepage="https://fte.triptohell.info"

if [ "$CROSS_BUILD" ]; then
	export PKG_CONFIG_PATH=$XBPS_CROSS_BASE/lib/pkgconfig
	export CFLAGS="-I$XBPS_CROSS_BASE/include/freetype2 -I$XBPS_CROSS_BASE/include/opus"
fi

do_fetch() {
	svn co -r$version svn://svn.code.sf.net/p/fteqw/code/trunk fteqw-$version
}

do_install() {
	cd release
	vbin fteqw-gl.db fteqw-gl
	vbin fteqw-sv.db fteqw-sv
	vbin fteqcc.db fteqcc
}

fteqw-sv_package() {
	short_desc="FTE Quake engine (server)"
	pkg_install() {
		vmove usr/bin/fteqw-sv
	}
}

fteqcc_package() {
	short_desc="FTE QuakeC compiler"
	pkg_install() {
		vmove usr/bin/fteqcc
	}
}
