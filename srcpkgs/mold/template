# Template file for 'mold'
pkgname=mold
version=1.0.3
revision=1
archs="x86_64 x86_64-musl"
build_style=gnu-makefile
hostmakedepends="cmake pkg-config"
makedepends="libstdc++-devel ripgrep openssl-devel zlib-devel"
short_desc="High-performance drop-in replacement for existing Unix linkers"
maintainer="Rahul <basicfunc@gmail.com>"
license="AGPL-3.0-only"
homepage="https://github.com/rui314/mold"
distfiles="${homepage}/archive/refs/tags/v${version}.tar.gz"
checksum=488c12058b4c7c77bff94c6f919e40b2f12c304214e2e0d7d4833c21167837c0

pre_patch() {
    # chroot-grep is built without PCRE support, so we use ripgrep instead
    vsed -i test/*.sh -e "s/grep -P/rg -P/;s/rg -\([a-yA-Z]*\)z/rg -\1U/"
}

post_install() {
	vlicense LICENSE
}
