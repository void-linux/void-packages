# Template file for 'mold'
pkgname=mold
version=1.1
revision=1
archs="x86_64 x86_64-musl"
build_style=gnu-makefile
hostmakedepends="cmake pkg-config"
makedepends="libstdc++-devel ripgrep openssl-devel zlib-devel"
short_desc="High-performance drop-in replacement for existing Unix linkers"
maintainer="Rahul <basicfunc@gmail.com>"
license="AGPL-3.0-only"
homepage="https://github.com/rui314/mold"
distfiles="${homepage}/archive/refs/tags/v${version}.tar.gz"
checksum=2f04bb2cd58797258c4f5f6f29fd2667f8b6c6b2bc76c731fede526884ea9a0c

pre_patch() {
    # chroot-grep is built without PCRE support, so we use ripgrep instead
    vsed -i test/*.sh -e "s/grep -P/rg -P/;s/rg -\([a-yA-Z]*\)z/rg -\1U/"
}

post_install() {
	vlicense LICENSE
}
