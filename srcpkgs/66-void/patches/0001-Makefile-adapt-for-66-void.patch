From b2d94d4a2505ab2b6f07b96e9373331f64489a0c Mon Sep 17 00:00:00 2001
From: mobinmob <mobinmob@disroot.org>
Date: Sat, 8 Oct 2022 08:21:14 +0300
Subject: [PATCH] Makefile: adapt for 66-void.

---
 Makefile | 34 +++++++++-------------------------
 1 file changed, 9 insertions(+), 25 deletions(-)

diff --git a/Makefile b/Makefile
index 08117ab..3ec70e2 100644
--- a/Makefile
+++ b/Makefile
@@ -1,5 +1,5 @@
-PREFIX ?=	/usr/local
-SCRIPTS=	1 2 3 ctrlaltdel
+DESTDIR ?=
+PREFIX ?= /usr/local
 
 all:
 	$(CC) $(CFLAGS) halt.c -o halt $(LDFLAGS)
@@ -8,41 +8,25 @@ all:
 	$(CC) $(CFLAGS) seedrng.c -o seedrng $(LDFLAGS)
 
 install:
-	install -d ${DESTDIR}/${PREFIX}/sbin
-	install -m755 halt ${DESTDIR}/${PREFIX}/sbin
-	install -m755 pause ${DESTDIR}/${PREFIX}/sbin
-	install -m755 vlogger ${DESTDIR}/${PREFIX}/sbin
-	install -m755 shutdown ${DESTDIR}/${PREFIX}/sbin/shutdown
-	install -m755 modules-load ${DESTDIR}/${PREFIX}/sbin/modules-load
-	install -m755 seedrng ${DESTDIR}/${PREFIX}/sbin/seedrng
-	install -m755 zzz ${DESTDIR}/${PREFIX}/sbin
-	ln -sf zzz ${DESTDIR}/${PREFIX}/sbin/ZZZ
-	ln -sf halt ${DESTDIR}/${PREFIX}/sbin/poweroff
-	ln -sf halt ${DESTDIR}/${PREFIX}/sbin/reboot
+	install -d ${DESTDIR}/${PREFIX}/bin
+	install -m755 pause ${DESTDIR}/${PREFIX}/bin
+	install -m755 vlogger ${DESTDIR}/${PREFIX}/bin
+	install -m755 modules-load ${DESTDIR}/${PREFIX}/bin/modules-load
+	install -m755 seedrng ${DESTDIR}/${PREFIX}/bin/seedrng
+	install -m755 zzz ${DESTDIR}/${PREFIX}/bin
+	ln -sf zzz ${DESTDIR}/${PREFIX}/bin/ZZZ
 	install -d ${DESTDIR}/${PREFIX}/share/man/man1
 	install -m644 pause.1 ${DESTDIR}/${PREFIX}/share/man/man1
 	install -d ${DESTDIR}/${PREFIX}/share/man/man8
 	install -m644 zzz.8 ${DESTDIR}/${PREFIX}/share/man/man8
-	install -m644 shutdown.8 ${DESTDIR}/${PREFIX}/share/man/man8
-	install -m644 halt.8 ${DESTDIR}/${PREFIX}/share/man/man8
 	install -m644 modules-load.8 ${DESTDIR}/${PREFIX}/share/man/man8
 	install -m644 vlogger.8 ${DESTDIR}/${PREFIX}/share/man/man8
-	ln -sf halt.8 ${DESTDIR}/${PREFIX}/share/man/man8/poweroff.8
-	ln -sf halt.8 ${DESTDIR}/${PREFIX}/share/man/man8/reboot.8
 	install -d ${DESTDIR}/etc/sv
 	install -d ${DESTDIR}/etc/runit/runsvdir
-	install -d ${DESTDIR}/etc/runit/core-services
-	install -m644 core-services/*.sh ${DESTDIR}/etc/runit/core-services
-	install -m755 ${SCRIPTS} ${DESTDIR}/etc/runit
-	install -m644 functions $(DESTDIR)/etc/runit
-	install -m644 crypt.awk  ${DESTDIR}/etc/runit
 	install -m644 rc.conf ${DESTDIR}/etc
 	install -m755 rc.local ${DESTDIR}/etc
-	install -m755 rc.shutdown ${DESTDIR}/etc
 	install -d ${DESTDIR}/${PREFIX}/lib/dracut/dracut.conf.d
 	install -m644 dracut/*.conf ${DESTDIR}/${PREFIX}/lib/dracut/dracut.conf.d
-	ln -sf /run/runit/reboot ${DESTDIR}/etc/runit/
-	ln -sf /run/runit/stopit ${DESTDIR}/etc/runit/
 	cp -R --no-dereference --preserve=mode,links -v runsvdir/* ${DESTDIR}/etc/runit/runsvdir/
 	cp -R --no-dereference --preserve=mode,links -v services/* ${DESTDIR}/etc/sv/
 
-- 
2.38.0

