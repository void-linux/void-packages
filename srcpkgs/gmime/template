# Template file for 'gmime'
pkgname=gmime
version=2.6.20
revision=2
build_style=gnu-configure
configure_args="--disable-static --disable-mono --enable-smime --with-gpgme-prefix=${XBPS_CROSS_BASE}/usr"
hostmakedepends="pkg-config intltool"
makedepends="glib-devel gpgme-devel"
short_desc="GNOME Core mime parsing library"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
homepage="http://www.gnome.org/"
distfiles="${GNOME_SITE}/gmime/${version%.*}/gmime-${version}.tar.xz"
checksum=e0a170fb264c2ae4cecd852f4e7aaddb8d58e8f3f0b569ce2d2a4704f55bdf65

case "$XBPS_TARGET_MACHINE" in
	# glibc
	i686|x86_64|armv?l)
		configure_args+=" am_cv_func_iconv=yes am_cv_func_iconv_works=yes"
		configure_args+=" am_cv_lib_iconv=no ac_cv_have_iconv_detect_h=yes"
		configure_args+=" am_cv_proto_iconv_arg1="
		pre_build() {
			cp ${FILESDIR}/*.h ${wrksrc}
		}
		;;
esac

gmime-devel_package() {
	depends="libglib-devel zlib-devel gmime>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
		vmove usr/share/gtk-doc
	}
}
