# Template file for 'ispc'
pkgname=ispc
version=1.28.2
revision=1
_llvmver=19
archs="aarch64* x86_64*"
build_style=cmake
configure_args="-DISPC_INCLUDE_EXAMPLES=OFF -DISPC_INCLUDE_RT=OFF
 -DLLVM_DIR=${XBPS_CROSS_BASE}/usr/lib/llvm/${_llvmver}/lib/cmake/llvm
 -DClang_DIR=${XBPS_CROSS_BASE}/usr/lib/llvm/${_llvmver}/lib/cmake/clang"
hostmakedepends="clang${_llvmver} clang-tools-extra${_llvmver} python3 m4 bison flex"
makedepends="llvm${_llvmver}-devel ncurses-devel ncurses-libtinfo-devel zlib-devel"
short_desc="Compiler for high-performance SIMD programming on the CPU"
maintainer="Andrea Brancaleoni <abc@pompel.me>"
license="BSD-3-Clause"
homepage="https://ispc.github.io"
distfiles="https://github.com/ispc/ispc/archive/v${version}.tar.gz"
checksum=0b7d1d73afa93c015814b99c97b88fa45bce822d7904e8fc4a95666ba8e3fb92
nocross=yes
nopie=yes

# hack to make -m32 work so it can build 32-bit target
case "$XBPS_TARGET_MACHINE" in
	x86_64) hostmakedepends+=" gcc-multilib";;
esac

post_install() {
	vlicense LICENSE.txt
}
