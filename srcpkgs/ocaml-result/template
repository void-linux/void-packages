# Template file for 'ocaml-result'
pkgname=ocaml-result
version=1.3
revision=1
wrksrc="result-${version}"
hostmakedepends="ocaml dune"
short_desc="OCaml Compatibility Result module"
maintainer="John Zimmermann <johnz@posteo.net>"
license="BSD-3-Clause"
homepage="https://github.com/janestreet/result"
changelog="https://github.com/janestreet/result/blob/${version}/CHANGES.md"
distfiles="https://github.com/janestreet/result/archive/${version}.tar.gz"
checksum=47a4a7abca084ac844716b047d4b26eacbd96174034c8836f35cd400e84c8db4
nocross=yes

do_build() {
	export OPAMROOT="${wrksrc}/.opam"
	opam init -n
	jbuilder build
}

do_install() {
	vmkdir $(ocamlfind printconf destdir)
	jbuilder install --prefix "${DESTDIR}/usr" \
	--libdir "${DESTDIR}$(ocamlfind printconf destdir)"
	mv ${DESTDIR}/usr/{doc,share/}
	vlicense LICENSE.md
}
