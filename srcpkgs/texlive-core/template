# Template file for 'texlive-core'
pkgname=texlive-core
version=20250308
revision=1
depends="fontforge python3 python3-Pygments perl perl-File-Which"
short_desc="TeX Live - core texmf distribution"
maintainer="fosslinux <fosslinux@aussies.space>"
license="GPL-2.0-or-later"
homepage="https://tug.org/texlive"
distfiles="https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/${version:0:4}/texlive-${version}-texmf.tar.xz
 https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/${version:0:4}/texlive-${version}-extra.tar.xz"
checksum="08dcda7430bf0d2f6ebb326f1e197e1473d3f7cc0984a2adb7236df45316c7cf
 ea69cfecbc9b138acbc45476e8cb4d9357f5e4e45fd12b3bf9ceabbebd7669d2"
python_version=3
make_dirs="/var/lib/texmf 0755 root root"
nostrip=yes

post_extract() {
	mv texlive-${version}-texmf/* .
}

do_install() {
	# non-PIE executable found in PIE build
	rm -f texmf-dist/doc/luatex/opbible/txs-gen/mod2tex

	rm -f texmf-dist/ls-R

	vmkdir usr/share
	vcopy texmf-dist usr/share

	vinstall ${wrksrc}/texlive-${version}-extra/tlpkg/texlive.tlpdb 0644 usr/share/tlpkg
	vcopy ${wrksrc}/texlive-${version}-extra/tlpkg/TeXLive usr/share/tlpkg
}

texlive-core-doc_package() {
	nostrip=yes
	short_desc+=" - documentation"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/share/texmf-dist/doc
	}
}
