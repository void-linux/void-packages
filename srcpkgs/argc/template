# Template file for 'argc'
pkgname=argc
version=1.23.0
revision=1
build_style=cargo
build_helper=qemu
# test fails in ci
make_check_args="-- --skip bind_env"
short_desc="Bash CLI framework, also a Bash command runner"
maintainer="Andy Weidenbaum <atweiden@tutanota.de>"
license="Apache-2.0, MIT"
homepage="https://github.com/sigoden/argc"
changelog="https://github.com/sigoden/argc/releases"
distfiles="https://github.com/sigoden/argc/archive/v${version}.tar.gz"
checksum=d3eb85faf26a69c582dcea6d0fc2025bcfeec1dd0b9b35384a67059c2833103c

post_extract() {
	# no docs/ subdirectory on void
	vsed -i -e 's#\./docs/##g' README.md
}

post_install() {
	vlicense LICENSE-MIT

	vdoc README.md
	vcopy "docs/*" "usr/share/doc/$pkgname"

	vmkdir "usr/share/examples/$pkgname"
	vcopy "examples/*" "usr/share/examples/$pkgname"

	for shell in bash fish zsh; do
		vtargetrun ${DESTDIR}/usr/bin/argc --argc-completions ${shell} > argc.${shell}
		vcompletion argc.${shell} ${shell}
	done
}
