# Template file for 'softhsm'
pkgname=softhsm
version=2.6.1
revision=2
build_style=gnu-configure
configure_args="--with-crypto-backend=openssl
 --with-objectstore-backend-db
 p11test"
hostmakedepends="pkg-config automake libtool sqlite"
makedepends="openssl-devel sqlite-devel p11-kit-devel"
checkdepends="libcppunit-devel"
short_desc="Cryptographic store accessible through a PKCS #11 interface"
maintainer="Duncaen <duncaen@voidlinux.org>"
license="BSD-2-Clause"
homepage="https://www.opendnssec.org/softhsm/"
distfiles="https://github.com/softhsm/SoftHSMv2/archive/refs/tags/${version}.tar.gz"
checksum=e3daff28b164611b1f080401d4d70edd0944f692385a7ef75eba5ce056c8c9ca

make_check=no # hangs

conf_files="/etc/softhsm2.conf"

pre_configure() {
	./autogen.sh
}

post_install() {
	vlicense LICENSE
	rm "${DESTDIR}/etc/softhsm2.conf.sample"
}
