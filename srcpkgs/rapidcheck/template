# Template file for 'rapidcheck'

# Upstream has no tags or release versioning, see:
# https://github.com/emil-e/rapidcheck/issues/255
# Commit here was picked based on what works to build nix.
# https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/libraries/rapidcheck/default.nix
pkgname=rapidcheck
version=r1010.b78f892
_commit=b78f89288c7e086d06e2a1e10b605d8375517a8a
revision=1
build_style=cmake
configure_args="-DCMAKE_POSITION_INDEPENDENT_CODE=True -DRC_ENABLE_EXAMPLES=Off -DRC_ENABLE_TESTS=Off -DRC_INSTALL_ALL_EXTRAS=On"
short_desc="QuickCheck clone for C++"
maintainer="Vladimir Krivopalov <vladimir.krivopalov@gmail.com>"
license="BSD-2-Clause"
homepage="https://github.com/emil-e/rapidcheck"
hostmakedepends="git cmake"

do_fetch() {
    rm -rf ${wrksrc}
    git clone \
    --filter=blob:none \
    https://github.com/emil-e/rapidcheck ${wrksrc}
    cd ${wrksrc}
    git checkout ${_commit}
}

post_install() {
    cd ${wrksrc}
    cmake -P "build/cmake_install.cmake"
    install -Dm0644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE.md
}
