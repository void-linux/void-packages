From b2b12809c7fb291543237ad2521f20428f19bcaa Mon Sep 17 00:00:00 2001
From: Joris Vink <joris@coders.se>
Date: Tue, 21 Oct 2025 17:48:56 +0200
Subject: [PATCH 1/2] Initial support for Python 3.14.x

---
 src/python.c | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/src/python.c b/src/python.c
index 16d87da..5175e39 100644
--- a/src/python.c
+++ b/src/python.c
@@ -70,10 +70,20 @@
 #pragma GCC diagnostic ignored		"-Wpedantic"
 #endif
 
+#if PY_VERSION_HEX >= 0x030e0000
+#pragma GCC diagnostic ignored		"-Wcast-qual"
+#pragma GCC diagnostic ignored		"-Wtypedef-redefinition"
+#endif
+
 #if PY_VERSION_HEX < 0x030d0000
 #define _PyFrame_GetCode(frame)		(frame->f_code)
 #endif
 
+#if PY_VERSION_HEX >= 0x030e0000
+#include <internal/pycore_interpframe.h>
+#include <internal/pycore_interpframe_structs.h>
+#endif
+
 #if PY_VERSION_HEX >= 0x030b0000
 #include <internal/pycore_frame.h>
 #endif
@@ -1250,7 +1260,9 @@ python_coro_trace(const char *label, struct python_coro *coro)
 
 	obj = (PyCoroObject *)coro->obj;
 
-#if PY_VERSION_HEX >= 0x030b0000
+#if PY_VERSION_HEX >= 0x030e0000
+	frame = (_PyInterpreterFrame *)&obj->cr_iframe;
+#elif PY_VERSION_HEX >= 0x030b0000
 	frame = (_PyInterpreterFrame *)obj->cr_iframe;
 #else
 	frame = obj->cr_frame;
-- 
2.51.2

