# Template file for 'asciidoctor'
pkgname=asciidoctor
version=1.5.7.1
revision=1
noarch=yes
create_wrksrc=yes
hostmakedepends="ruby"
depends="ruby"
short_desc="Ruby implementation of AsciiDoc"
maintainer="maxice8 <thinkabit.ukim@gmail.com>"
license="MIT"
homepage="https://asciidoctor.org"
distfiles="https://rubygems.org/downloads/$pkgname-$version.gem"
checksum=3cd8144a7b7cd71e7886cf0151536f4938ff2a51f708fcdc3f6f3371d85fa26c
skip_extraction="${pkgname}-${version}.gem"

do_install() {
	local gemdir="$(ruby -e 'puts Gem.default_dir')"

	gem install \
		--local \
		--instal-dir "$DESTDIR"/${gemdir} \
		--ignore-dependencies \
		--verbose \
		--no-document \
		${XBPS_SRCDISTDIR}/${pkgname}-${version}/${pkgname}-${version}.gem

	rm -rf "$DESTDIR"/$gemdir/cache

	for i in usr/lib/ruby/gems/*/bin/*; do
		mkdir -p "$DESTDIR"/usr/bin
		ln -sr $DESTDIR/$i "$DESTDIR"/usr/bin/
	done
}
