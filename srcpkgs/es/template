# Template file for 'es'
pkgname=es
version=0.9.1
revision=1
create_wrksrc=yes
build_style=gnu-configure
configure_args="--with-readline"
hostmakedepends="bison"
makedepends="readline-devel"
register_shell="/bin/es"
short_desc="Functional shell with rc-inspired syntax"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="Public Domain"
homepage="http://hawkwind.cs.toronto.edu:8001/mlists/es.html"
distfiles="https://github.com/wryun/es-shell/releases/download/v${version}/${pkgname}-${version}.tar.gz"
checksum=b0b41fce99b122a173a06b899a4d92e5bd3cc48b227b2736159f596a58fff4ba
nocross=yes

post_extract() {
	sed -i '/_STDLIB_H/d' parse.y
	sed -i 's/CLK_TCK/CLOCKS_PER_SEC/g' prim-sys.c
	sed -i -e 's/va_arg(format->args, short)/va_arg(format->args, int)/' \
		-e 's/format->args = saveargs/memcpy(format->args, saveargs, sizeof(va_list));/' print.c
}

do_install() {
	vbin es
	vbin esdebug
	vman doc/es.1
}

