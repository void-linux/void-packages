# Template file for 'es'
pkgname=es
version=0.9.1
revision=1
create_wrksrc=yes
build_style=gnu-configure
configure_args="--with-readline es_cv_abused_getenv=no
 ac_cv_func_wait3_rusage=yes"
make_check_target=trip
hostmakedepends="bison"
makedepends="readline-devel"
short_desc="Functional shell with rc-inspired syntax"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="Public Domain"
homepage="http://hawkwind.cs.toronto.edu:8001/mlists/es.html"
distfiles="https://github.com/wryun/es-shell/releases/download/v${version}/es-${version}.tar.gz"
checksum=b0b41fce99b122a173a06b899a4d92e5bd3cc48b227b2736159f596a58fff4ba
nocross="Build generators with object code from target without decoupling chance"

register_shell="/bin/es"

pre_configure() {
	vsed -e 's/CLK_TCK/CLOCKS_PER_SEC/g' -i prim-sys.c
	vsed -e 's/format->args = saveargs/memcpy(format->args, saveargs, sizeof(va_list));/' \
		 -i print.c
}

post_install() {
	vbin esdebug
}
