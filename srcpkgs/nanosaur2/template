# Template file for 'nanosaur2'
pkgname=nanosaur2
version=2.1.0
revision=1
_pomme_rev=6e4ea042ba9e7e525d3930e45662be15605153c4
build_style=cmake
makedepends="SDL2-devel"
short_desc="Pangea Softwareâ€™s Nanosaur II for modern systems"
maintainer="Duncaen <duncaen@voidlinux.org>"
license="CC-BY-NC-SA-4.0"
homepage="https://jorio.itch.io/nanosaur2"
changelog="https://raw.githubusercontent.com/jorio/Nanosaur2/refs/heads/master/CHANGELOG.md"
distfiles="https://github.com/jorio/Nanosaur2/archive/refs/tags/v${version}.tar.gz
 https://github.com/jorio/Pomme/archive/${_pomme_rev}.tar.gz>pomme-${_pomme_rev}.tar.gz"
checksum="fcf64a96baa88c405f228ab9d177aa36cfa30325b23413d9dc6622e3f17f94bf
 752a18a8e7d8cbd7937f1bf7ef3ae1ed5bc8e0a52c55b039e2f01098d4d92b67"

repository=nonfree

skip_extraction="pomme-${_pomme_rev}.tar.gz"

post_extract() {
	vsrcextract -C extern/Pomme "pomme-${_pomme_rev}.tar.gz"
}

do_install() {
	vmkdir usr/bin
	vmkdir usr/lib/nanosaur2
	vinstall build/Nanosaur2 755 usr/lib/nanosaur2
	vinstall packaging/nanosaur2.desktop 644 usr/share/applications
	vcopy build/Data usr/lib/nanosaur2/Data
	vinstall packaging/nanosaur2-desktopicon.png 644 usr/share/icons/hicolor/256x256/apps
	cat <<-EOF >Nanosaur2
	#!/bin/sh
	cd /usr/lib/nanosaur2
	exec /usr/lib/nanosaur2/Nanosaur2
	EOF
	vbin Nanosaur2
}
