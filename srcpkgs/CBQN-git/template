# Template file for 'CBQN-git'
pkgname=CBQN-git
version=20230503
revision=1
_commit=23737cc4580c995aac76a8a5bae4ca39492968fd
hostmakedepends="git clang libffi-devel"
depends="libffi"
short_desc="BQN implementation in C"
maintainer="Bryce Vandegrift <bryce@brycevandegrift.xyz>"
license="GPL-3.0-only, MIT, Apache-2.0, BSL-1.0"
homepage="https://github.com/dzaima/CBQN"

do_fetch() {
	git clone https://github.com/dzaima/CBQN.git $wrksrc
	cd $wrksrc
	git reset --hard $_commit
}

do_patch() {
	sed -i '/SHELL =.*/ d' makefile
}

do_build() {
	make REPLXX=1
}

do_install() {
	vbin BQN bqn

	vlicense licenses/LICENSE-Apache2
	vlicense licenses/LICENSE-Boost
	vlicense licenses/LICENSE-GPLv3
	vlicense licenses/LICENSE-MIT-sort

	vdoc docs/commands.md
	vdoc docs/system.md
}
