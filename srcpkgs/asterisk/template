# Template file for 'asterisk'
pkgname=asterisk
version=19.6.0
revision=1
build_style=gnu-configure
build_helper=qemu
conf_files="/etc/asterisk/*.conf"
make_dirs="/var/log/asterisk 0755 _asterisk _asterisk
 /var/cache/asterisk 0755 _asterisk _asterisk
 /var/lib/asterisk 0755 _asterisk _asterisk
 /var/spool/asterisk 0755 _asterisk _asterisk"
hostmakedepends="curl tar pkg-config"
makedepends="openssl-devel libedit-devel libuuid-devel jansson-devel
 libxml2-devel sqlite-devel speex-devel libvorbis-devel libgsm-devel
 alsa-lib-devel libbluetooth-devel libsrtp-devel"
short_desc="Complete PBX solution"
maintainer="teldra <teldra@rotce.de>"
license="GPL-2.0-only WITH custom:OpenSSL-Exception"
homepage="https://asterisk.org"
changelog="https://downloads.asterisk.org/pub/telephony/asterisk/ChangeLog-19-current"
distfiles="https://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-${version}.tar.gz"
checksum=4a382d9659f5dde6e654dfd5c7dc1b491ccaa6251577c6c51b94bc09aa8c6572
python_version=3
system_accounts="_asterisk"

do_configure() {
	vtargetrun bash configure
}

do_build() {
	vtargetrun make
}

post_install() {
	make DESTDIR="${DESTDIR}" samples
	chmod -R 0755 ${DESTDIR}/var/*/asterisk
	vsv asterisk
	for f in LICENSE COPYING; do
		vlicense $f
	done
}
