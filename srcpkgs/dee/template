# Template file for 'dee'
pkgname=dee
version=1.2.7+17.10.20170616
revision=1
build_style=gnu-configure
configure_args="--prefix=/usr --sysconfdir=/etc --localstatedir=/var \
 --disable-static --disable-tests"
hostmakedepends="automake gobject-introspection gtk-doc pkg-config vala"
makedepends="glib-devel icu-devel"
depends="dbus-glib python python3 python3-gobject"
short_desc="Model to synchronize multiple instances over DBus"
maintainer="Earldridge Jazzed Pineda <earldridgejazzedpineda@gmail.com>"
license="LGPL-3.0-only"
homepage="https://launchpad.net/dee"
distfiles="https://launchpad.net/ubuntu/+archive/primary/+files/dee_${version}.orig.tar.gz"
checksum=e63f979a7a5012a7786786f8081a9279256ab28ece6e557c6ce5bf87535ae899
CFLAGS="-Wno-error"

pre_configure() {
	autoreconf -fi
	export PYTHON="/usr/bin/python"
}

post_configure() {
	sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
}

dee-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision} libglib-devel"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove usr/lib/pkgconfig
		vmove usr/share/gir-1.0
		vmove usr/share/vala
	}
}
