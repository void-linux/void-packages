# Template file for 'radicale2'
pkgname=radicale2
version=2.1.10
revision=1
archs=noarch
wrksrc="Radicale-${version}"
build_style=python3-module
pycompile_module="radicale"
hostmakedepends="python3 python3-setuptools"
depends="python3-pam python3-requests python3-dulwich python3-vobject
 python3-dateutil python3-passlib python3-bcrypt"
# added passlib and bcrypt, since its seems to be the safest option.
short_desc="Complete calendar and contact storing and manipulating solution"
maintainer="teldra <teldra@rotce.de>"
license="GPL-3.0-or-later"
homepage="https://radicale.org"
distfiles="${PYPI_SITE}/R/Radicale/Radicale-${version}.tar.gz"
checksum=d5c60b57ddc233fce426430710a3c521c7ffd5a0f05b02d2d4ce6f6631194832
conflicts="radicale"
provides="radicale-${version}_${revision}"
conf_files="
 /etc/radicale/config
 /etc/sv/radicale/log/run"
make_dirs="
 /etc/radicale 755 root root
 /usr/share/radicale/ 755 root root
 /var/log/radicale/ 700 root root
 /var/lib/radicale 750 radicale radicale"
system_accounts="radicale"
radicale_homedir="/var/lib/radicale"

post_install() {
	vinstall config 644 etc/radicale/
	vinstall radicale.fcgi 644 usr/share/radicale
	vinstall radicale.wsgi 644 usr/share/radicale
	vsv radicale
}
