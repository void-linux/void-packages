# Template file for 'freebasic'
pkgname=freebasic
version=1.10.2
revision=1
build_style=gnu-makefile
hostmakedepends="ncurses-devel"
makedepends="ncurses-devel libXpm-devel gpm-devel libffi-devel libXrandr-devel MesaLib-devel"
short_desc="BASIC compiler, with syntax similar to MS-QuickBASIC"
maintainer="Mihail Ivanchev <contact@ivanchev.net>"
license="GPL-2.0-or-later"
homepage="https://www.freebasic.net/"
distfiles="https://github.com/freebasic/fbc/releases/download/1.10.1/FreeBASIC-1.10.1-source-bootstrap.tar.xz
 https://github.com/freebasic/fbc/archive/refs/tags/${version}.tar.gz"
checksum="2fae2c66b435240d4de11bb534843baa188574508a8a5bdaa5020bf729bf0a3e
 a16d8d7a4e2f150020f9ab0872944c4bf2d35c42d23978ec8274236b3695654c"
build_wrksrc="fbc-${version}"
nostrip=yes


pre_build() {
	# FIXME: Remove bootstrapping once we support FreeBASIC
	cd ../FreeBASIC-1.10.1-source-bootstrap
	make $makejobs bootstrap-minimal
	export PATH="${PWD}/bin:$PATH"
	export FBCFLAGS="-i ${PWD}/inc"

	if [ -n "$CROSS_BUILD" ]; then
		export TARGET=$XBPS_CROSS_TRIPLET
	fi
}
