# Template file for 'libudev-zero'
pkgname=libudev-zero
version=1.0.3
revision=1
_UDEV_VERSION=251
_eudev_version=3.2.14_1
build_style=gnu-makefile
short_desc="Daemonless replacement for libudev"
maintainer="dkwo <npiazza@disroot.org>"
license="ISC"
homepage="https://github.com/illiliti/libudev-zero"
distfiles="https://github.com/illiliti/libudev-zero/archive/refs/tags/${version}.tar.gz"
checksum=0bd89b657d62d019598e6c7ed726ff8fed80e8ba092a83b484d66afb80b77da5
make_check=no # no tests
provides="libudev-${_UDEV_VERSION}_${revision} eudev-libudev-${_eudev_version}"
replaces="eudev-libudev>=0"

post_build() {
	"$CC" $LDFLAGS $CFLAGS $CPPFLAGS -o libudev-zero-helper contrib/helper.c
}

post_install() {
	vlicense LICENSE
}

libudev-zero-devel_package() {
	provides="libudev-devel-${_UDEV_VERSION}_${revision} eudev-libudev-devel-${_eudev_version}"
	replaces="eudev-libudev-devel>=0"
	depends="libudev-zero>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.a"
		vmove "usr/lib/*.so"
	}
}

libudev-zero-helper_package() {
	depends="libudev-zero>=${version}_${revision}"
	short_desc+=" - helper"
	pkg_install() {
		vinstall libudev-zero-helper 755 usr/libexec
	}
}
