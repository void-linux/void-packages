# Template file for 'STM32CubeMX'
pkgname=STM32CubeMX
version=5.6.1
revision=1
create_wrksrc=yes
hostmakedepends="ImageMagick poppler"
depends="openjdk8"
short_desc="STM32Cube initialization code generator"
maintainer="Ã‰rico Nogueira <ericonr@disroot.org>"
license="custom:Proprietary"
homepage="https://www.st.com/en/development-tools/stm32cubemx.html"
distfiles="https://sw-center.st.com/packs/resource/library/stm32cube_mx_v${version//./}.zip"
checksum=e554e11a44b0400e6a235a7a579e83a616c2493566386f33e2a8ffc2cd62f164
repository=nonfree
nostrip=yes
nopie=yes

do_build() {
	convert "help/STM32CubeMX.ico[17]" stm32cubemx.png

	rm -rf intInstall/

	pdftotext -l 2 -eol unix -nopgbrk help/software_license_agreement.pdf LICENSE
}

do_install() {
	vmkdir "opt/${pkgname}"
	vcopy . "opt/${pkgname}"

	vbin "${FILESDIR}/STM32CubeMX"

	vinstall "${FILESDIR}/STM32CubeMX.desktop" 0644 usr/share/applications
	vinstall stm32cubemx.png 0644 usr/share/pixmaps

	vlicense LICENSE
}
