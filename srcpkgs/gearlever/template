# Template file for 'gearlever'
pkgname=gearlever
version=4.3.0
revision=1
build_style=meson
hostmakedepends="desktop-file-utils gettext glib-devel gtk4-update-icon-cache"
depends="libadwaita python3-dbus python3-gobject python3-xdg python3-requests
 7zip python3-ftputil python3-desktop-entry-lib squashfs-tools"
short_desc="Manage AppImages with ease"
maintainer="Pierre Sabbagh <sabbaghpierre@proton.me>"
license="GPL-3.0-or-later"
homepage="https://github.com/mijorus/gearlever"
changelog="https://github.com/mijorus/gearlever/releases"
distfiles="https://github.com/mijorus/gearlever/archive/${version}.tar.gz"
checksum=97c380cb39a6f08d98c5f18eebf89b3cfbb4afe8ed45d7eac9aa8c93e5cfae41
nopie_files="demo.AppImage"
nostrip_files="demo.AppImage"
ignore_elf_files="/usr/share/gearlever/gearlever/assets/demo.AppImage"

post_install() {
	# demo only works with x86_64-glibc and its a random binary without
	# source, get rid of it.
	rm -f "${DESTDIR}/usr/share/gearlever/gearlever/assets/demo.AppImage"
	# fix helper script error
	vbin "${wrksrc}/build-aux/get_appimage_offset.sh" "${DESTDIR}/usr/bin/get_appimage_offset"
}
