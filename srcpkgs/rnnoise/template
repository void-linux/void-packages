# Template file for 'rnnoise'
pkgname=rnnoise
reverts="0.4.1_1"
version=0.2
revision=1
# Update at the same time as the package, stored in "model_version" in tarball
_modelhash=0b50c45
build_style=gnu-configure
hostmakedepends="automake libtool"
short_desc="Recurrent neural network for audio noise reduction"
maintainer="Louis Dupr√© Bertoni <contact@louisdb.xyz>"
license="BSD-3-Clause"
homepage="https://jmvalin.ca/demo/rnnoise/"
distfiles="https://github.com/xiph/rnnoise/archive/refs/tags/v${version}.tar.gz
 https://media.xiph.org/rnnoise/models/rnnoise_data-${_modelhash}.tar.gz"
checksum="e4a17eb1493b7551f9f7781d2acc67b8847d6ed7c4b64db0fd62c017021ae1ec
 4ac81c5c0884ec4bd5907026aaae16209b7b76cd9d7f71af582094a2f98f4b43"
skip_extraction="rnnoise_data-${_modelhash}.tar.gz"

post_extract() {
	vsrcextract -C ${wrksrc} --no-strip-components rnnoise_data-${_modelhash}.tar.gz
}

pre_configure() {
	autoreconf -if
}

post_install() {
	vlicense COPYING
}

rnnoise-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.a"
		vmove "usr/lib/*.so"
	}
}
