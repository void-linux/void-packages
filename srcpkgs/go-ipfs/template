# Template file for 'go-ipfs'
pkgname=go-ipfs
version=0.17.0
revision=1
build_style=go
go_import_path="github.com/ipfs/kubo"
go_package="${go_import_path}/cmd/ipfs ${go_import_path}/cmd/ipfswatch"
hostmakedepends="git"
depends="fs-repo-migrations>=1.7.1"
short_desc="Global versioned P2P merkle DAG file system - kubo"
maintainer="Christopher Brannon <chris@the-brannons.com>"
license="MIT, Apache-2.0"
homepage="https://ipfs.tech"
changelog="https://github.com/ipfs/kubo/blob/master/CHANGELOG.md"
distfiles="https://github.com/ipfs/kubo/archive/v${version}.tar.gz"
checksum=de9f5838464967b8d933c5ac28d7dccd7f9e28257604962df1ca73770768053f

system_accounts="_ipfs"
make_dirs="/var/lib/ipfs 0700 _ipfs _ipfs"
_ipfs_homedir="/var/lib/ipfs"

pre_build() {
	if [ "$CROSS_BUILD" ]; then
		export CGO_ENABLED=0
	fi
}

post_install() {
	vlicense LICENSE-MIT
	vdoc README.md
	vdoc CHANGELOG.md
	vsv ipfs
}
