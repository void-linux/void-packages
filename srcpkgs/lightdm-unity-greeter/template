# Template file for 'lightdm-unity-greeter'
pkgname=lightdm-unity-greeter
version=23.10.1
revision=1
_ubuntu_rel=0ubuntu4
build_style=gnu-configure
configure_args="--prefix=/usr --sysconfdir=/etc --sbindir=/usr/bin \
 --libexecdir=/usr/lib/lightdm"
hostmakedepends="automake gettext-devel ImageMagick intltool librsvg pkg-config
 vala"
makedepends="ayatana-ido-devel libayatana-indicator-devel libcanberra-devel
 libXext-devel lightdm-devel unity-settings-daemon-devel"
depends="cantarell-fonts lightdm network-manager-applet unity-settings-daemon"
short_desc="Greeter application for Unity, implemented as a LightDM greeter"
maintainer="Earldridge Jazzed Pineda <earldridgejazzedpineda@gmail.com>"
license="GPL-3.0-only"
homepage="https://launchpad.net/unity-greeter"
distfiles="https://launchpad.net/ubuntu/+archive/primary/+files/${pkgname#*-}_${version}-${_ubuntu_rel}.tar.xz"
checksum=dd6654ee535d7cfd4ae72765f0c4f7fd4c90d7e33a30efef4bbbe0587b30aec3
make_check=ci-skip # Cannot convert from 'uint' to 'int'

post_patch() {
	rm data/logo.png
	cp ${FILESDIR}/logo.png data/logo.png
}

pre_configure() {
	autoreconf -vfi
	intltoolize -f
}

post_install() {
	vmkdir usr/share/polkit-1/rules.d 750
	vinstall ${FILESDIR}/50-unity-greeter.rules 644 \
	 usr/share/polkit-1/rules.d

	vmkdir etc/guest-session/gsettings 755
	vinstall ${FILESDIR}/10-unity.defaults 644 etc/guest-session/gsettings

	vmkdir usr/share/lightdm/lightdm.conf.d 755
	vinstall debian/50-unity-greeter.conf 644 \
	usr/share/lightdm/lightdm.conf.d

	vbin ${FILESDIR}/unity-greeter-indicators-start

	rm -r "${DESTDIR}/usr/share/locale/"
}
