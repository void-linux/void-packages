# Template file for 'samba'
pkgname=samba
version=3.5.6
build_wrksrc=source3
distfiles="http://us1.samba.org/samba/ftp/stable/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--with-fhs --with-pthreads --localstatedir=/var
--with-configdir=/etc/samba --with-lockdir=/var/lock/samba
--with-piddir=/var/run/samba --with-pammodulesdir=/lib/security
--with-syslog --enable-external-libtalloc --with-cifsumount
--enable-external-libtdb"
short_desc="SMB/CIFS file, print, and login server for Unix"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=466410868375d19a286ac3fc5d9f3c267ce359189f8e0d76e72ec10bd54247da
long_desc="
 Samba is an implementation of the SMB/CIFS protocol for Unix systems,
 providing support for cross-platform file and printer sharing with Microsoft
 Windows, OS X, and other Unix systems. Samba can also function as an
 NT4-style domain controller, and can integrate with both NT4 domains and
 Active Directory realms as a member server."

# XXX: Prepare rc service, conf files, etc.
subpackages="cifs-utils smbclient libsmbclient samba-devel"

Add_dependency run glibc
Add_dependency run zlib
Add_dependency run libcap
Add_dependency run popt
Add_dependency run mit-krb5-libs
Add_dependency run e2fsprogs-libs
Add_dependency run libldap
Add_dependency run pam
Add_dependency run acl
Add_dependency run attr
Add_dependency run avahi-libs
Add_dependency run gamin
Add_dependency run readline
Add_dependency run libtdb
Add_dependency run libsmbclient
Add_dependency run smbclient

Add_dependency build gettext
Add_dependency build libcap-devel
Add_dependency build popt-devel
Add_dependency build mit-krb5-devel
Add_dependency build e2fsprogs-devel
Add_dependency build libldap-devel
Add_dependency build zlib-devel
Add_dependency build pam-devel
Add_dependency build acl-devel
Add_dependency build attr-devel
Add_dependency build avahi-libs-devel
Add_dependency build gamin-devel
Add_dependency build readline-devel
Add_dependency build tdb-devel

post_install()
{
	# Remove tdb manpages!
	rm -f ${DESTDIR}/usr/share/man/man8/tdb*

	# Remove swat (outdated, unsecure).
	rm -f ${DESTDIR}/usr/sbin/swat
	rm -f ${DESTDIR}/usr/share/man/man8/swat
	rm -rf ${DESTDIR}/usr/share/samba/swat
}
