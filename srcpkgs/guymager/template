# Template file for 'guymager'
pkgname=guymager
version=0.8.13
revision=1
archs="~*-musl"
build_style=qmake
configure_args="DEFINES*="ENABLE_LIBEWF=0""
conf_files="/etc/guymager/guymager.cfg"
make_dirs="
 /etc/guymager 0755 root root
 /usr/share/guymager 0755 root root"
hostmakedepends="qt5-qmake qt5-host-tools"
makedepends="qt5-devel qt5-tools-devel libguytools-devel libparted-devel"
depends="hdparm smartmontools"
short_desc="Fast and user friendly forensic imager"
maintainer="cbaulesch <christophe@baulesch.com>"
license="GPL-2.0-only"
homepage="https://sourceforge.net/projects/guymager/"
changelog="https://sourceforge.net/p/guymager/code/HEAD/tree/tags/guymager-${version}/debian/changelog"
distfiles="${SOURCEFORGE_SITE}/${pkgname}/guymager-${version}.tar.gz"
checksum=c43b10fdde9fc9f2ceaf8b97a5da2a3258df16b56041352ed2dd9ee68a5c6918

post_patch() {
				if [ "$CROSS_BUILD" ]; then
					vsed -e "s;/usr/include/libguytools2;${XBPS_CROSS_BASE}/usr/include/libguytools2;" -i guymager.pro
				fi
}

post_build() {
				lrelease guymager.pro
				cd manuals
				./rebuild.sh
}

do_install() {
				vmkdir etc/guymager
				vmkdir usr/share/guymager
				vinstall guymager 4755 usr/bin
				vcopy guymager.cfg etc/guymager
				vinstall guymager.desktop 644 usr/share/applications
				vdoc changelog
				vman manuals/guymager.1
				vcopy guymager_*.qm usr/share/guymager
				vinstall splash.png 644 usr/share/guymager
				vinstall guymager_128.png 644 usr/share/pixmaps2
				vinstall org.freedesktop.guymager.policy 644 usr/share/polkit-1/actions
}
