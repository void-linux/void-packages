# Template file for 'renderdoc'
pkgname=renderdoc
version=1.4
revision=1
build_style=cmake
configure_args="-DENABLE_GL=ON -DENABLE_GLES=ON -DENABLE_RENDERDOCCMD=ON
 -DENABLE_VULKAN=ON -DENABLE_XCB=ON -DENABLE_XLIB=ON"
hostmakedepends="bison autoconf automake pkg-config python3 python3-devel"
makedepends="libX11-devel libxcb-devel xcb-util-keysyms-devel libGL qt5-devel
 qt5-svg-devel qt5-x11extras-devel pcre-devel python3 python3-devel"
short_desc="Stand-alone graphics debugging tool for Vulkan and OpenGL"
maintainer="Urs Schulz <voidpkgs@ursschulz.de>"
license="MIT"
homepage="https://github.com/baldurk/renderdoc"
distfiles="https://github.com/baldurk/${pkgname}/archive/v${version}.tar.gz"
checksum=9a78951f386fb7c3ecf7df6919d300db59719d14f0621438963ae30a75d33677

if [ "$CROSS_BUILD" ]; then
	# custom_swig's configure script, outputs "Cannot run test when cross-compiling"
	# We remove qrenderdoc from being built to prevent error and allow cross
	pre_build() {
		vsed -i -e '/add_subdirectory(qrenderdoc)/d' CMakeLists.txt
	}
	case "$XBPS_TARGET_LIBC" in
		musl) nocross="Undefined variables, even though headers exist";;
	esac
fi

case "$XBPS_TARGET_MACHINE" in
	*-musl) makedepends+=" libexecinfo-devel"
esac

post_install() {
	vlicense LICENSE.md
}
