# Template file for 'tinyxml'
pkgname=tinyxml
version=2.6.2
revision=2
subpackages="${pkgname}-devel"
short_desc="A simple, small, C++ XML parser that can be easily integrated into other programs"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.grinninglizard.com/tinyxml/"
license="zlib"
distfiles="${SOURCEFORGE_SITE}/${pkgname}/${pkgname}_2_6_2.tar.gz"
checksum=15bdfdcec58a7da30adc87ac2b078e4417dbe5392f3afb719f9ba6d062645593

wrksrc="${pkgname}"

do_build() {
	# Fix Makefile
	sed -i \
		-e '/^TINYXML_USE_STL/ s|=.*|=YES|' \
		 -e "s|^RELEASE_CFLAGS.*|& ${CXXFLAGS} -fPIC|" Makefile

	make ${makejobs}
	g++ -fPIC ${CXXFLAGS} -shared -o lib${pkgname}.so.0.${version} \
		-Wl,-soname,lib${pkgname}.so.0 $(ls *.o | grep -v xmltest)
}

do_install() {
	install -dm 0755 ${DESTDIR}/usr/{lib,include}
	install -m0755 lib${pkgname}.so.0.${version} ${DESTDIR}/usr/lib
	install -m0644 ${pkgname}.h tinystr.h ${DESTDIR}/usr/include

	(cd ${DESTDIR}/usr/lib
	 ln -s lib${pkgname}.so.0.${version} lib${pkgname}.so.0
	 ln -s lib${pkgname}.so.0.${version} lib${pkgname}.so
	)
}
