# Template file for 'initramfs-tools'
pkgname=initramfs-tools
version=0.142
revision=1
#archs="i686 x86_64"
#wrksrc=
#create_wrksrc=yes
#build_style=gnu-configure
#configure_args=""
#make_build_args=""
#make_install_args=""
#conf_files=""
#make_dirs="/var/log/dir 0755 root root"
#hostmakedepends=""
#makedepends=""
depends="klibc cpio kmod eudev e2fsprogs util-linux coreutils run-parts
 ischroot kbd"
short_desc="Generic modular initramfs generator"
maintainer="Đoàn Trần Công Danh <congdanhqx@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://wiki.debian.org/initramfs-tools"
#changelog=""
distfiles="${DEBIAN_SITE}/main/i/initramfs-tools/initramfs-tools_${version}.tar.xz"
checksum=e566929d02f53efcea7851aa9120bba417c320c60405b84d8774de01765e9882
make_dirs="
 /etc/initramfs-tools/scripts/init-bottom 0755 root root
 /etc/initramfs-tools/scripts/init-premount 0755 root root
 /etc/initramfs-tools/scripts/init-top 0755 root root
 /etc/initramfs-tools/scripts/local-bottom 0755 root root
 /etc/initramfs-tools/scripts/local-premount 0755 root root
 /etc/initramfs-tools/scripts/local-top 0755 root root
 /etc/initramfs-tools/scripts/nfs-bottom 0755 root root
 /etc/initramfs-tools/scripts/nfs-premount 0755 root root
 /etc/initramfs-tools/scripts/nfs-top 0755 root root
 /etc/initramfs-tools/scripts/panic 0755 root root
 /etc/initramfs-tools/hooks 0755 root root
 /etc/initramfs-tools/conf.d 0755 root root
 /usr/share/initramfs-tools/conf.d 0755 root root
 /usr/share/initramfs-tools/conf-hooks.d 0755 root root
 /usr/share/initramfs-tools/modules.d 0755 root root
"
alternatives="
 initramfs:/etc/kernel.d/post-install/20-initramfs:/usr/libexec/initramfs-tools/kernel-hook-postinst
 initramfs:/etc/kernel.d/post-remove/20-initramfs:/usr/libexec/initramfs-tools/kernel-hook-postrm
 "
conf_files="
 /etc/initramfs-tools/modules
 /etc/initramfs-tools/initramfs.conf
 "

do_build() {
	cp -r ${FILESDIR}/* .
	chmod -R a+r scripts hooks docs conf-hooks.d
}

do_install() {
	vbin lsinitramfs
	vman lsinitramfs.8
	vbin mkinitramfs
	vman mkinitramfs.8
	vbin unmkinitramfs
	vman unmkinitramfs.8
	vman initramfs-tools.7
	vman initramfs.conf.5
	vinstall init 755 usr/share/initramfs-tools
	vcopy scripts usr/share/initramfs-tools
	vinstall conf/initramfs.conf 644 etc/initramfs-tools
	vcopy hooks usr/share/initramfs-tools
	vcopy conf-hooks.d usr/share/initramfs-tools
	vinstall hook-functions 644 usr/share/initramfs-tools
	vinstall conf/modules 644 usr/share/initramfs-tools
	vinstall conf/modules 644 etc/initramfs-tools
	vsconf docs/example_hook
	vsconf docs/example_script
	vsconf docs/framebuffer
	# kernel hooks.
	vinstall kernel/kernel-hook-postinst 755 usr/libexec/initramfs-tools
	vinstall kernel/kernel-hook-postrm 755 usr/libexec/initramfs-tools
}
