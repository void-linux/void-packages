Index: initramfs-tools-0.142/hooks/thermal
===================================================================
--- initramfs-tools-0.142.orig/hooks/thermal
+++ initramfs-tools-0.142/hooks/thermal
@@ -19,9 +19,9 @@ esac
 
 . /usr/share/initramfs-tools/hook-functions
 
-case "$DPKG_ARCH" in
+case "$XBPS_ARCH" in
 # copy the right modules
-powerpc|ppc64)
+ppc*)
 
 	# Only G5 Mac machines need to load
 	# windfarm_core or one of the windfarm_pm* modules.
@@ -64,7 +64,7 @@ powerpc|ppc64)
 	manual_add_modules windfarm_smu_sat
 	manual_add_modules windfarm_smu_sensors
 	;;
-i386|amd64|ia64)
+i686*|x86_64*)
 	manual_add_modules fan
 	manual_add_modules thermal
 	;;
Index: initramfs-tools-0.142/init
===================================================================
--- initramfs-tools-0.142.orig/init
+++ initramfs-tools-0.142/init
@@ -46,6 +46,7 @@ mount -t devpts -o noexec,nosuid,gid=5,m
 
 # Export the dpkg architecture
 export DPKG_ARCH=
+export XBPS_ARCH=
 . /conf/arch.conf
 
 # Set modprobe env
@@ -299,6 +300,7 @@ maybe_break init
 unset debug
 unset MODPROBE_OPTIONS
 unset DPKG_ARCH
+unset XBPS_ARCH
 unset ROOTFLAGS
 unset ROOTFSTYPE
 unset ROOTDELAY
Index: initramfs-tools-0.142/initramfs-tools.7
===================================================================
--- initramfs-tools-0.142.orig/initramfs-tools.7
+++ initramfs-tools-0.142/initramfs-tools.7
@@ -574,8 +574,9 @@ corresponds to the rootdelay, rootflags,
 Use of ROOTDELAY is deprecated; you should implement a \fIlocal-block\fR
 boot script rather than delaying or polling.
 .TP
-\fB\fI DPKG_ARCH
-allows arch specific boot actions.
+\fB\fI DPKG_ARCH, XBPS_ARCH
+allows arch specific boot actions. Void Linux specific hooks should use
+\fBXBPS_ARCH\fR.
 .TP
 \fB\fI blacklist, panic, quiet, resume, noresume, resume_offset
 set according relevant boot option.
Index: initramfs-tools-0.142/mkinitramfs
===================================================================
--- initramfs-tools-0.142.orig/mkinitramfs
+++ initramfs-tools-0.142/mkinitramfs
@@ -284,7 +284,29 @@ __TMPCPIOGZ="$(mktemp "${TMPDIR:-/var/tm
 __TMPMAINCPIO="$(mktemp "${TMPDIR:-/var/tmp}/mkinitramfs-MAIN_XXXXXX")" || exit 1
 __TMPEARLYCPIO="$(mktemp "${TMPDIR:-/var/tmp}/mkinitramfs-FW_XXXXXX")" || exit 1
 
-DPKG_ARCH=$(dpkg --print-architecture)
+XBPS_ARCH=$(xbps-uhelper arch)
+case "$XBPS_ARCH" in
+i686*)
+	DPKG_ARCH=i386 ;;
+x86_64*)
+	DPKG_ARCH=amd64 ;;
+aarch64*)
+	DPKG_ARCH=arm64 ;;
+armv[67]*)
+	DPKG_ARCH=armhf ;;
+arm*)
+	DPKG_ARCH=armel ;;
+ppc64le*)
+	DPKG_ARCH=ppc64el ;;
+ppc64*)
+	DPKG_ARCH=ppc64 ;;
+ppc*)
+	DPKG_ARCH=powerpc ;;
+mipsel*)
+	DPKG_ARCH=mipsel ;;
+mips*)
+	DPKG_ARCH=mips ;;
+esac
 
 # Export environment for hook scripts.
 #
@@ -293,6 +315,7 @@ export version
 export CONFDIR
 export DESTDIR
 export DPKG_ARCH
+export XBPS_ARCH
 export verbose
 export KEYMAP
 export MODULES
