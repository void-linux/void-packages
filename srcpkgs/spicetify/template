# Template file for 'spicetify'
pkgname=spicetify
version=2.40.10
revision=1
build_style=go
go_import_path=github.com/spicetify/cli
go_ldflags="-X main.version=${version}"
short_desc="Command-line tool to customize Spotify client"
maintainer="Xavier Fortier <xavier.fortier@proton.me>"
license="LGPL-2.1-only"
homepage="https://spicetify.app/"
changelog="https://github.com/spicetify/cli/releases"
distfiles="https://github.com/spicetify/cli/archive/v${version}.tar.gz"
checksum=74f873330092f3026069f58a3606062980732cf4343825c0a2110db6e5f06652

do_install() {
	vmkdir "opt/${pkgname}"

	for d in CustomApps Extensions jsHelper Themes; do
		vcopy "$d" "opt/${pkgname}"
	done

	vinstall css-map.json 644 "opt/${pkgname}"
	vinstall globals.d.ts 644 "opt/${pkgname}"

	for f in ${GOPATH}/bin/* ${GOPATH}/bin/**/*; do
		if [ -f "$f" ] && [ -x "$f" ]; then
			vinstall "$f" 755 "opt/${pkgname}" "${pkgname}"
		fi
	done

	vbin "${FILESDIR}/${pkgname}"
}
