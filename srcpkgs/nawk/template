# Template file for 'nawk'
pkgname=nawk
version=20251225
revision=1
build_style=gnu-makefile
hostmakedepends="bison"
short_desc="The one, true implementation of AWK"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="SMLNJ"
homepage="https://github.com/onetrueawk/awk"
changelog="https://github.com/onetrueawk/awk/blob/master/FIXES"
distfiles="https://github.com/onetrueawk/awk/archive/refs/tags/${version}.tar.gz"
checksum=626d7d19f8e4ceae70f60e2e662291789e0f54ab86945317a3d5693c30f847a2
alternatives="
 awk:awk:/usr/bin/nawk
 awk:awk.1:/usr/share/man/man1/nawk.1"
provides="awk-0_1"

CPPFLAGS="-DHAS_ISBLANK"

post_patch() {
	vsed -i '/maketab/{s/HOSTCC/BUILD_CC/;s/CFLAGS/BUILD_CFLAGS/}' makefile
	vsed -i 's/-lm/$(LDFLAGS) &/' makefile
}

do_install() {
	vbin a.out nawk
	vman awk.1 nawk.1
	vlicense LICENSE
}
