# Template file for 'cloudflared'
pkgname=cloudflared
version=2025.9.1
revision=1
build_style=go
go_import_path=github.com/cloudflare/cloudflared
go_package="${go_import_path}/cmd/cloudflared"
go_ldflags="-X \"main.Version=${version}\""
make_check_args="-skip=(^TestFunnelIdleTimeout$|^TestReuseFunnel$|^TestICMPRouterEcho$|^TestTraceICMPRouterEcho$|^TestConcurrentRequestsToSameDst$|^TestICMPRouterRejectNotEcho$|^TestManagerCtxDoneCloseSessions$|^TestServeHTTP$)"
hostmakedepends="go"
short_desc="Cloudflare Tunnel client"
maintainer="Elie ROUDNINSKI <xademax@gmail.com>"
license="Apache-2.0"
homepage="https://developers.cloudflare.com/argo-tunnel/"
changelog="https://raw.githubusercontent.com/cloudflare/cloudflared/master/CHANGES.md"
distfiles="https://github.com/cloudflare/cloudflared/archive/${version}.tar.gz"
checksum=384283f05e55560e71d844991d3adbe7e2acaa278ce063b0c7efc84db8ec3849

pre_build() {
	go_ldflags+=" -X \"main.BuildTime=$(date -u '+%Y-%m-%d-%H:%M UTC')\""
}
