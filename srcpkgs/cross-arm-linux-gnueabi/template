# Template file for 'cross-arm-linux-gnueabi'
_triplet=arm-linux-gnueabi
_binutils_version=2.35.1
_gcc_version=10.2.0
_glibc_version=2.32
_linux_version=5.10.4
pkgname=cross-${_triplet}
version=0.34
revision=1
build_style=void-cross
configure_args="--with-arch=armv5te --with-float=soft"
hostmakedepends="texinfo tar gcc-objc gcc-go flex perl python3"
makedepends="isl15-devel libmpc-devel zlib-devel gmp-devel mpfr-devel"
depends="${pkgname}-libc-${version}_${revision}"
short_desc="Void cross toolchain for ${_triplet}"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-2.0-or-later, GPL-3.0-or-later, LGPL-2.1-or-later"
homepage="https://www.voidlinux.org/"
distfiles="
 ${GNU_SITE}/binutils/binutils-${_binutils_version}.tar.xz
 ${GNU_SITE}/gcc/gcc-${_gcc_version}/gcc-${_gcc_version}.tar.xz
 ${GNU_SITE}/glibc/glibc-${_glibc_version}.tar.xz
 ${KERNEL_SITE}/kernel/v5.x/linux-${_linux_version}.tar.xz"
checksum="3ced91db9bf01182b7e420eab68039f2083aed0a214c0424e257eae3ddee8607
 b8dd4368bb9c7f0b98188317ee0254dd8cc99d1e3a18d0ff146c855fe16c1d8c
 1627ea54f5a1a8467032563393e0901077626dc66f37f10ee6363bb722222836
 904e396c26e9992a16cd1cc989460171536bed7739bf36049f6eb020ee5d56ec"
nocross=yes

cross_triplet=${_triplet}
cross_linux_arch=arm
cross_binutils_configure_args="--without-fp"
cross_glibc_configure_args="--without-fp"
cross_glibc_cflags="-Os -march=armv5te -msoft-float -mfloat-abi=soft"

if [ "$XBPS_TARGET_MACHINE" = "armv5tel" ]; then
	broken="Can't build crosstoolchain to itself"
fi

cross-arm-linux-gnueabi-libc_package() {
	short_desc+=" - glibc files"
	nostrip=yes
	noshlibprovides=yes
	noverifyrdeps=yes

	pkg_install() {
		vmove usr/${cross_triplet}
	}
}
