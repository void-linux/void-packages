# Template file for 'librealsense'
pkgname=librealsense
version=2.49.0
revision=1
build_style=cmake
hostmakedepends="git"
makedepends="libusb-devel glfw-devel"
depends=""
short_desc="cross-platform library for Intel® RealSense™ depth cameras"
maintainer="Enno Boland <gottox@voidlinux.org>"
license="Apache-2.0"
homepage="https://www.intelrealsense.com/"
distfiles="https://github.com/IntelRealSense/librealsense/archive/refs/tags/v$version.tar.gz"
checksum=2578ea0e75546aeebd908da732f52e0122bf37750d5a45f3adf92945a673aefd
configure_args=" -DOpenGL_GL_PREFERENCE=GLVND -DCHECK_FOR_UPDATES=False"
_examples="rs-align rs-align-advanced rs-ar-advanced rs-ar-basic
 rs-callback rs-capture rs-color rs-depth rs-distance rs-gl rs-hdr
 rs-hello-realsense rs-measure rs-motion rs-multicam rs-pointcloud rs-pose
 rs-pose-and-image rs-pose-predict rs-post-processing rs-record-playback
 rs-save-to-disk rs-sensor-control rs-software-device rs-tracking-and-depth
 rs-trajectory"

_tools="rs-convert rs-enumerate-devices rs-fw-logger rs-terminal rs-record
rs-fw-update rs-data-collect realsense-viewer rs-depth-quality
rs-rosbag-inspector rs-benchmark"


post_install() {
	vinstall config/99-realsense-libusb.rules 0644 /usr/lib/udev/rules.d
	rm $DESTDIR/tmp -r
}

librealsense-tools_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - tools"
	pkg_install() {
		for t in $_tools; do
			vmove "usr/bin/$t"
		done
	}
}

librealsense-examples_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - examples"
	pkg_install() {
		for e in $_examples; do
			vmove "usr/bin/$e"
		done
	}
}

librealsense-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove usr/lib/cmake
		vmove "usr/lib/*.a"
		vmove "usr/lib/*.so"
	}
}
