# Template file for 'brother-hl5340d-lpr'
pkgname=brother-hl5340d-lpr
br_version=2.0.3
br_revision=1
version=${br_version}
revision=1
maintainer="Monkey 7<monkeyseven@fblog.ch>"
homepage="http://support.brother.com"
license="brother-eula GPL-2"
short_desc="LPR driver for the brother HL5340D printer"
distfiles="http://www.brother.com/pub/bsc/linux/dlf/hl5340dlpr-${br_version}-${br_revision}.i386.deb"
checksum="32f2d3e0297bbbcc4aab70f911fab3ba3cc6a0eb98c3569dfcb22beef6e32c19"
archs="i686 x86_64"
create_wrksrc=yes
depends="a2ps ghostscript"
nopie=yes
patch_args="-Np1"

if [ "$XBPS_TARGET_MACHINE" = "x86_64" ]; then
	depends+=" glibc-32bit"
fi

do_extract() {
	ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/hl5340dlpr-${br_version}-${br_revision}.i386.deb
	tar xzpvf data.tar.gz -C ${wrksrc}
}

do_install() {
	mkdir -p ${DESTDIR}
	cp -a ${wrksrc}/usr ${DESTDIR}/
	mv ${DESTDIR}/usr/lib ${DESTDIR}/usr/lib32
	mkdir -p ${DESTDIR}/usr/lib
	mv ${DESTDIR}/usr/local/Brother ${DESTDIR}/usr/lib/brother
	rm -rf ${DESTDIR}/usr/local
	vlicense ${FILESDIR}/LICENSE
}
