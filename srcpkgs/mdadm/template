# Template file for 'mdadm'
pkgname=mdadm
version=4.4
revision=1
hostmakedepends="pkg-config"
makedepends="eudev-libudev-devel"
short_desc="Tool for managing/monitoring Linux md device arrays"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="GPL-2.0-or-later"
homepage="https://git.kernel.org/cgit/utils/mdadm/mdadm.git/log/"
distfiles="${KERNEL_SITE}/utils/raid/${pkgname}/${pkgname}-${version}.tar.xz"
checksum=9b488f35ed153df99924b5fe41eed380e8512de8f18a118628cacdd681b1d573

pre_configure() {
	sed -i 's,^install : mdadm mdmon,install: ,g' Makefile
}
do_build() {
	make ${makejobs} CC=$CC \
		CFLAGS="$CFLAGS -D_LARGEFILE64_SOURCE -DNO_COROSYNC -DNO_DLM -Wno-error -DSendmail='\"sendmail -t\"'" \
		BINDIR=/usr/bin LDFLAGS="$LDFLAGS"
}
do_install() {
	make BINDIR=/usr/bin STRIP= PREFIX=/usr DESTDIR=${DESTDIR} install
	vsv mdadm
	vsconf documentation/mdadm.conf-example mdadm.conf
}
