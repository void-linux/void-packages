# Template file for 'deluge'
pkgname=deluge
version=1.3.15
revision=4
archs=noarch
build_style=python2-module
pycompile_module="deluge"
hostmakedepends="intltool python-setuptools"
depends="python-setuptools python-chardet python-Twisted python-xdg
 libtorrent-rasterbar-python"
short_desc="Fully-featured cross-platform BitTorrent client"
maintainer="Alexey Rochev <equeim@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://deluge-torrent.org/"
distfiles="https://download.deluge-torrent.org/source/${pkgname}-${version}.tar.gz"
checksum=2bd239fc7ec0427302677abb86f927299aed4f043eca5d8a1bab2986b3659666

system_accounts="deluge"
deluge_homedir="/var/lib/deluge"

make_dirs="/var/lib/deluge 0755 deluge deluge"

post_install() {
	vsv deluged
}

deluge-gtk_package() {
	archs=noarch
	replaces="deluge<1.3.14_1"
	short_desc+=" - GTK+ frontend"
	pycompile_module="deluge"
	depends="${sourcepkg}-${version}_${revision} pygtk"
	pkg_install() {
		vmove usr/bin/deluge
		vmove usr/bin/deluge-gtk
		vmove ${py2_sitelib}/deluge/ui/gtkui
		vmove usr/share/applications
		vmove usr/share/icons
		vmove usr/share/man/man1/deluge.1
		vmove usr/share/man/man1/deluge-gtk.1
	}
}
deluge-web_package() {
	archs=noarch
	replaces="deluge<1.3.14_1"
	short_desc+=" - Web frontend"
	pycompile_module="deluge"
	depends="${sourcepkg}-${version}_${revision} python-Mako"
	pkg_install() {
		vmove usr/bin/deluge-web
		vmove ${py2_sitelib}/deluge/ui/web
		vmove usr/share/man/man1/deluge-web.1
		vsv deluge-web
	}
}
