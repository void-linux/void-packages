# Template file for 'octoxbps'
pkgname=octoxbps
version=0.2.2
revision=3
build_style=qmake
hostmakedepends="qt5-qmake"
makedepends="qt5-declarative-devel"
depends="curl"
short_desc="Qt-based XBPS front-end"
maintainer="beefcurtains <beefcurtains@voidlinux.org>"
license="GPL-2"
homepage="https://github.com/aarnt/octoxbps"
distfiles="${homepage}/archive/v${version}.tar.gz"
checksum=6f7643bb07960d8c8f60ce70dc495f866ae60a4d6d8160a7f108f79bf53d2d22

do_configure() {
	for _dir in ${wrksrc} ${wrksrc}/notifier/octoxbps-notifier; do
		cd $_dir && qmake ${configure_args} \
			PREFIX=/usr \
			LIB=/usr/lib \
			QMAKE_CFLAGS="${CFLAGS}" \
			QMAKE_CXXFLAGS="${CXXFLAGS}" \
			QMAKE_LFLAGS="${LDFLAGS}"
	done
}

do_build() {
	for _dir in ${wrksrc} ${wrksrc}/notifier/octoxbps-notifier; do
		cd $_dir && make ${makejobs} ${make_build_args} ${make_build_target}
	done
}

do_install() {
	vbin bin/octoxbps
	vbin notifier/bin/octoxbps-notifier
	vmkdir usr/share/applications
	vinstall ${FILESDIR}/octoxbps.desktop 644 usr/share/applications
	local size
	for size in 32 48 64 128 256; do
		vinstall ${FILESDIR}/octoxbps-${size}.png 644 \
			usr/share/icons/hicolor/${size}x${size}/apps octoxbps.png
	done
	vinstall ${FILESDIR}/octoxbps-128.png 644 usr/share/pixmaps octoxbps.png
}
