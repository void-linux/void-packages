# Template file for 'ecm'
pkgname=ecm
version=7.0.5
revision=1
build_style=gnu-configure
configure_args="--enable-shared --enable-openmp"
hostmakedepends="m4"
makedepends="gmp-devel libgomp-devel"
short_desc="Elliptic Curve Method for Integer Factorization"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="GPL-3.0-or-later"
homepage="https://gitlab.inria.fr/zimmerma/ecm"
distfiles="https://gitlab.inria.fr/zimmerma/ecm/uploads/89f6f0d65d3e980cef33dc922004e4b2/ecm-${version}.tar.gz"
checksum=c721dd22e557c4a5dac9ac7e156a400cd2298812dd1f9b56e89966de01471ba8

# ppc64 asm only provided for BE and ELFv1, we're ELFv2 for BE and LE
case "$XBPS_TARGET_MACHINE" in
	ppc64*) configure_args+=" --disable-asm-redc";;
esac

post_install() {
	vbin aprcl
	vbin .libs/ecmfactor
}
ecm-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/*.a
		vmove usr/lib/*.so
	}
}
