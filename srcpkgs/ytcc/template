# Template file for 'ytcc'
pkgname=ytcc
version=2.0.1
revision=1
build_style=python3-module
hostmakedepends="gettext python3-setuptools"
depends="mpv python3-SQLAlchemy python3-click python3-feedparser python3-lxml
 python3-youtube-dl"
checkdepends="python3-pytest python3-click youtube-dl ffmpeg mpv"
short_desc="Cmdline tool to track your youtube channels"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-3.0-or-later"
homepage="https://github.com/woefe/ytcc"
distfiles="https://github.com/woefe/ytcc/archive/v${version}.tar.gz"
checksum=edb5367209a8c465c6b6f4f01705430602f25ca29b318dc18e42c139d2fe1efc

pre_check() {
	# Needs XDG_RUNTIME_DIR variable
	#vsed -e '/test_play_video/,/assert len/d' -i test/test_cli.py
	:
}

do_check() {
	export XDG_RUNTIME_DIR=$(mktemp -d)
	pytest test
	rm -rf $XDG_RUNTIME_DIR
}

post_install() {
	vcompletion scripts/completions/fish/ytcc.fish fish
	vcompletion scripts/completions/zsh/_ytcc zsh
	vcompletion scripts/completions/bash/ytcc.completion.sh bash
}
