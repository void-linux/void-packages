# Template file for 'ytcc'
pkgname=ytcc
version=2.6.0
revision=2
build_style=python3-module
hostmakedepends="python3-setuptools"
depends="mpv yt-dlp python3-click python3-wcwidth"
checkdepends="${depends} python3-pytest"
short_desc="Cmdline tool to track your youtube channels"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-3.0-or-later"
homepage="https://github.com/woefe/ytcc"
distfiles="https://github.com/woefe/ytcc/archive/v${version}.tar.gz"
checksum=3d69104a20b9a6861a2663a0ffcbd6054fe05a62caccf2126c0b0cf3a446dbec

do_check() {
	PYTHONPATH="$(cd build/lib* && pwd)" python3 -m pytest -m "not flaky" test
}

post_install() {
	vcompletion scripts/completions/bash/ytcc.completion.sh bash
	vcompletion scripts/completions/fish/ytcc.fish fish
	vcompletion scripts/completions/zsh/_ytcc zsh
	mv ${DESTDIR}/usr/bin/ytccf{.sh,}
	vman doc/ytcc.1
}
