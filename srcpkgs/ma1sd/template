# Template file for 'ma1sd'
pkgname=ma1sd
version=2.5.0
revision=1
hostmakedepends="gradle"
depends="virtual?java-runtime"
short_desc="Federated Matrix Identity Server"
maintainer="Joel Beckmeyer <joel@beckmeyer.us>"
license="AGPL-3.0-or-later"
homepage="https://github.com/ma1uta/ma1sd"
distfiles="https://github.com/ma1uta/ma1sd/archive/refs/tags/${version}.tar.gz"
checksum=9655d59d4026c7ed2217867a51cc8c9c82536ea92c54b4bab4b7d6d1ed3c0b52

system_accounts="_ma1sd"
_ma1sd_homedir="/var/lib/ma1sd"

make_dirs="/var/lib/ma1sd 0700 _ma1sd _ma1sd"

do_build() {
	MA1SD_BUILD_VERSION="${version}" gradle --no-daemon build
}

do_install() {
	vinstall "build/libs/ma1sd-${version}.jar" 644 usr/lib/ma1sd ma1sd.jar
	vsconf ma1sd.example.yaml
	vsv ma1sd
	vlicense LICENSE
}
