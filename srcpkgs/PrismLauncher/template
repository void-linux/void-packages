# Template file for 'PrismLauncher'
pkgname=PrismLauncher
version=10.0.1
revision=1
build_style=cmake
configure_args="-DLauncher_BUILD_PLATFORM=Void"
hostmakedepends="extra-cmake-modules openjdk17 pkg-config qt6-tools qt6-base scdoc"
makedepends="qt6-base-devel qt6-qt5compat-devel zlib-devel quazip-qt6-devel
 qt6-networkauth-devel cmark-devel libgamemode-devel qrencode-devel
 libarchive-devel tomlplusplus-devel"
depends="virtual?java-runtime qt6-svg qt6-imageformats qt6-plugin-tls-openssl"
short_desc="Custom launcher for Minecraft"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-3.0-only"
homepage="https://prismlauncher.org/"
distfiles="https://github.com/PrismLauncher/PrismLauncher/releases/download/${version}/PrismLauncher-${version}.tar.gz"
checksum=fd25af8c53b8a2cf6a3c0428be0f80c6fe38d427b2274e08ce8078fd20d6b5cf

if [ -z "$XBPS_CHECK_PKGS" ]; then
	configure_args+=" -DBUILD_TESTING=0"
fi

case "$XBPS_TARGET_MACHINE" in
	# XXX: this could be fixed by switching to clang, but it seems to produce
	# non-PIE executables despite -fPIE being in the C(XX)FLAGS
	# There's also some effort needed to get it working on cross
	armv*) broken="https://github.com/PrismLauncher/PrismLauncher/issues/128" ;;
esac

pre_configure() {
	. /etc/profile.d/jdk.sh
}

post_install() {
	vdoc ${FILESDIR}/README.voidlinux
}
