# Template file for 'heaptrack'
pkgname=heaptrack
version=1.5.0
revision=5
build_style=cmake
configure_args="-DHEAPTRACK_BUILD_GUI=ON -DHEAPTRACK_USE_QT6=ON"
hostmakedepends="extra-cmake-modules gettext qt6-base kf6-kconfig"
makedepends="boost-devel-minimal libboost_filesystem libboost_iostreams
 libboost_program_options libunwind-devel
 qt6-base-devel qt6-svg-devel kdiagram6-devel
 libzstd-devel ecm-devel kf6-kcoreaddons-devel kf6-ki18n-devel
 kf6-kio-devel kf6-kconfigwidgets-devel kf6-kconfig-devel
 kf6-kitemmodels-devel kf6-kio-devel kf6-threadweaver-devel
 kf6-kconfigwidgets-devel kf6-kiconthemes-devel"
short_desc="Heap memory profiler for Linux"
maintainer="Piraty <mail@piraty.dev>"
license="LGPL-2.1-or-later"
homepage="https://github.com/KDE/heaptrack"
distfiles="https://github.com/KDE/heaptrack/archive/v${version}.tar.gz"
checksum=44e6aefc13460556acced7192bf3600605cd7a5f3a46e670c3127aeae97e19dd

#../tests/auto/tst_inject.cpp:78: SIGSEGV
make_check=no

heaptrack-gui_package() {
	short_desc+=" - GUI"
	pkg_install() {
		vmove usr/bin/heaptrack_gui
		vmove usr/share
	}
}
