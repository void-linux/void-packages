# Template file for 'browsh'
pkgname=browsh
version=1.5.0
revision=1
build_style=go
go_import_path="github.com/browsh-org/browsh"
go_package="$go_import_path/interfacer/src/browsh"
hostmakedepends="curl dep"
short_desc="Fully-modern text-based browser, rendering to TTY and browsers"
maintainer="zhengqunkoo <zhengqun.koo@gmail.com>"
license="LGPL-2.1-only"
homepage="https://www.brow.sh/"
distfiles="https://$go_import_path/archive/v$version.tar.gz"
checksum=df23c86f27f19c42bf7c42753a80f202d24c01b447c6ebd8f898f68fdd3889c0

# Manipulate paths, because nested dir of repo is a go package
pre_build() {
	cd $GOSRCPATH
	cd interfacer
	dep ensure
	cd $GOPATH
	mkdir -p bin
	mkdir -p src
	# main.go expects browsh/interfacer/src/browsh in GOPATH/src
	ln -nfs "$GOSRCPATH" src/browsh
}

do_build() {
	cd $GOSRCPATH
	PATH="$PATH:$GOPATH/bin/" interfacer/contrib/build_browsh.sh
}

do_install() {
	vbin interfacer/browsh
}

post_install() {
	vlicense LICENSE
}
