# Template file for 'openrazer-meta'
pkgname=openrazer-meta
version=2.4.0
revision=1
wrksrc="openrazer-${version}"
build_style=gnu-makefile
make_install_target="setup_dkms udev_install daemon_install xdg_install python_library_install"
hostmakedepends="python3-setuptools"
depends="python3-openrazer"
short_desc="Meta package for installing all required OpenRazer packages"
maintainer="Luca Weiss <luca@z3ntu.xyz>"
license="GPL-2.0-or-later"
homepage="https://openrazer.github.io"
distfiles="https://github.com/openrazer/openrazer/releases/download/v${version}/openrazer-${version}.tar.xz"
checksum=332ee525696ae1bb831f22bf2c699f028fbc8053445aaf6e5c9c2a2dc2760853

do_build() {
	:
}

openrazer-daemon_package() {
	short_desc="Userspace daemon that abstracts access to the kernel driver"
	depends="openrazer-driver-dkms python3-daemonize python3-pyudev
	 python3-setproctitle"
	pkg_install() {
		vmove etc/xdg/autostart
		vmove usr/bin
		vmove $py3_sitelib/openrazer_daemon
		vmove $py3_sitelib/openrazer_daemon-*.egg-info
		vmove usr/share
	}
}

openrazer-driver-dkms_package() {
	short_desc="Kernel driver for Razer devices (DKMS-variant)"
	depends="dkms"
	dkms_modules="openrazer-driver 1.0.0"
	system_groups="plugdev"
	pkg_install() {
		vmove usr/lib/udev
		vmove usr/src
	}
}

python3-openrazer_package() {
	short_desc="Python library for accessing the Razer daemon from Python"
	depends="openrazer-daemon python3-dbus python3-gobject python3-numpy"
	pkg_install() {
		vmove $py3_sitelib/openrazer
		vmove $py3_sitelib/openrazer-*.egg-info
	}
}
