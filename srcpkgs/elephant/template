# Template file for 'elephant'
pkgname=elephant
version=2.19.1
revision=1
build_style=go
go_import_path=github.com/abenz1267/elephant/v2
go_package="./cmd/elephant"
go_ldflags="-X main.version=${version}"
short_desc="Data provider service for application launchers and desktop utilities"
maintainer="Xavier Fortier <xavier.fortier@proton.me>"
license="GPL-3.0-or-later"
homepage="https://github.com/abenz1267/elephant"
changelog="https://github.com/abenz1267/elephant/releases"
distfiles="https://github.com/abenz1267/elephant/archive/v${version}.tar.gz"
checksum=0d3aaac36c8a4a596c7c699dd32bcf45e47141f3497610a8ba655ffbcaf36e51

case "$XBPS_TARGET_MACHINE" in
	aarch64*)
		go_ldflags+=" -extldflags=-fuse-ld=bfd"
		;;
esac

post_build() {
	local providers=$(find "internal/providers" -mindepth 1 -maxdepth 1 -type d ! -name "archlinuxpkgs" ! -name "dnfpackages")
	for p in ${providers}; do
		go build -buildmode=plugin -modcacherw -tags "${go_build_tags}" -ldflags "${go_ldflags}" ./"${p}"
	done
}

elephant-1password_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - 1Password"
	pkg_install() {
		vinstall 1password.so 755 usr/lib/elephant
	}
}

elephant-bitwarden_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Bitwarden"
	pkg_install() {
		vinstall bitwarden.so 755 usr/lib/elephant
	}
}

elephant-bluetooth_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Bluetooth"
	pkg_install() {
		vinstall bluetooth.so 755 usr/lib/elephant
	}
}

elephant-bookmarks_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Bookmarks"
	pkg_install() {
		vinstall bookmarks.so 755 usr/lib/elephant
	}
}

elephant-calc_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Calc"
	pkg_install() {
		vinstall calc.so 755 usr/lib/elephant
	}
}

elephant-clipboard_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Clipboard"
	pkg_install() {
		vinstall clipboard.so 755 usr/lib/elephant
	}
}

elephant-desktopapplications_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Desktop Applications"
	pkg_install() {
		vinstall desktopapplications.so 755 usr/lib/elephant
	}
}

elephant-files_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Files"
	pkg_install() {
		vinstall files.so 755 usr/lib/elephant
	}
}

elephant-menus_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Menus"
	pkg_install() {
		vinstall menus.so 755 usr/lib/elephant
	}
}

elephant-niriactions_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Niri Actions"
	pkg_install() {
		vinstall niriactions.so 755 usr/lib/elephant
	}
}

elephant-nirisessions_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Niri Sessions"
	pkg_install() {
		vinstall nirisessions.so 755 usr/lib/elephant
	}
}

elephant-providerlist_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Provider List"
	pkg_install() {
		vinstall providerlist.so 755 usr/lib/elephant
	}
}

elephant-runner_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Runner"
	pkg_install() {
		vinstall runner.so 755 usr/lib/elephant
	}
}

elephant-snippets_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Snippets"
	pkg_install() {
		vinstall snippets.so 755 usr/lib/elephant
	}
}

elephant-symbols_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Symbols"
	pkg_install() {
		vinstall symbols.so 755 usr/lib/elephant
	}
}

elephant-todo_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Todo"
	pkg_install() {
		vinstall todo.so 755 usr/lib/elephant
	}
}

elephant-unicode_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Unicode"
	pkg_install() {
		vinstall unicode.so 755 usr/lib/elephant
	}
}

elephant-websearch_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Web Search"
	pkg_install() {
		vinstall websearch.so 755 usr/lib/elephant
	}
}

elephant-windows_package() {
	depends="elephant-${version}_${revision}"
	short_desc+=" - Windows"
	pkg_install() {
		vinstall windows.so 755 usr/lib/elephant
	}
}
