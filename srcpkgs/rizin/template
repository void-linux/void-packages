# Template file for 'rizin'
pkgname=rizin
version=0.3.1
revision=1
_sdb_commit=db7edd4a96a89b6749b677a85d7fa4ee2c6fbbb9
_tree_c_commit=3dd21d9440ca39d8c201335b2f3a393db41aab36
build_style=meson
configure_args="-Duse_sys_openssl=enabled -Duse_sys_magic=enabled
 -Duse_sys_capstone=enabled -Duse_sys_libzip=enabled
 -Duse_sys_zlib=enabled -Duse_sys_tree_sitter=enabled
 -Duse_sys_lz4=enabled -Denable_tests=true
 -Dsubprojects_check=false
 -Dpackager=VoidLinux -Dpackager_version=${version}_${revision}"
hostmakedepends="pkg-config"
makedepends="capstone-devel tree-sitter-devel xxHash-devel
 file-devel zlib-devel libzip-devel liblz4-devel
 libuv-devel openssl-devel"
short_desc="Advanced command line debugger and hexadecimal editor"
maintainer="John <me@johnnynator.dev>"
license="LGPL-3.0-only"
homepage="https://rizin.re"
distfiles="https://github.com/rizinorg/rizin/archive/v${version}.tar.gz
 https://github.com/rizinorg/sdb/archive/${_sdb_commit}.tar.gz
 https://github.com/rizinorg/tree-sitter-c/archive/${_tree_c_commit}.tar.gz"
checksum="1e5ce8cdc38f26529da3b3f4d57a170f506dbd1a269c4adbe8b25ebbf6e4cead
 589baa469f644f2c4220cf1e338975adebb0e8bcdaef8c9d1b5bd9950a17281f
 cf21ce307bd5e38e66135acd02f3d39ca941e4e6e097c81f5e7550256c32cbdc"

post_extract() {
	mv ../sdb-${_sdb_commit} subprojects/sdb
	mv ../tree-sitter-c-${_tree_c_commit} subprojects/tree-sitter-c
	cp subprojects/packagefiles/tree-sitter-c/meson.build subprojects/tree-sitter-c
}

rizin-devel_package() {
	depends="rizin>=${version}_${revision}
	 ${makedepends}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/lib/pkgconfig
		vmove usr/include
		vmove "usr/lib/*.so"
	}
}
