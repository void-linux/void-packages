# Template file for 'gonic'
pkgname=gonic
version=0.18.0
revision=1
build_style=go
go_import_path="go.senan.xyz/gonic"
go_package="${go_import_path}/cmd/gonic"
hostmakedepends="pkg-config"
makedepends="alsa-lib-devel sqlite-devel taglib-devel"
depends="ffmpeg"
short_desc="Music streaming server / subsonic server API implementation"
maintainer="Duncaen <duncaen@voidlinux.org>"
license="GPL-3.0-or-later"
homepage="https://github.com/sentriz/gonic"
distfiles="https://github.com/sentriz/gonic/archive/v${version}.tar.gz"
checksum=386c3cb64eb2e6c3027beb8d2d85211d56e3a783d85053c1310f1fe4bdb68860

system_accounts="_gonic"
_gonic_homedir="/var/lib/gonic"
make_dirs="
 /var/cache/gonic       755 _gonic _gonic
 /var/db/gonic          755 _gonic _gonic
 /var/lib/gonic/music   755 _gonic _gonic
 /var/lib/gonic/podcast 755 _gonic _gonic"

do_check() {
	go test ./...
}

post_install() {
	vsv gonic
}
