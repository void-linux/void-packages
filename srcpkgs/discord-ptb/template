# Template file for 'discord-ptb'
pkgname=discord-ptb
version=0.0.18
revision=1
archs="x86_64"
wrksrc="DiscordPTB"
depends="alsa-lib dbus-glib gtk+3 GConf libnotify nss libXtst libcxx libatomic"
short_desc="Proprietary freeware VoIP application"
maintainer="Abel Graham <abel@abelgraham.com>"
license="custom:Proprietary"
homepage="https://discordapp.com/"
distfiles="https://dl-ptb.discordapp.net/apps/linux/${version}/discord-ptb-${version}.tar.gz"
checksum=ef0415fd65b7f6009ccc59f18c72d4ef373f29c608b0a53d5faa5ea80fbc3ded
repository=nonfree
restricted=yes
nopie=yes

do_install() {
	local package_location="usr/lib/$pkgname" item
	vmkdir usr/share/pixmaps
	vinstall discord.png 644 /usr/share/pixmap/ discord-ptb.png
	vmkdir usr/share/applications
	vcopy discord-ptb.desktop /usr/share/applications/
	vmkdir ${package_location}
	for item in locales resources swiftshader chrome-sandbox DiscordPTB libffmpeg.so libEGL.so libGLESv2.so natives_blob.bin snapshot_blob.bin v8_context_snapshot.bin resources.pak chrome_100_percent.pak chrome_200_percent.pak icudtl.dat; do
		vcopy "${item}" "${package_location}"
	done
	vmkdir usr/bin
	ln -sfr $DESTDIR/${package_location}/DiscordPTB $DESTDIR/usr/bin/discord-ptb
}
