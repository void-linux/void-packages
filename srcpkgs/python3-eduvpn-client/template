# Template file for 'python3-eduvpn-client'
pkgname=python3-eduvpn-client
version=4.6.0
revision=1
build_style=python3-module
hostmakedepends="python3-setuptools"
depends="python3-eduvpn_common python3-gobject NetworkManager-openvpn"
checkdepends="${depends} python3-pytest python3-pycodestyle"
short_desc="Linux client and Python client API for eduVPN"
maintainer="John <me@johnnynator.dev>"
license="GPL-3.0-or-later"
homepage="https://www.eduvpn.org/"
distfiles="https://codeberg.org/eduVPN/linux-app/releases/download/${version}/linux-app-${version}.tar.xz"
checksum=d7d2690ab5fc6690679c0620dbbebea39a8f375dbc2d0e16fbe96f7b9bfba017

if [ "$XBPS_TARGET_LIBC" = "musl" ]; then
	broken="python3-eduvpn_common not compatible with musl"
fi

post_install() {
	mv ${DESTDIR}/${py3_sitelib}/eduvpn/data/share \
		${DESTDIR}/usr/share
}

eduvpn-client_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/share/icons/hicolor/48x48/apps/org.eduvpn.client.png
		vmove usr/share/icons/hicolor/128x128/apps/org.eduvpn.client.png
		vmove usr/share/icons/hicolor/256x256/apps/org.eduvpn.client.png
		vmove usr/share/icons/hicolor/512x512/apps/org.eduvpn.client.png
		vmove usr/bin/eduvpn-cli
		vmove usr/bin/eduvpn-gui
		vmove usr/share/applications/org.eduvpn.client.desktop
	}
}

letsconnect-client_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/share/letsconnect
		vmove usr/share/icons/hicolor/48x48/apps/org.letsconnect-vpn.client.png
		vmove usr/share/icons/hicolor/128x128/apps/org.letsconnect-vpn.client.png
		vmove usr/share/icons/hicolor/256x256/apps/org.letsconnect-vpn.client.png
		vmove usr/share/icons/hicolor/512x512/apps/org.letsconnect-vpn.client.png
		vmove usr/bin/letsconnect-cli
		vmove usr/bin/letsconnect-gui
		vmove usr/share/applications/org.letsconnect-vpn.client.desktop
	}
}
