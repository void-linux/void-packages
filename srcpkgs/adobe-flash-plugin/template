# Template file for 'adobe-flash-plugin'
pkgname=adobe-flash-plugin
_distver=092710
version=10.1p2_${_distver}
#revision=1
# The EULA file
_eula="http://www.adobe.com/products/eulas/pdfs/Reader_Player_WWEULA-Combined-20060724_1430.pdf"
_eulacksum=986c3ddacfee18946fbef7b76485922f8f36e61f790776ce82a87afff3008427
if [ "$xbps_machine" = "x86_64" ]; then
	# There is no x86_64 version for 10.1beta yet.
	_disttarball="http://download.macromedia.com/pub/labs/flashplayer10"
	_disttarball="${_disttarball}/flashplayer_square_p2_64bit_linux_${_distver}.tar.gz"
	_distcksum=fdaaed681883636a3bba59a189986f5dda72e3c65613fce1e066e56111b00da1
else
	_disttarball="http://download.macromedia.com/pub/labs/flashplayer10"
	_disttarball="${_disttarball}/flashplayer_square_p2_32bit_linux_${_distver}.tar.gz"
	_distcksum=9d821c3619a0a7f1f5769d6a7c57684d83a1c565896c354f9fcd7fb3f3620eec
fi
distfiles="${_eula} ${_disttarball}"
checksum="${_eulacksum} ${_distcksum}"
noextract=yes
build_style=custom-install
short_desc="Adobe Flash Player plugin"
maintainer="Juan RP <xtraeme@gmail.com>"
long_desc="
 This is the Adobe Flash Player plugin for Netscape compatible browsers."

Add_dependency run libgcc
Add_dependency run glibc
Add_dependency run libstdc++
Add_dependency run libX11
Add_dependency run libXext
Add_dependency run libXt
Add_dependency run freetype
Add_dependency run fontconfig
Add_dependency run gdk-pixbuf
Add_dependency run gtk+
Add_dependency run atk
Add_dependency run pango
Add_dependency run cairo
Add_dependency run glib
Add_dependency run nss
Add_dependency run nspr
Add_dependency run libcurl

Add_dependency build libstdc++-devel
Add_dependency build glibc-devel
Add_dependency build libX11-devel
Add_dependency build libXext-devel
Add_dependency build libXt-devel
Add_dependency build freetype-devel
Add_dependency build fontconfig-devel
Add_dependency build gdk-pixbuf-devel
Add_dependency build gtk+-devel
Add_dependency build atk-devel
Add_dependency build pango-devel
Add_dependency build cairo-devel
Add_dependency build glib-devel
Add_dependency build nss-devel
Add_dependency build nspr-devel
Add_dependency build libcurl-devel

do_install()
{
	cd ${wrksrc} || retuyrn 1
	install -d ${DESTDIR}/usr/lib/mozilla/plugins \
		   ${DESTDIR}/usr/share/doc/${pkgname} || return 1
	tar xfz "${XBPS_SRCDISTDIR}/$(basename ${_disttarball})" || return 1
	if [ "${xbps_machine}" = "x86_64" ]; then
		install -m755 libflashplayer.so ${DESTDIR}/usr/lib/mozilla/plugins \
			|| return 1
	else
		install -m755 install_flash_player_10_linux/libflashplayer.so \
			${DESTDIR}/usr/lib/mozilla/plugins || return 1
	fi
	install -m644 "${XBPS_SRCDISTDIR}/$(basename ${_eula})" \
		${DESTDIR}/usr/share/doc/${pkgname} || return 1
}
