# Template file for 'grapejuice'
pkgname=grapejuice
version=4.9.2
revision=1
wrksrc=${pkgname}-v${version}
build_style=python3-module
hostmakedepends="python3-setuptools python3-pip python3-wheel
 pkg-config cairo-devel gobject-introspection"

depends="gtk+3 python3-pip python3-cairo python3-gobject desktop-file-utils xdg-utils cairo-devel
 xdg-user-dirs gtk-update-icon-cache shared-mime-info pkg-config gobject-introspection"

short_desc="Wine+Roblox management tool"
maintainer="wael <40663@protonmail.com>"
license="GPL-3.0-only"
homepage="https://brinkervii.gitlab.io/grapejuice/"
distfiles="https://gitlab.com/brinkervii/${pkgname}/-/archive/v${version}/${pkgname}-v${version}.tar.gz"
checksum=2d377a2baa511dd7385c07e459cc278cd7da6d0fa35e5a31cb819e35c24e830c

pre_patch() {
	vsed -i src/grapejuice_common/assets/desktop/roblox-app.desktop \
		-e 's|$PLAYER_ICON|grapejuice-roblox-player|g' -e 's|$GRAPEJUICE_EXECUTABLE|/usr/bin/grapejuice|g'
	vsed -i src/grapejuice_common/assets/desktop/roblox-player.desktop \
		-e 's|$PLAYER_ICON|grapejuice-roblox-player|g' -e 's|$GRAPEJUICE_EXECUTABLE|/usr/bin/grapejuice|g'
	vsed -i src/grapejuice_common/assets/desktop/roblox-studio.desktop \
		-e 's|$STUDIO_ICON|grapejuice-roblox-studio|g' -e 's|$GRAPEJUICE_EXECUTABLE|/usr/bin/grapejuice|g'
}

post_install() {
	vmkdir usr/share/applications
	vmkdir usr/share/icons/hicolor
	vmkdir usr/share/mime/packages/
	vcopy src/grapejuice_common/assets/desktop/* usr/share/applications
	vcopy src/grapejuice_common/assets/icons/hicolor/* usr/share/icons/hicolor
	vcopy src/grapejuice_common/assets/mime_xml/x-grapejuice-roblox.xml usr/share/mime/packages
}
