# Template file for 'cargo-nextest'
pkgname=cargo-nextest
version=0.9.47
revision=1
build_style=cargo
configure_args="--no-default-features --features default-no-update"
make_check_args="-- --skip test_run_from_archive
 --skip test_run_after_build
 --skip target_runner::test_listing_with_target_runner
 --skip target_runner::test_run_with_target_runner"
make_install_args="--path cargo-nextest"
short_desc="Next-generation test runner for Rust"
maintainer="Marcin Puc <tranzystorek.io@protonmail.com>"
license="Apache-2.0, MIT"
homepage="https://nexte.st/"
changelog="https://raw.githubusercontent.com/nextest-rs/nextest/main/site/src/CHANGELOG.md"
distfiles="https://github.com/nextest-rs/nextest/archive/refs/tags/cargo-nextest-${version}.tar.gz"
checksum=dbd685b0ef4e4e632ed0ee7136526a0daa1e73b11df5fd9b04a06ccd83557a1c
make_check_pre="env NEXTEST_BIN_EXE_cargo-nextest-dup=${XBPS_BUILDDIR}/${pkgname}-${version}/target/${RUST_TARGET}/release/cargo-nextest-dup"

case "${XBPS_TARGET_MACHINE}" in
	x86_64-musl) make_check_args+=" --skip test_relocated_run --skip test_target_dir";;
	*) ;;
esac

post_install() {
	vlicense LICENSE-MIT
}
