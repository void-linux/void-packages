# Template file for 'makemkv'
pkgname=makemkv
version=1.17.2
revision=1
archs="x86_64"
build_wrksrc="${pkgname}-oss-${version}"
build_style=gnu-configure
hostmakedepends="pkg-config"
makedepends="openssl-devel qt5-devel ffmpeg-devel"
short_desc="Blu-ray and DVD ripper"
maintainer="Jan Christian Gr√ºnhage <jan.christian@gruenhage.xyz>"
license="custom: Proprietary License"
homepage="https://www.makemkv.com/"
distfiles="https://www.makemkv.com/download/makemkv-bin-${version}.tar.gz
 https://www.makemkv.com/download/makemkv-oss-${version}.tar.gz"
checksum="80008ccc9ee864293f20d49e25a57b1a717d872ffa17d7744032e9e633e21789
 a83f8abb3f23def0dc8783e535062a75b7df2f7612291a8a83a21f90b93f2da4"
nopie_files="/usr/bin/makemkvcon"
repository=nonfree

do_configure() {
	./configure
}

do_build() {
	make ${makejobs}
	cd ../${pkgname}-bin-${version}
	mkdir -p tmp
	echo "accepted" > tmp/eula_accepted
	make ${makejobs}
	cd ../${pkgname}-oss-${version}
}

do_install() {
	make DESTDIR=${DESTDIR} install
	cd ../${pkgname}-bin-${version}
	make DESTDIR=${DESTDIR} install
	cd ../${pkgname}-oss-${version}
}

post_install() {
	vlicense License.txt
}
