# Template file for 'python3-Cheroot'
pkgname=python3-Cheroot
version=9.0.0
revision=1
build_style=python3-module
make_check_args="--ignore cheroot/test/test_server.py" # requires pypy
hostmakedepends="python3-setuptools python3-setuptools_scm"
depends="python3-six python3-more-itertools python3-jaraco.functools"
checkdepends="${depends} python3-jaraco.context python3-jaraco.text python3-pytest python3-pytest-forked
 python3-pytest-mock python3-pytest-cov python3-pytest-sugar python3-pytest-xdist python3-pytest-rerunfailures
 python3-watchdog python3-trustme python3-requests-toolbelt python3-requests-unixsocket python3-urllib3 python3-openssl python3-portend"
short_desc="High-performance, pure-Python HTTP server (Python3)"
maintainer="Orphaned <orphan@voidlinux.org>"
license="BSD-3-Clause"
homepage="https://github.com/cherrypy/cheroot"
changelog="https://github.com/cherrypy/cheroot/blob/master/CHANGES.rst"
distfiles="${PYPI_SITE}/c/cheroot/cheroot-${version}.tar.gz"
checksum=3d47ad9ee19ecbec144b4758399036692fdbf67a40b96eef1fb1454367b3d338
alternatives="cheroot:cheroot:/usr/bin/cheroot3"

post_patch() {
	# Don't need setuptools_scm_git_archive for the tarball
	vsed -e '/setuptools_scm_git_archive/d' -i setup.cfg
}

post_install() {
	mv "${DESTDIR}/usr/bin/cheroot" "${DESTDIR}/usr/bin/cheroot3"
	vlicense LICENSE.md
}
