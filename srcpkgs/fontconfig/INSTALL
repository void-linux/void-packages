#
# This script establishes a default config and builds the font cache
#
case "${ACTION}" in
pre)
	;;
post)
	_confd="etc/fonts/conf.d"
	if [ ! -e "${_confd}/.xbps-configured" ] && [ -r "${_confd}/.defconfigs" ]; then
		echo "Setting default font configuration..."

		while read -r _f; do
			_fsrc="usr/share/fontconfig/conf.avail/${_f}"
			[ -e "${_fsrc}" ] || continue

			[ -e "${_confd}/${_f}" ] || ln -s "/${_fsrc}" "${_confd}/${_f}"
		done < "${_confd}/.defconfigs"

		: > etc/fonts/conf.d/.xbps-configured
		unset _f _fsrc
	fi
	unset _confd

	echo "Building fonts cache... "
	fc-cache -f >/dev/null
	echo "done."
	;;
esac
