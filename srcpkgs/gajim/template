# Template file for 'gajim'
pkgname=gajim
version=2.4.3
revision=1
build_style=python3-pep517
hostmakedepends="gettext python3-wheel"
depends="gsound gst-libav gst-plugins-bad1 gst-plugins-base1 gst-plugins-good1
 gst-plugins-rs1 gtksourceview5 libadwaita libnm libsecret libsoup3 python3-Pillow
 python3-SQLAlchemy2 python3-cairo python3-cryptography python3-css-parser
 python3-dbus python3-distro python3-emoji python3-gobject python3-h2
 python3-httpx python3-jeepney python3-keyring python3-nbxmpp python3-netifaces
 python3-omemo-dr python3-openssl python3-packaging python3-precis-i18n
 python3-pyasn1 python3-qrcode python3-setuptools python3-socksio
 python3-truststore"
checkdepends="${depends} python3-packaging"
short_desc="Full featured Jabber/XMPP client"
maintainer="Emil Tomczyk <emru@emru.xyz>"
license="GPL-3.0-only"
homepage="https://www.gajim.org"
changelog="https://dev.gajim.org/gajim/gajim/-/raw/master/ChangeLog"
distfiles="https://gajim.org/downloads/${version%.*}/gajim-${version}.tar.gz"
checksum=edcd1f47883789ecd1a1ac5685058a95a33d7d4a986bcbd0a4ad7feb8525e6d5

post_build() {
	./make.py build --dist=unix
}

post_install() {
	./make.py install --dist=unix --prefix=$DESTDIR/usr
	vdoc "${FILESDIR}/README.voidlinux"
}

do_check() {
	python -m unittest discover -s test
}

gajim-omemo_package() {
	depends="gajim"
	short_desc+=" (transitional dummy package)"
	metapackage=yes
}
