# Template file for 'zeal'
pkgname=zeal
reverts="20141123_1 20141123_2"
version=0.7.1
revision=1
build_style=cmake
configure_args="-DQT_HOST_PATH=/usr -DZEAL_RELEASE_BUILD=ON"
hostmakedepends="pkg-config extra-cmake-modules"
makedepends="xcb-util-keysyms-devel libarchive-devel sqlite-devel libarchive-devel"
depends="desktop-file-utils hicolor-icon-theme"
short_desc="Simple offline API documentation browser"
maintainer="Farhad Shahbazi <grauwolf@geekosphere.org>"
license="GPL-3.0-or-later"
homepage="https://zealdocs.org/"
distfiles="https://github.com/zealdocs/zeal/archive/v${version}.tar.gz"
checksum=fca3012c174c7df6a91a6f93ef0df371fa714de769e3904f8fda3635ff959397

build_options="qt6 webkit"
desc_option_qt6="Use Qt6 GUI and WebEngine backend"
desc_option_webkit="Use Qt5 WebKit backend"

vopt_conflict qt6 webkit

# WebEngine is unavailable on BE systems or when host & target word sizes differ
if [ "$XBPS_TARGET_ENDIAN" != "le" ]; then
	build_options_default="webkit"
elif [ "$XBPS_WORDSIZE" != "$XBPS_TARGET_WORDSIZE" ]; then
	build_options_default="webkit"
elif [ "$XBPS_WORDSIZE" != 32 ]; then
	# qt6-webengine is broken on 32-bit systems
	build_options_default="qt6"
fi

if [ "$build_option_qt6" ]; then
	hostmakedepends+=" qt6-base qt6-tools"
	makedepends+=" qt6-base-devel qt6-webengine-devel
		qt6-webchannel-devel"
else
	hostmakedepends+=" qt5-host-tools qt5-qmake"
	makedepends+=" qt5-tools-devel qt5-x11extras-devel qt5-webchannel-devel
		qt5-declarative-devel qt5-location-devel
		$(vopt_if webkit qt5-webkit-devel qt5-webengine-devel)"
fi
