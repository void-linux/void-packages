# Template file for 'python3-dataclasses-json'
pkgname=python3-dataclasses-json
version=0.6.7
revision=1
build_style=python3-pep517
hostmakedepends="python3-wheel python3-poetry-core"
depends="python3-marshmallow python3-typing_inspect"
short_desc="Easy serialization of data classes to and from JSON"
maintainer="Mihail Ivanchev <contact@ivanchev.net>"
license="MIT"
homepage="https://github.com/lidatong/dataclasses-json"
distfiles="${PYPI_SITE}/d/dataclasses-json/dataclasses_json-${version}.tar.gz"
checksum=b6b3e528266ea45b9535223bc53ca645f5208833c29229e847b3f26a1cc55fc0

post_patch() {
	# Patch away the poetry-dynamic-versioning dependency since the
	# version is already in the pyproject.toml file (but make sure it
	# really is).
	grep --quiet "^version = \"${version}\"$" pyproject.toml
	vsed -i -e "s/^requires = \[\"poetry-core>=1.2.0\", \"poetry-dynamic-versioning\"\]/requires = [\"poetry-core>=1.2.0\"]/" pyproject.toml
	vsed -i -e 's/^build-backend = .*//' pyproject.toml
}

post_install() {
	vlicense LICENSE
}
