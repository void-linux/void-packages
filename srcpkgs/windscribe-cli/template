# Template file for 'windscribe-cli'
pkgname=windscribe-cli
version=1.3
revision=1
archs="x86_64"
create_wrksrc=yes
hostmakedepends="xz tar"
depends="openvpn"
short_desc="Port of Windscribes CLI"
maintainer="Rivularis <rivularis@protonmail.com>"
license="GPL-2.0"
homepage="https://windscribe.com/"
nopie=yes

_windscribeVersion=19
distfiles="https://assets.staticnetcontent.com/desktop/linux/${pkgname}_${version}-${_windscribeVersion}_amd64.deb"
checksum=2adef3ff36423de681279a7f8ddaac29612779bdbcba9cf24098952646fa0253
do_extract() {
	ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/${pkgname}_${version}-${_windscribeVersion}_amd64.deb
	cd ${wrksrc}
	tar xvf data.tar.xz
	tar xzpvf control.tar.gz
}

do_install() {
	echo "creating windscribe directory"
	vmkdir etc/windscribe
	echo "Configuring Bash Completion"
	vinstall ${wrksrc}/etc/bash_completion.d/windscribe_complete 644 usr/bash-completion/completions
	vinstall ${wrksrc}/etc/init.d/windscribe-cli 644 etc/init.d/windscribe-cli
	echo "configuring windscribe binary and license"
	vbin ${wrksrc}/usr/bin/windscribe
	vlicense ${wrksrc}/usr/share/doc/windscribe-cli/copyright
}
post_install() {
	vmkdir bin/sv
	ln -s ${DESTDIR}/bin/sv ${DESTDIR}/etc/init.d/
}
