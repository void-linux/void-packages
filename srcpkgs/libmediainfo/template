# Template file for 'libmediainfo'
pkgname=libmediainfo
version=20.08
revision=1
wrksrc=MediaInfoLib
build_wrksrc=Project/GNU/Library
build_style=gnu-configure
configure_args="--enable-shared --disable-static --with-libcurl --with-libmms"
hostmakedepends="automake libtool pkg-config"
makedepends="libcurl-devel libmms-devel libzen-devel"
short_desc="Shared library for mediainfo"
maintainer="John <me@johnnynator.dev>"
license="BSD-2-Clause"
homepage="https://mediaarea.net/MediaInfo"
distfiles="https://mediaarea.net/download/source/libmediainfo/${version}/${pkgname}_${version}.tar.xz"
checksum=12d346b10d6cbb83b81926de5fbfe6dee9e9f877e73cb5dac86609826582c8a6

pre_configure() {
	autoreconf -fi
}

post_install() {
	for i in MediaInfo MediaInfoDLL; do
		install -Dm644 ${wrksrc}/Source/$i/*.h -t ${DESTDIR}/usr/include/$i
	done

	sed -i -e 's|Version: |Version: '$version'|g' libmediainfo.pc
	vinstall libmediainfo.pc 644 usr/lib/pkgconfig
	vlicense ${wrksrc}/License.html
}

libmediainfo-devel_package() {
	depends="${makedepends} libmediainfo>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
	}
}
