# Template file for 'mullvad-vpn'
pkgname=mullvad-vpn
version=2021.6
revision=1
archs="x86_64"
short_desc="Mullvad VPN client app"
depends="dbus"
maintainer="Tung Anh Vu <vu.tunganh96@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://mullvad.net"
distfiles="https://github.com/mullvad/mullvadvpn-app/releases/download/$version/MullvadVPN-${version}_amd64.deb"
checksum=95b9638f304a00d72ce6b6f3a38ff9f623142541cfaa4d6e9aa142c27d86ea6e
nopie_files="/opt/Mullvad-VPN/resources/app.asar.unpacked/node_modules/grpc-tools/bin/grpc_node_plugin
 /opt/Mullvad-VPN/resources/app.asar.unpacked/node_modules/grpc-tools/bin/protoc"
make_dirs="/var/log/mullvad-vpn 755 0 0"

do_extract() {
	ar p ${XBPS_SRCDISTDIR}/${pkgname}-${version}/MullvadVPN-${version}_amd64.deb \
		data.tar.xz | bsdtar -x -f -

	mv "opt/Mullvad VPN" opt/Mullvad-VPN
	mv usr/local/share/zsh usr/share
}

do_install() {
	vmkdir usr
	vcopy ${wrksrc}/usr/* usr

	vmkdir opt
	vcopy ${wrksrc}/opt/* opt

	vsv mullvad-vpn
}
