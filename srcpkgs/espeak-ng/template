# Template file for 'espeak-ng'
pkgname=espeak-ng
version=1.52.0
revision=1
build_style=cmake
build_helper=qemu
configure_args="-DBUILD_SHARED_LIBS=ON"
hostmakedepends="pkg-config"
makedepends="pcaudiolib-devel libsonic-devel"
short_desc="Text to Speech engine"
maintainer="Joey <joey@imap.cc>"
license="GPL-3.0-or-later"
homepage="https://github.com/espeak-ng/espeak-ng/"
changelog="https://raw.githubusercontent.com/espeak-ng/espeak-ng/master/ChangeLog.md"
distfiles="https://github.com/espeak-ng/espeak-ng/archive/${version}.tar.gz"
checksum=bb4338102ff3b49a81423da8a1a158b420124b055b60fa76cfb4b18677130a23
CFLAGS="-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"
CXXFLAGS="$CFLAGS"

do_build() {
	export ESPEAK_DATA_PATH="$wrksrc/build"
	ninja -C build ${make_jobs}
}

do_check() {
	#disableall checks because of breakage
	return
}

libespeak-ng_package() {
	short_desc+=" - runtime libraries"
	pkg_install() {
		vmove "usr/lib/*.so.*"
		vmove usr/share/espeak-ng-data
	}
}

libespeak-ng-devel_package() {
	depends="libespeak-ng>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove "/usr/lib/pkgconfig"
	}
}

espeak_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	metapackage=yes
	short_desc+=" (transitional dummy package)"
}

libespeak_package() {
	depends="libespeak-ng>=${version}_${revision}"
	metapackage=yes
	short_desc+=" (transitional dummy package)"
}

libespeak-devel_package() {
	depends="libespeak-ng-devel>=${version}_${revision}"
	metapackage=yes
	short_desc+=" (transitional dummy package)"
}
