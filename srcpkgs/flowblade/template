# Template file for 'flowblade'
pkgname=flowblade
version=2.12.0.2
revision=1
build_wrksrc=flowblade-trunk
build_style=python3-module
make_install_args="--install-lib=${DESTDIR}/usr/share/flowblade"
hostmakedepends="python3-setuptools"
# https://github.com/jliljebl/flowblade/blob/master/flowblade-trunk/docs/DEPENDENCIES.md
depends="frei0r-plugins gmic mlt7 mlt7-python3 python3-cairo python3-Pillow python3-gobject python3-numpy gtk+3
 swh-plugins gdk-pixbuf pango librsvg SDL_image swh-plugins"
short_desc="Non-linear video editor for Linux"
maintainer="shizonic <realtiaz@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://jliljebl.github.io/flowblade/"
distfiles="https://github.com/jliljebl/flowblade/archive/v${version}.tar.gz>${pkgname}-v${version}.tar.gz"
checksum=f9c8598a373fc71e9493b4079a7a67c7afe3583939cdf1998600971988286f7d
make_check=no # no tests to run

do_patch() {
	# Desktop file should run /usr/bin/flowblade.sh
	vsed -i installdata/io.github.jliljebl.Flowblade.desktop -e 's#env.*#/usr/bin/flowblade.sh %f#'
}

post_install() {
	# Enforce X11, otherwise it crashes on wayland
	vbin "${FILESDIR}/enforce-x11.sh" flowblade.sh
}
