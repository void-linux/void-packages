# Template file for 'tuxpaint'
pkgname=tuxpaint
version=0.9.35
revision=1
build_style=gnu-makefile
conf_files="/etc/tuxpaint/tuxpaint.conf"
hostmakedepends="gettext gperf pkg-config ImageMagick"
makedepends="SDL2-devel SDL2_image-devel SDL2_mixer-devel SDL2_ttf-devel
 SDL2_gfx-devel SDL2_Pango-devel freetype-devel pango-devel
 cairo-devel fribidi-devel libimagequant-devel libpaper-devel librsvg-devel"
short_desc="Free, award-winning drawing program for children ages 3 to 12"
maintainer="Piotr WÃ³jcik <chocimier@tlen.pl>"
license="GPL-2.0-or-later"
homepage="https://www.tuxpaint.org/"
changelog="https://tuxpaint.org/docs/CHANGES.txt"
distfiles="${SOURCEFORGE_SITE}/tuxpaint/${version}/tuxpaint-${version}.tar.gz"
checksum=c1c18af91be77e94fdaab2c928204c4c39ba39ac5da2f441aaf2ecab6d8bd0ad
replaces="tuxpaint-data>=0"
CFLAGS="-D_GNU_SOURCE -D_POSIX_PRIORITY_SCHEDULING"

pre_build() {
	vsed -i Makefile -e s,/etc/bash_completion.d,/usr/share/bash-completion/completions,
	# Add freetype2 and pango include paths
	export CFLAGS+=" $(pkg-config --cflags freetype2 pango)"
}

post_install() {
	vinstall src/tuxpaint.desktop 644 usr/share/applications
	# python 2
	rm "${DESTDIR}/usr/share/doc/tuxpaint-${version}/outdated/zh_tw/mkTuxpaintIM.py" \
		"${DESTDIR}/usr/share/tuxpaint/fonts/locale/zh_tw_docs/maketuxfont.py"
}
