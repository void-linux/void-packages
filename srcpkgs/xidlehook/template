# Template file for 'xidlehook'
pkgname=xidlehook
version=0.9.1
revision=1
archs="x86_64 x86_64-musl aarch64 aarch64-musl"
build_style=cargo
configure_args="$(vopt_if audio '--features pulse' '--no-default-features')"
make_install_args="--path xidlehook-daemon"
hostmakedepends="pkg-config python3"
makedepends="libxcb-devel libXScrnSaver-devel $(vopt_if audio libpulseaudio)"
short_desc="General-purpose replacement for xautolock"
maintainer="xXR01I1Xx <xxr01i1xx@tuta.io>"
license="MIT"
homepage="https://gitlab.com/jD91mZM2/xidlehook"
distfiles="${homepage}/-/archive/${version}/${pkgname}-${version}.tar.gz"
checksum=3ad93080cf8114d2a9521f9288a09e351a54630f70d2d8cd87beb5f5e3f1f8b1
build_options_default="audio"
desc_option_audio="Don't invoke the timer when any audio is playing (Only works with Pulseaudio)"
build_options="audio"

do_build() {
	cargo build --release --target ${RUST_TARGET} ${configure_args} --manifest-path xidlehook-daemon/Cargo.toml
}

do_check() {
	cargo test --release --target ${RUST_TARGET}
}

post_install() {
	vlicense LICENSE
}
