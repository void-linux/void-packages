# Template file for 'xmobar'
pkgname=xmobar
version=0.50
revision=1
build_style=cabal
cabal_index_state=2025-07-05T14:01:16Z
hostmakedepends="pkg-config"
makedepends="libX11-devel libXinerama-devel libXrandr-devel libXScrnSaver-devel
 glib-devel cairo-devel pango-devel
 $(vopt_if iwlib wireless_tools-devel)
 $(vopt_if xpm libXpm-devel)
 $(vopt_if dbus libxml2-devel $(vopt_if mpris libxml2-devel))
 $(vopt_if alsa alsa-lib-devel)"
short_desc="Minimalistic Text Based Status Bar"
maintainer="Orphaned <orphan@voidlinux.org>"
license="BSD-3-Clause"
homepage="https://xmobar.org"
distfiles="https://hackage.haskell.org/package/${pkgname}-${version}/${pkgname}-${version}.tar.gz
 https://hackage.haskell.org/package/gtk2hs-buildtools-0.13.12.0/gtk2hs-buildtools-0.13.12.0.tar.gz
 https://hackage.haskell.org/package/basement-0.0.16/basement-0.0.16.tar.gz
 https://hackage.haskell.org/package/memory-0.18.0/memory-0.18.0.tar.gz
 https://hackage.haskell.org/package/cborg-0.2.10.0/cborg-0.2.10.0.tar.gz"
checksum="09249e50546f1eb93888bf1e134d0034d486cadb29a8fde4df097d140e06da08
 2308f302b1a55376c715778b89b15d0d7e0cc20c8589b803b5f9010ea2f1e495
 7fb77e249aef76ba5aed3059d556800ce02b614597c488ba01f0a16449146300
 fd4eb6f638e24b81b4e6cdd68772a531726f2f67686c8969d3407d82f7862e3e
 17fe070c38fc498cab49bcb9d6215b7747d53bedf96502e9bcce9cad73b9c797"
build_options="dbus threaded mpd mpris inotify iwlib alsa datezone
 xpm uvmeter weather nl80211"
build_options_default="threaded inotify nl80211 datezone weather xpm alsa mpris mpd dbus"
nopie_files="/usr/bin/xmobar"
nocross=yes
skip_extraction="
 gtk2hs-buildtools-0.13.12.0.tar.gz
 basement-0.0.16.tar.gz
 memory-0.18.0.tar.gz
 cborg-0.2.10.0.tar.gz"
make_check=no # TODO figure out how hspec works
vopt_hflag() {
	echo $(vopt_if $1 "--flags=with_$1" "--flags=-with_$1")
}
mk_string_build_args() {
	for optn in $1
	do
		echo -n " $(vopt_hflag $optn)"
	done
}
make_build_args=$(mk_string_build_args "$build_options")

post_extract() {
	vsrcextract -C gtk2hs-buildtools gtk2hs-buildtools-0.13.12.0.tar.gz
	vsrcextract -C basement basement-0.0.16.tar.gz
	vsrcextract -C memory memory-0.18.0.tar.gz
	vsrcextract -C cborg cborg-0.2.10.0.tar.gz
}

pre_configure() {
	echo 'packages: ./gtk2hs-buildtools ./basement ./memory ./cborg .' > cabal.project
}

post_install() {
	vlicense license
}
