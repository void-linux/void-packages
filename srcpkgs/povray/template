# Template file for 'povray'
pkgname=povray
version=3.7.0.10
revision=1
build_style=gnu-configure
_v=${version%.*.*}
configure_args="COMPILED_BY=Void --disable-optimiz-arch"
conf_files="
 /etc/povray/$_v/povray.conf
 /etc/povray/$_v/povray.ini"
hostmakedepends="git autoconf automake"
makedepends="boost-devel libpng-devel tiff-devel sdl12-compat-devel"
depends="openexr"
short_desc="Script-based raytracer for 3D graphic production"
maintainer="Brenton Horne <brentonhorne77@gmail.com>"
license="AGPL-3.0-or-later"
homepage="http://povray.org/"
distfiles="https://github.com/POV-Ray/povray/archive/v${version}.tar.gz"
checksum=7bee83d9296b98b7956eb94210cf30aa5c1bbeada8ef6b93bb52228bbc83abff
LDFLAGS+=" -Wl,-z,stack-size=1048576"
CXXFLAGS+=" -fno-fast-math"
make_check=ci-skip # requires input

case "$XBPS_TARGET_MACHINE" in
	*-musl) broken="package fails to build under musl";;
	arm*|aarch64*) broken="package fails to build under ARM architectures";;
esac

pre_configure() {
	cd $wrksrc/unix
	./prebuild.sh
	cd ..
	./bootstrap
}

post_install() {
	vlicense LICENSE
}
