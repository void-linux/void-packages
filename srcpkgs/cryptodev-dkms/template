# Template file for 'cryptodev-dkms'
pkgname=cryptodev-dkms
version=1.12
revision=1
archs="i686 x86_64*"
wrksrc="cryptodev-linux-cryptodev-linux-${version}"
short_desc="Kernel module for accessing Linux kernel crypto drivers from userspace"
maintainer="Wiktor Ciurej <wiktor.ciurej@gmail.com>"
license="GPL-2.0-only"
homepage="https://github.com/cryptodev-linux/cryptodev-linux"
distfiles="https://github.com/cryptodev-linux/cryptodev-linux/archive/refs/tags/cryptodev-linux-${version}.tar.gz"
checksum=f51c2254749233b1b1d7ec9445158bd709f124f88e1c650fe2faac83c3a81938

dkms_modules="cryptodev ${version}"
depends="dkms"

do_build() {
	cp -f ${FILESDIR}/dkms.conf dkms.conf
	make dkms.conf
}

do_install() {
	vmkdir usr/src/cryptodev-${version}
	vcopy "*" usr/src/cryptodev-${version}
	vmkdir usr/include/crypto
	install -m644 crypto/cryptodev.h ${DESTDIR}/usr/include/crypto/cryptodev.h

	vdoc AUTHORS
	vdoc INSTALL
	vdoc NEWS
	vdoc README
}
