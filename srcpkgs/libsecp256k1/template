# Template file for 'libsecp256k1'
pkgname=libsecp256k1
version=20190311+ee99f12
revision=1
_commit=ee99f12f3d8af18bbb9b74cd31907ac1979742ec
wrksrc="secp256k1-${_commit}"
makedepends="automake autoconf libtool"
short_desc="Optimized C library for EC operations on curve secp256k1"
maintainer="Louis Dupr√© Bertoni <contact@louisdb.xyz>"
license="MIT"
homepage="https://github.com/bitcoin-core/secp256k1"
distfiles="https://github.com/bitcoin-core/secp256k1/archive/${_commit}.tar.gz"
checksum=e4939619f89ca48da1dd5f80435fe5433be9b98b3377cb9d67d1f1e5527db05e

do_configure() {
	./autogen.sh
	./configure \
		--prefix=/usr \
		--enable-shared \
		--disable-static \
		--disable-benchmark \
		--disable-coverage \
		--enable-tests \
		--enable-exhaustive-tests \
		--enable-module-recovery \
		--with-gnu-ld
}

do_build() {
	make -j${XBPS_MAKEJOBS}
}

do_check() {
	./tests
}

do_install() {
	make install
	vlicense COPYING
}
