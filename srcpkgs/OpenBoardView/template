# Template file for 'OpenBoardView'
pkgname=OpenBoardView
version=9.95.2
revision=1
create_wrksrc=yes
build_style=cmake
hostmakedepends="pkg-config python3"
makedepends="SDL2-devel gtk+3-devel fontconfig-devel
 zlib-devel sqlite-devel stb"
short_desc="Open source boardview software"
maintainer="MarcoAPC <marcoaureliopc@gmail.com>"
license="MIT"
homepage="http://openboardview.org/"
changelog="https://github.com/OpenBoardView/OpenBoardView/releases"
_ghc_commit=3f1c185ab414e764c694b8171d1c4d8c5c437517
_glad_commit=a5ca31c88a4cc5847ea012629aff3690f261c7c4
_imgui_commit=45acd5e0e82f4c954432533ae9985ff0e1aad6d5
_mpc_commit=65f20a1a0b3249a475efa8ecb7b5ecd2c1c071c4
_utf8_commit=3e9e3ec15c7bf129664ab2a113eb03b54ee0b584
distfiles="https://github.com/OpenBoardView/OpenBoardView/archive/${version}.tar.gz
 https://github.com/gulrak/filesystem/archive/${_ghc_commit}.tar.gz
 https://github.com/Dav1dde/glad/archive/${_glad_commit}.tar.gz
 https://github.com/ocornut/imgui/archive/${_imgui_commit}.tar.gz
 https://github.com/orangeduck/mpc/archive/${_mpc_commit}.tar.gz
 https://github.com/sheredom/utf8.h/archive/${_utf8_commit}.tar.gz"
checksum="dffa4adb46b53159f846593dcbd763953d33a1c066653417153ea42aba92ccba
cc1c5439d29031477868bdea25b68b4210dc8ed018bb63a65e708afe405db4e1
972def32a11619912c0052bfa5eb30a41195f87f698eb58a1ff0653469e6768b
97484925aec2f4d3e913d6644d46b234f8d6d8d98c6aa9c50109e0f0df772090
b2c3a0e096c9f7fa686375501c7739190a8b4da64efd85856012e08b547a3c9f
c0e1749c60d0e91b2d763190a5dc4a6bdf6e6303d586e1ea1771f832725e7f10"

post_extract() {
	mv OpenBoardView-${version}/* OpenBoardView-${version}/.??* .
	rmdir OpenBoardView-${version}
	# move submodule to proper location
	rmdir src/filesystem
	rmdir src/glad
	rmdir src/imgui
	rmdir src/mpc
	rmdir src/utf8

	mv -v filesystem-${_ghc_commit} src/filesystem
	mv -v glad-${_glad_commit} src/glad
	mv -v imgui-${_imgui_commit} src/imgui
	mv -v mpc-${_mpc_commit} src/mpc
	mv -v utf8.h-${_utf8_commit} src/utf8
}

post_install() {
	vlicense LICENSE
}
