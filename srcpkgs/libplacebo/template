# Template file for 'libplacebo'
pkgname=libplacebo
version=5.229.2
revision=1
build_style=meson
configure_args="-Dshaderc=enabled -Dvulkan=enabled
 -Dlcms=$(vopt_if lcms en dis)abled -Ddemos=false -Dtests=true"
hostmakedepends="pkg-config Vulkan-Headers python3-glad"
makedepends="shaderc Vulkan-Headers vulkan-loader python3-MarkupSafe
 python3-Jinja2 $(vopt_if lcms lcms2-devel)"
short_desc="Reusable library for GPU-accelerated video/image rendering"
maintainer="Enrico Belleri <idesmi@protonmail.com>"
license="LGPL-2.1-or-later"
homepage="https://code.videolan.org/videolan/libplacebo"
distfiles="https://code.videolan.org/videolan/libplacebo/-/archive/v${version}/libplacebo-v${version}.tar.gz"
checksum=a42035c69e4a6373cb9856cc0c5736f24af4485006f3b29605ddffba377264db

if [ "$XBPS_TARGET_NO_ATOMIC8" ]; then
	makedepends+=" libatomic-devel"
	LDFLAGS+=" -latomic"
fi

build_options="lcms"
build_options_default="lcms"
desc_option_lcms="Enable support for LittleCMS 2 engine"

libplacebo-devel_package() {
	depends="${sourcepkg}>=${version}_${revision} vulkan-loader
	 $(vopt_if lcms lcms2-devel)"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
	}
}
