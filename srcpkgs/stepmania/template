# Template file for 'stepmania'
pkgname=stepmania
version=5.1.0.b2
revision=1
# compilation errors with musl
archs="i686 x86_64"
wrksrc=${pkgname}-${version%.*}-${version##*.}
build_style=cmake
cmake_builddir="Build"
hostmakedepends="yasm pkg-config git"
makedepends="libmad-devel libvorbis-devel pcre-devel libjpeg-turbo-devel
 alsa-lib-devel libXrandr-devel libva-devel glew-devel pulseaudio-devel"
short_desc="Advanced rhythm game"
maintainer="Jason Manley <jason@jasondavid.tv>"
license="MIT"
homepage="http://www.stepmania.com/"
distfiles="https://github.com/stepmania/stepmania/archive/v${version%.*}-${version##*.}.tar.gz"
checksum=2e311df9b661ba287b046ce377eb0b41e426b73e169841df99fc9fe2baa89310

post_patch() {
	vsed -i 's/PULSE_FOUND/PULSEAUDIO_FOUND/g' ${wrksrc}/StepmaniaCore.cmake
}

post_install() {
	for i in 16 22 24 32 36 48 64 72 96 128 192 256
	do
		vinstall icons/hicolor/${i}x${i}/apps/stepmania-ssc.png 644 \
			usr/share/icons/hicolor/${i}x${i}/apps stepmania-ssc.png
	done
	vsed -i 's/Exec=stepmania/Exec=\/opt\/stepmania-5.1\/stepmania/g' stepmania.desktop
	vinstall stepmania.desktop 644 usr/share/applications stepmania.desktop
	vlicense Docs/Licenses.txt
}
