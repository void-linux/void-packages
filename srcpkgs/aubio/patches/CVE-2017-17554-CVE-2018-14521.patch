From a81b12a3b4174953b3bc7ef4c37103f4d5636740 Mon Sep 17 00:00:00 2001
From: Paul Brossier <piem@piem.org>
Date: Mon, 6 Aug 2018 14:58:27 +0200
Subject: [PATCH] src/io/source_avcodec.c: give up if resampling context failed
 opening (see #137, closes #187)

---
 src/io/source_avcodec.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/io/source_avcodec.c b/src/io/source_avcodec.c
index 8197445c..6d8efa79 100644
--- src/io/source_avcodec.c
+++ src/io/source_avcodec.c
@@ -275,6 +275,8 @@ aubio_source_avcodec_t * new_aubio_source_avcodec(const char_t * path, uint_t sa
   // default to mono output
   aubio_source_avcodec_reset_resampler(s, 0);
 
+  if (s->avr == NULL) goto beach;
+
   s->eof = 0;
   s->multi = 0;
 

