# Template file for 'rpi-eeprom'
pkgname=rpi-eeprom
version=2023.10.20
revision=1
_githash="fdff8e81f0202c2a8538218e54488b14af2a719e"
archs="armv7* aarch64*"
conf_files="/etc/default/rpi-eeprom-update"
depends="binutils pciutils python3 rpi-firmware rpi-userland"
short_desc="Bootloader and VL805 USB controller EEPROM update tool for RPi4"
maintainer="Leah Neukirchen <leah@vuxu.org>"
license="BSD-3-Clause, custom:Proprietary"
homepage="https://github.com/raspberrypi/rpi-eeprom/"
distfiles="https://github.com/raspberrypi/rpi-eeprom/archive/${_githash}.tar.gz"
checksum="3fbb9e6e51acb1e3ea2d28428ed14dfe11f3a722e92c8e972b5eb19edb70fe7f"
python_version=3
repository=nonfree

do_install() {
	vbin rpi-eeprom-config
	vbin rpi-eeprom-update
	vbin rpi-eeprom-digest
	vinstall rpi-eeprom-update-default 644 etc/default rpi-eeprom-update

	vmkdir usr/lib/firmware/raspberrypi/bootloader
	# need to figure out how to package both pi4 (2711) and pi5 (2712) fw
	vcopy firmware-2711/* usr/lib/firmware/raspberrypi/bootloader/

	vlicense LICENSE
}
