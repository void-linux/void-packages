# Template file for 'obsidian'
pkgname=obsidian
version=0.12.3
revision=1
makedepends="asar"
depends="zlib hicolor-icon-theme fuse electron12"
short_desc="Obsidian is a powerful knowledge base that works on top of a local folder of plain text Markdown files"
maintainer="Soc Virnyl S. Estela <renegan.ronin@gmail.com>"
license="custom:Commercial"
homepage="https://obsidian.md/"
distfiles="https://github.com/obsidianmd/obsidian-releases/releases/download/v${version}/obsidian-${version}.tar.gz"
checksum=9f0b50a7b064319c0ccdf9c0e7075c30085f7b333ffcb9bd71fd296ef9ce5591
repository=nonfree
restricted=yes

post_extract() {
	asar ef resources/obsidian.asar icon.png
}

do_install() {
	vbin "$FILESDIR"/obsidian
	vmkdir usr/share/applications/
	vmkdir usr/share/pixmaps/
	vcopy "$FILESDIR"/obsidian.desktop usr/share/applications/obsidian.desktop
	vcopy "icon.png" usr/share/pixmaps/obsidian.png
	vlicense LICENSE.electron.txt
	vlicense LICENSES.chromium.html
	cd resources
	find . -type d -exec install -d {,"$DESTDIR"/usr/lib/obsidian/}{} \;
	find . -type f -exec install -D -m 644 {,"$DESTDIR"/usr/lib/obsidian/}{} \;
}
