# Template file for 'gsdjvu'
pkgname=gsdjvu
version=1.10
revision=1
only_for_archs="i686 x86_64"
_ghostpdl_version=9.25
_ghostpdl_tar="ghostpdl-${_ghostpdl_version}.tar.gz"
makedepends="libpng-devel libopenjpeg-devel zlib-devel"
short_desc="Ghostscript driver for DjVuDigital"
maintainer="B. Wilson <x@wilsonb.com>"
license="CPL-1.0, GPL-2.0-or-later"
homepage="http://djvu.sourceforge.net/gsdjvu.html"
distfiles="
 ${SOURCEFORGE_SITE}/project/djvu/GSDjVu/${version}/${pkgname}-${version}.tar.gz
 https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs925/${_ghostpdl_tar}"
checksum="
 92ff8e5bcf349cf01809f235de6ef15d51f3d192f8ddf74a9e13c84d8fd3ed1e
 784531e81f144c0f703a0f079e6fd1522eabb97b3a0670a92bdd1f39bf201d99"
skip_extraction="${_ghostpdl_tar}"
restricted=yes

pre_build() {
	mkdir -p BUILD
	cp "${XBPS_SRCDISTDIR}/${pkgname}-${version}/${_ghostpdl_tar}" BUILD/
}

do_build() {
	# The build script requires user input,
	# so we supply it with a heredoc:
	"${PWD}/build-gsdjvu" <<-EOF
		YES


	EOF
}

do_install() {
	vmkdir usr/lib
	vcopy BUILD/INST/gsdjvu usr/lib
	vlicense COPYING.CPL
	vmkdir usr/bin
	ln -sf /usr/lib/gsdjvu/gsdjvu ${DESTDIR}/usr/bin/gsdjvu
}
