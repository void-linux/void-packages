# Template file for 'loupe'
pkgname=loupe
version=49.2
revision=1
build_style=meson
build_helper=rust
hostmakedepends="cargo desktop-file-utils gettext gtk4-update-icon-cache
 itstool pkg-config"
makedepends="lcms2-devel libadwaita-devel libgweather-devel libseccomp-devel
 rust-std"
depends="glycin-loaders"
short_desc="Simple image viewer for GNOME"
maintainer="chrysos349 <chrysostom349@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://gitlab.gnome.org/GNOME/loupe"
changelog="https://gitlab.gnome.org/GNOME/loupe/-/raw/gnome-48/NEWS"
#changelog="https://gitlab.gnome.org/GNOME/loupe/-/raw/main/NEWS"
distfiles="${GNOME_SITE}/loupe/${version%.*}/loupe-${version}.tar.xz"
checksum=5853e75cceba7fa2bea01be273cd2f0a3061941e7bdfe3a008b233171067142c

if [ "$XBPS_TARGET_LIBC" = musl ]; then
	broken="broken"
fi

post_patch() {
	if [ "$CROSS_BUILD" ]; then
		vsed -i src/meson.build \
			-e "s%rust_target /%'${RUST_TARGET}' / &%"
	fi
}
