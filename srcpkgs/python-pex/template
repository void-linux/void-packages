# Template file for 'python-pex'
pkgname=python-pex
version=2.0.3
revision=1
archs=noarch
wrksrc="pex-${version}"
build_style=python-module
pycompile_module="pex"
hostmakedepends="python-setuptools python3-setuptools python-Sphinx python3-Sphinx"
depends="python-setuptools"
short_desc="Library & tool for generating .pex (Python EXecutable) files (Python2)"
maintainer="Daniel Santana <daniel@santana.tech>"
license="Apache-2.0"
homepage="https://github.com/pantsbuild/pex"
distfiles="${PYPI_SITE}/p/pex/pex-${version}.tar.gz"
checksum=a8a35e7eb212616b2964d70d8a134d41d16649c943ab206b90c749c005e60999
alternatives="
 pex:pex:/usr/bin/pex2
 pex:pex.1:/usr/share/man/man1/pex2.1"

post_extract() {
	rm -r pex.egg-info
}

post_build() {
	cd docs
	make man
}

post_install() {
	vman docs/_build/man/pex.1 pex2.1
}

python3-pex_package() {
	archs=noarch
	pycompile_module="pex"
	depends="python3-setuptools"
	short_desc="${short_desc/Python2/Python3}"
	alternatives="
	 pex:pex:/usr/bin/pex3
	 pex:pex.1:/usr/share/man/man1/pex3.1"
	pkg_install() {
		vmove usr/bin/*3
		vmove usr/lib/python3*
		vman docs/_build/man/pex.1 pex3.1
	}
}
