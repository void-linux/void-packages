# Template file for 'chroot-binutils'
pkgname=chroot-binutils
version=2.22
wrksrc="binutils-${version}"
build_style=gnu-configure
configure_args="--disable-shared --enable-threads --disable-plugins
--enable-64-bit-bfd --with-mmap --disable-bootstrap --enable-multilib"
make_install_args="tooldir=/usr"
distfiles="${GNU_SITE}/binutils/binutils-$version.tar.bz2"
revision=1
short_desc="GNU binary utilities -- for xbps-src use"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.gnu.org/software/binutils/"
license="GPL-3"
checksum=6c7af8ed1c8cf9b4b9d6e6fe09a3e1d3d479fe63984ba8b9b26bf356b6313ca9
long_desc="
 The GNU binutils package contains essential tools to assemble, link and
 manipulate binary and object files. They are often used with a compiler
 and additional libraries for building software.

 It includes the GNU linker, the portable GNU assembler, ar for modifying
 archives (such as libraries), nm for listing symbols from object files,
 objdump for displaying object file information, ranlib for generating
 archive indexes, size for listing section sizes of object files,
 strings for outputing the printable characters in files, strip for
 stripping out symbols (like debugging information) from object files,
 and other tools.

 This package is only meant to be used by xbps-src, don't install it manually."

bootstrap=yes
provides="binutils-${version}"
conflicts="binutils>=0"

pre_install() {
	if [ "$XBPS_MACHINE" = "x86_64" ]; then
		mkdir -p ${DESTDIR}/usr/lib
                cd ${DESTDIR}/usr && ln -s lib lib64 && cd ${wrksrc}
        fi
}

post_install() {
	[ -h ${DESTDIR}/usr/lib64 ] && rm -f ${DESTDIR}/usr/lib64
	rm -f ${DESTDIR}/usr/lib/*.a
	rm -rf ${DESTDIR}/usr/share ${DESTDIR}/usr/include
}
