# Template file for 'imv'
pkgname=imv
version=5.0.1
revision=2
build_style=meson
# don't define NDEBUG since assert(3) is used to detect error conditions
# (e.g.: https://git.sr.ht/~exec64/imv/tree/v4.4.0/item/src/x11_window.c#L109
# and https://git.sr.ht/~exec64/imv/tree/v4.4.0/item/src/wl_window.c#L673)
configure_args="-Db_ndebug=false"
hostmakedepends="asciidoc pkg-config cmake wayland-devel"
makedepends="cmocka-devel pango-devel librsvg-devel libheif-devel libxkbcommon-devel
 glu-devel wayland-devel wayland-protocols inih-devel libnsbmp-devel libwebp-devel
 libnsgif-devel"
depends="desktop-file-utils"
conf_files="/etc/imv_config"
short_desc="Image viewer for X11/Wayland"
maintainer="Orphaned <orphan@voidlinux.org>"
license="MIT"
homepage="https://sr.ht/~exec64/imv/"
changelog="https://git.sr.ht/~exec64/imv/blob/master/CHANGELOG"
distfiles="https://git.sr.ht/~exec64/imv/archive/v${version}.tar.gz"
checksum=8949c1df4b933b1d324e02ce49f1834a4b73dd25fa8103579e0ed105149e080e
conflicts="renameutils>=0"

post_install() {
	# copy the man page so it isn't clobbered by renameutils in man.voidlinux.org
	vman "${DESTDIR}/usr/share/man/man1/imv.1" imv-x11.1
	ln -s imv-x11.1 "${DESTDIR}/usr/share/man/man1/imv-wayland.1"
	vlicense LICENSE
}
