# Template file for 'fotoxx'
pkgname=fotoxx
version=19.20
revision=1
wrksrc=fotoxx
build_style=gnu-makefile
make_use_env=yes
hostmakedepends="pkg-config"
makedepends="libchamplain-devel libraw-devel"
depends="desktop-file-utils exiftool xdg-utils"
short_desc="Free open source program for image editing and collection management"
maintainer="Orphaned <orphan@voidlinux.org>"
license="GPL-3.0-or-later"
homepage="https://www.kornelix.net/fotoxx/fotoxx.html"
distfiles="https://www.kornelix.net/downloads/downloads/fotoxx-${version}.tar.gz"
checksum=bfa6f20bc5121fbf521354ddf19489e0cfba1f8aa72db1e63fdb26fc5d935752

if [ "$CROSS_BUILD" ]; then
	hostmakedepends+=" libchamplain-devel"
fi

case "$XBPS_TARGET_LIBC" in
	makedepends+=" libexecinfo-devel"
	LDFLAGS="-lexecinfo";;
esac

pre_build() {
	case "$XBPS_TARGET_LIBC" in
		musl)
			patch -Np0 < "$FILESDIR"/libexecinfo_link.patch ;;
	esac
}

post_install() {
	rm -v ${DESTDIR}/usr/share/doc/fotoxx/{changelog.gz,copyright,fotoxx.man}
	rm -rv ${DESTDIR}/usr/share/appdata
}
