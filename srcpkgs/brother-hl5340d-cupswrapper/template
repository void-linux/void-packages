# Template file for 'brother-hl5340d-cupswrapper'
pkgname=brother-hl5340d-cupswrapper
_br_version=2.0.4
_br_revision=1
version=${_br_version}
revision=1
archs="i686 x86_64"
create_wrksrc=yes
depends="brother-hl5340d-lpr cups cups-filters"
short_desc="CUPS wrapper driver for the brother HL5340D printer"
maintainer="Monkey 7<monkeyseven@fblog.ch>"
license="brother-eula GPL-2"
homepage="http://support.brother.com"
distfiles="http://www.brother.com/pub/bsc/linux/dlf/cupswrapperHL5340D-${version}-${_br_revision}.i386.deb
	http://www.brother.com/pub/bsc/linux/dlf/BR5340_2_GPL.ppd.gz"
checksum="a39c39e086904ec79d2ac0a9fe24bf2dd474ccd959adc11ad9d9b0b5d2649320
 	e8b8bb0688c2a181c9ebbb597ca7f467513262420bbf9a3c9bc1e2cf6e0bf9ee"
nopie=yes
patch_args="-Np1"

do_extract() {
	ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/cupswrapperHL5340D-${version}-${_br_revision}.i386.deb
	tar xzpvf data.tar.gz -C ${wrksrc}
	# Brother HL-5340D BR-Script3
	gunzip -c ${XBPS_SRCDISTDIR}/${pkgname}-${version}/BR5340_2_GPL.ppd.gz >${wrksrc}/BR5340_2_GPL.ppd
}

do_install() {
	cp -a ${wrksrc}/usr ${DESTDIR}/
	vmkdir usr/lib
	mv ${DESTDIR}/usr/local/Brother ${DESTDIR}/usr/lib/brother
	rm -rf ${DESTDIR}/usr/local
	# Brother HL-5340D BR-Script3
	vmkdir usr/share/cups/model
	cp ${wrksrc}/BR5340_2_GPL.ppd ${DESTDIR}/usr/share/cups/model/BR5340_2_GPL.ppd
}

