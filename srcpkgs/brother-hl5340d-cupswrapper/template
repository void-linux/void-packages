# Template file for 'brother-hl5340d-cupswrapper'
pkgname=brother-hl5340d-cupswrapper
br_version=2.0.4
br_revision=1
version=${br_version}
revision=1
maintainer="Monkey 7<monkeyseven@fblog.ch>"
homepage="http://support.brother.com"
license="brother-eula GPL-2"
short_desc="CUPS wrapper driver for the brother HL5340D printer"
distfiles="http://www.brother.com/pub/bsc/linux/dlf/cupswrapperHL5340D-${br_version}-${br_revision}.i386.deb
  http://www.brother.com/pub/bsc/linux/dlf/BR5340_2_GPL.ppd.gz"
checksum="a39c39e086904ec79d2ac0a9fe24bf2dd474ccd959adc11ad9d9b0b5d2649320
  e8b8bb0688c2a181c9ebbb597ca7f467513262420bbf9a3c9bc1e2cf6e0bf9ee"
archs="i686 x86_64"
depends="brother-hl5340d-lpr cups cups-filters"
create_wrksrc=yes
nopie=yes
patch_args="-Np1"

do_extract() {
	ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/cupswrapperHL5340D-${br_version}-${br_revision}.i386.deb
	tar xzpvf data.tar.gz -C ${wrksrc}
	# Brother HL-5340D BR-Script3
	gunzip -c ${XBPS_SRCDISTDIR}/${pkgname}-${version}/BR5340_2_GPL.ppd.gz >${wrksrc}/BR5340_2_GPL.ppd
}

do_install() {
	mkdir -p ${DESTDIR}
	cp -a ${wrksrc}/usr ${DESTDIR}/
	mkdir -p ${DESTDIR}/usr/lib
	mv ${DESTDIR}/usr/local/Brother ${DESTDIR}/usr/lib/brother
	rm -rf ${DESTDIR}/usr/local
	vlicense ${FILESDIR}/LICENSE
	# Brother HL-5340D BR-Script3
	mkdir -p ${DESTDIR}/usr/share/brother/ppd
	cp ${wrksrc}/BR5340_2_GPL.ppd ${DESTDIR}/usr/share/brother/ppd/
}

