diff -ur orig/usr/local/Brother/cupswrapper/cupswrapperHL5340D-2.0.4 new/usr/local/Brother/cupswrapper/cupswrapperHL5340D-2.0.4
--- orig/usr/local/Brother/cupswrapper/cupswrapperHL5340D-2.0.4	2009-09-10 04:48:37.000000000 +0200
+++ new/usr/local/Brother/cupswrapper/cupswrapperHL5340D-2.0.4	2019-07-09 10:08:23.763781987 +0200
@@ -22,8 +22,7 @@
   lpadmin -x HL5340D
   rm -f /usr/share/cups/model/HL5340D.ppd
   rm -f /usr/lib/cups/filter/brlpdwrapperHL5340D
-  rm -f /usr/lib64/cups/filter/brlpdwrapperHL5340D
-  rm -f /usr/local/Brother/cupswrapper/brcupsconfig3
+  rm -f /usr/lib/brother/cupswrapper/brcupsconfig3
   if [ -f /usr/share/ppd/HL5340D.ppd ];then
   rm -f /usr/share/ppd/HL5340D.ppd
   fi
@@ -38,11 +37,14 @@
 if [ "$1" = "-r" ]; then
   lpadmin -x HL5340D
   if [ -e /etc/init.d/cups ]; then
-    /etc/init.d/cups restart
+    sv restart cupsd restart
   fi
   if [ -e /etc/init.d/cupsys ]; then
     /etc/init.d/cupsys restart
   fi
+  if [ -e /usr/bin/sv -a -e /var/service/cupsd/run ]; then
+    /usr/bin/sv restart cupsd
+  fi
   exit 0 
 fi
 if [ "$1" = "help" ] || [ "$1" = "-h" ]; then
@@ -54,15 +56,18 @@
 fi
 mkdir -p /usr/lib/cups/filter
 
-if [ -e "/usr/local/Brother/lpd/filterHL5340D" ]; then
+if [ -e "/usr/lib/brother/lpd/filterHL5340D" ]; then
   :
 else
   echo "ERROR : Brother LPD filter is not installed."
 fi
 rm -f /usr/share/cups/model/HL5340D.ppd
 ppd_file_name=/usr/share/cups/model/HL5340D.ppd
+#if [ ! -e /usr/share/cups/model ]; then
+#   ppd_file_name=/usr/share/ppd/HL5340D.ppd
+#fi
 if [ ! -e /usr/share/cups/model ]; then
-   ppd_file_name=/usr/share/ppd/HL5340D.ppd
+  mkdir -p /usr/share/cups/model
 fi
 
 cat <<ENDOFPPDFILE >$ppd_file_name
@@ -372,20 +377,14 @@
 ENDOFPPDFILE
 
 chmod 755  $ppd_file_name
-if [ -e '/usr/share/ppd' ];then
-  if [ -e '/usr/share/cups/model' ];then
-    cp  $ppd_file_name  /usr/share/ppd
-  fi
-fi
+#if [ -e '/usr/share/ppd' ];then
+#  if [ -e '/usr/share/cups/model' ];then
+#    cp  $ppd_file_name  /usr/share/ppd
+#  fi
+#fi
 
 brotherlpdwrapper=/usr/lib/cups/filter/brlpdwrapperHL5340D
-brotherlpdwrapper64=/usr/lib64/cups/filter/brlpdwrapperHL5340D
 rm -f  $brotherlpdwrapper
-if [ ! -e /usr/lib/cups/filter ];then
-  if [ -e /usr/lib64/cups/filter ];then
-    brotherlpdwrapper=/usr/lib64/cups/filter/brlpdwrapperHL5340D
-  fi
-fi
 
 
 cat <<!ENDOFWFILTER! >$brotherlpdwrapper
@@ -517,25 +516,25 @@
 fi
 
 
-if [ -e "/usr/local/Brother/lpd/filter\$PRINTER" ]; then
+if [ -e "/usr/lib/brother/lpd/filter\$PRINTER" ]; then
        :
 else
-    echo "ERROR: /usr/local/Brother/lpd/filter\$PRINTER does not exist"   >>\$LOGFILE
+    echo "ERROR: /usr/lib/brother/lpd/filter\$PRINTER does not exist"   >>\$LOGFILE
     errorcode=30
     exit $errorcode
 fi
 
-if [ -e "/usr/local/Brother/cupswrapper/brcupsconfig3" ]; then
+if [ -e "/usr/lib/brother/cupswrapper/brcupsconfig3" ]; then
   if [ \$DEBUG = 0 ]; then
-     /usr/local/Brother/cupswrapper/brcupsconfig3  \$PRINTER  \$PPD 0 "\$options" >> /dev/null
+     /usr/lib/brother/cupswrapper/brcupsconfig3  \$PRINTER  \$PPD 0 "\$options" >> /dev/null
   else
-     /usr/local/Brother/cupswrapper/brcupsconfig3  \$PRINTER  \$PPD \$LOGCLEVEL "\$options" >>\$LOGFILE
+     /usr/lib/brother/cupswrapper/brcupsconfig3  \$PRINTER  \$PPD \$LOGCLEVEL "\$options" >>\$LOGFILE
   fi
 fi
 
 
 if [ \$DEBUG -le 2 ]; then
-    cat    \$INPUT_TEMP_PS | /usr/local/Brother/lpd/filter\$PRINTER
+    cat    \$INPUT_TEMP_PS | /usr/lib/brother/lpd/filter\$PRINTER
 fi
 
 if [ \$DEBUG -ge 2 ];  then
@@ -553,14 +552,9 @@
 
 
 chmod 755 $brotherlpdwrapper
-if [ -e /usr/lib/cups/filter ]; then
- if [ -e /usr/lib64/cups/filter ]; then
-   cp $brotherlpdwrapper  $brotherlpdwrapper64
- fi
-fi
 
-chmod a+w /usr/local/Brother/inf/brHL5340Drc
-chmod a+w /usr/local/Brother/inf
+chmod a+w /usr/lib/brother/inf/brHL5340Drc
+chmod a+w /usr/lib/brother/inf
 if [ -e /etc/init.d/lpd ]; then
    /etc/init.d/lpd stop
 fi
